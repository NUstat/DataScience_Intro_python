<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Science with Python - 3&nbsp; Reading data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./NumPy.html" rel="next">
<link href="./data_structures.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reading data</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./NU_Stat_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science with Python</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Quick overview: Python programming</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to Python and Jupyter Notebooks.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Python and Jupyter Notebooks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_structures.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data structures</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Exploratory data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading data.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reading data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pandas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data visualization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data cleaning and preparation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data cleaning and preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data wrangling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data aggregation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data aggregation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./student_solutions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Alternative solutions by students</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Assignments</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 4 (Data Visualization).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Assignment 4 (Data Visualization)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Datasets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#types-of-data---structured-and-unstructured" id="toc-types-of-data---structured-and-unstructured" class="nav-link active" data-scroll-target="#types-of-data---structured-and-unstructured"><span class="toc-section-number">3.1</span>  Types of data - structured and unstructured</a></li>
  <li><a href="#reading-a-csv-file-with-pandas" id="toc-reading-a-csv-file-with-pandas" class="nav-link" data-scroll-target="#reading-a-csv-file-with-pandas"><span class="toc-section-number">3.2</span>  Reading a <em>csv</em> file with <em>Pandas</em></a>
  <ul>
  <li><a href="#using-the-read_csv-function" id="toc-using-the-read_csv-function" class="nav-link" data-scroll-target="#using-the-read_csv-function"><span class="toc-section-number">3.2.1</span>  Using the <em>read_csv</em> function</a></li>
  <li><a href="#specifying-the-working-directory" id="toc-specifying-the-working-directory" class="nav-link" data-scroll-target="#specifying-the-working-directory"><span class="toc-section-number">3.2.2</span>  Specifying the working directory</a></li>
  <li><a href="#data-overview" id="toc-data-overview" class="nav-link" data-scroll-target="#data-overview"><span class="toc-section-number">3.2.3</span>  Data overview</a>
  <ul class="collapse">
  <li><a href="#row-indices-and-column-names-axis-labels" id="toc-row-indices-and-column-names-axis-labels" class="nav-link" data-scroll-target="#row-indices-and-column-names-axis-labels"><span class="toc-section-number">3.2.3.1</span>  Row Indices and column names (axis labels)</a></li>
  <li><a href="#shape-of-dataframe" id="toc-shape-of-dataframe" class="nav-link" data-scroll-target="#shape-of-dataframe"><span class="toc-section-number">3.2.3.2</span>  Shape of DataFrame</a></li>
  </ul></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics"><span class="toc-section-number">3.2.4</span>  Summary statistics</a>
  <ul class="collapse">
  <li><a href="#numeric-columns-summary" id="toc-numeric-columns-summary" class="nav-link" data-scroll-target="#numeric-columns-summary"><span class="toc-section-number">3.2.4.1</span>  Numeric columns summary</a></li>
  <li><a href="#summary-statistics-across-rowscolumns" id="toc-summary-statistics-across-rowscolumns" class="nav-link" data-scroll-target="#summary-statistics-across-rowscolumns"><span class="toc-section-number">3.2.4.2</span>  Summary statistics across rows/columns</a></li>
  </ul></li>
  <li><a href="#practice-exercise-1" id="toc-practice-exercise-1" class="nav-link" data-scroll-target="#practice-exercise-1"><span class="toc-section-number">3.2.5</span>  Practice exercise 1</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="toc-section-number">3.2.5.1</span>  </a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="toc-section-number">3.2.5.2</span>  </a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"><span class="toc-section-number">3.2.5.3</span>  </a></li>
  </ul></li>
  <li><a href="#creating-new-columns-from-existing-columns" id="toc-creating-new-columns-from-existing-columns" class="nav-link" data-scroll-target="#creating-new-columns-from-existing-columns"><span class="toc-section-number">3.2.6</span>  Creating new columns from existing columns</a></li>
  <li><a href="#datatype-of-variables" id="toc-datatype-of-variables" class="nav-link" data-scroll-target="#datatype-of-variables"><span class="toc-section-number">3.2.7</span>  Datatype of variables</a></li>
  <li><a href="#practice-exercise-2" id="toc-practice-exercise-2" class="nav-link" data-scroll-target="#practice-exercise-2"><span class="toc-section-number">3.2.8</span>  Practice exercise 2</a>
  <ul class="collapse">
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"><span class="toc-section-number">3.2.8.1</span>  </a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"><span class="toc-section-number">3.2.8.2</span>  </a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"><span class="toc-section-number">3.2.8.3</span>  </a></li>
  </ul></li>
  <li><a href="#reading-a-sub-set-of-data-loc-and-iloc" id="toc-reading-a-sub-set-of-data-loc-and-iloc" class="nav-link" data-scroll-target="#reading-a-sub-set-of-data-loc-and-iloc"><span class="toc-section-number">3.2.9</span>  Reading a sub-set of data: <code>loc</code> and <code>iloc</code></a></li>
  <li><a href="#practice-exercise-3" id="toc-practice-exercise-3" class="nav-link" data-scroll-target="#practice-exercise-3"><span class="toc-section-number">3.2.10</span>  Practice exercise 3</a>
  <ul class="collapse">
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"><span class="toc-section-number">3.2.10.1</span>  </a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7"><span class="toc-section-number">3.2.10.2</span>  </a></li>
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8"><span class="toc-section-number">3.2.10.3</span>  </a></li>
  </ul></li>
  </ul></li>
  <li><a href="#reading-other-data-formats---txt-html-json" id="toc-reading-other-data-formats---txt-html-json" class="nav-link" data-scroll-target="#reading-other-data-formats---txt-html-json"><span class="toc-section-number">3.3</span>  Reading other data formats - txt, html, json</a>
  <ul>
  <li><a href="#reading-txt-files" id="toc-reading-txt-files" class="nav-link" data-scroll-target="#reading-txt-files"><span class="toc-section-number">3.3.1</span>  Reading <em>txt</em> files</a></li>
  <li><a href="#practice-exercise-4" id="toc-practice-exercise-4" class="nav-link" data-scroll-target="#practice-exercise-4"><span class="toc-section-number">3.3.2</span>  Practice exercise 4</a></li>
  <li><a href="#reading-html-data" id="toc-reading-html-data" class="nav-link" data-scroll-target="#reading-html-data"><span class="toc-section-number">3.3.3</span>  Reading HTML data</a></li>
  <li><a href="#practice-exercise-5" id="toc-practice-exercise-5" class="nav-link" data-scroll-target="#practice-exercise-5"><span class="toc-section-number">3.3.4</span>  Practice exercise 5</a></li>
  <li><a href="#reading-json-data" id="toc-reading-json-data" class="nav-link" data-scroll-target="#reading-json-data"><span class="toc-section-number">3.3.5</span>  Reading JSON data</a></li>
  <li><a href="#practice-exercise-6" id="toc-practice-exercise-6" class="nav-link" data-scroll-target="#practice-exercise-6"><span class="toc-section-number">3.3.6</span>  Practice exercise 6</a></li>
  <li><a href="#reading-data-from-web-apis" id="toc-reading-data-from-web-apis" class="nav-link" data-scroll-target="#reading-data-from-web-apis"><span class="toc-section-number">3.3.7</span>  Reading data from web APIs</a></li>
  </ul></li>
  <li><a href="#writing-data" id="toc-writing-data" class="nav-link" data-scroll-target="#writing-data"><span class="toc-section-number">3.4</span>  Writing data</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reading data</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="types-of-data---structured-and-unstructured" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="types-of-data---structured-and-unstructured"><span class="header-section-number">3.1</span> Types of data - structured and unstructured</h2>
<p>Reading data is the first step to extract information from it. Data can exist broadly in two formats:</p>
<ol type="1">
<li>Structured data, and</li>
<li>Untructured data.</li>
</ol>
<p>Structured data is typically stored in a tabular form, where rows in the data correspond to “observations” and columns correspond to “variables”. For example, the following dataset contains 5 observations, where each observation (or row) consists of information about a movie. The variables (or columns) contain different pieces of information about a given movie. As all variables for a given row are related to the same movie, the data below is also called relational data.</p>
<div class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Title</th>
      <th>US Gross</th>
      <th>Production Budget</th>
      <th>Release Date</th>
      <th>Major Genre</th>
      <th>Creative Type</th>
      <th>Rotten Tomatoes Rating</th>
      <th>IMDB Rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The Shawshank Redemption</td>
      <td>28241469</td>
      <td>25000000</td>
      <td>Sep 23 1994</td>
      <td>Drama</td>
      <td>Fiction</td>
      <td>88</td>
      <td>9.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Inception</td>
      <td>285630280</td>
      <td>160000000</td>
      <td>Jul 16 2010</td>
      <td>Horror/Thriller</td>
      <td>Fiction</td>
      <td>87</td>
      <td>9.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>One Flew Over the Cuckoo's Nest</td>
      <td>108981275</td>
      <td>4400000</td>
      <td>Nov 19 1975</td>
      <td>Comedy</td>
      <td>Fiction</td>
      <td>96</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight</td>
      <td>533345358</td>
      <td>185000000</td>
      <td>Jul 18 2008</td>
      <td>Action/Adventure</td>
      <td>Fiction</td>
      <td>93</td>
      <td>8.9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Schindler's List</td>
      <td>96067179</td>
      <td>25000000</td>
      <td>Dec 15 1993</td>
      <td>Drama</td>
      <td>Non-Fiction</td>
      <td>97</td>
      <td>8.9</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Unstructured data is data that is not organized in any pre-defined manner. Examples of unstructured data can be text files, audio/video files, images, Internet of Things (IoT) data, etc. Unstructured data is relatively harder to analyze as most of the analytical methods and tools are oriented towards structured data. However, an unstructured data can be used to obtain structured data, which in turn can be analyzed. For example, an image can be converted to an array of pixels - which will be structured data. Machine learning algorithms can then be used on the array to classify the image as that of a dog or a cat.</p>
<p>In this course, we will focus on analyzing structured data.</p>
</section>
<section id="reading-a-csv-file-with-pandas" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="reading-a-csv-file-with-pandas"><span class="header-section-number">3.2</span> Reading a <em>csv</em> file with <em>Pandas</em></h2>
<p>Structured data can be stored in a variety of formats. The most popular format is <em>data_file_name.csv</em>, where the extension <em>csv</em> stands for comma separated values. The variable values of each observation are separated by a comma in a <em>.csv</em> file. In other words, the <strong>delimiter</strong> is a comma in a <em>csv</em> file. However, the comma is not visible when a <em>.csv</em> file is opened with Microsoft Excel.</p>
<section id="using-the-read_csv-function" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="using-the-read_csv-function"><span class="header-section-number">3.2.1</span> Using the <em>read_csv</em> function</h3>
<p>We will use functions from the <em>Pandas</em> library of <em>Python</em> to read data. Let us import <em>Pandas</em> to use its functions.</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that <em>pd</em> is the acronym that we will use to call a <em>Pandas</em> function. This acronym can be anything as desired by the user.</p>
<p>The function to read a <em>csv</em> file is <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html">read_csv()</a>. It reads the dataset into an object of type <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">Pandas DataFrame</a>. Let us read the dataset <em>movie_ratings.csv</em> in Python.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(<span class="st">'movie_ratings.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The built-in python function <code>type</code> can be used to check the dataype of an object:</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(movie_ratings)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
<p>Note that the file <em>movie_ratings.csv</em> is stored at the same location as the python script containing the above code. If that is not the case, we’ll need to specify the location of the file as in the following code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(<span class="st">'D:/Books/DataScience_Intro_python/movie_ratings.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that forward slash is used instead of backslash while specifying the path of the data file. Another option is to use two consecutive backslashes instead of a single forward slash.</p>
</section>
<section id="specifying-the-working-directory" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="specifying-the-working-directory"><span class="header-section-number">3.2.2</span> Specifying the working directory</h3>
<p>In case we need to read several datasets from a given location, it may be inconvenient to specify the path every time. In such a case we can change the current working directory to the location where the datasets are located.</p>
<p>We’ll use the <em>os</em> library of <em>Python</em> to view and/or change the current working directory.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os <span class="co">#Importing the 'os' library</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>os.getcwd() <span class="co">#Getting the path to the current working directory</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="cell-output cell-output-stdout">
<pre><code>C:\Users\username\STAT303-1\Quarto Book\DataScience_Intro_python</code></pre>
</div>
</div>
<p>The function <em>getcwd()</em> stands for get current working directory.</p>
<p>Suppose the dataset to be read is located at <code>'D:\Books\DataScience_Intro_python\Datasets'</code>. Then, we’ll use the function <em>chdir</em> to change the current working directory to this location.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>os.chdir(<span class="st">'D:/Books/DataScience_Intro_python/Datasets'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can read the dataset from this location without mentioning the entire path as shown below.</p>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(<span class="st">'movie_ratings.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-overview" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="data-overview"><span class="header-section-number">3.2.3</span> Data overview</h3>
<p>Once the data has been read, we may want to see what the data looks like. We’ll use another <em>Pandas</em> function <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html">head()</a> to view the first few rows of the data.</p>
<div class="cell" data-scrolled="true" data-execution_count="19">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Title</th>
      <th>US Gross</th>
      <th>Worldwide Gross</th>
      <th>Production Budget</th>
      <th>Release Date</th>
      <th>MPAA Rating</th>
      <th>Source</th>
      <th>Major Genre</th>
      <th>Creative Type</th>
      <th>IMDB Rating</th>
      <th>IMDB Votes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Opal Dreams</td>
      <td>14443</td>
      <td>14443</td>
      <td>9000000</td>
      <td>Nov 22 2006</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Drama</td>
      <td>Fiction</td>
      <td>6.5</td>
      <td>468</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Major Dundee</td>
      <td>14873</td>
      <td>14873</td>
      <td>3800000</td>
      <td>Apr 07 1965</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Western/Musical</td>
      <td>Fiction</td>
      <td>6.7</td>
      <td>2588</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The Informers</td>
      <td>315000</td>
      <td>315000</td>
      <td>18000000</td>
      <td>Apr 24 2009</td>
      <td>R</td>
      <td>Adapted screenplay</td>
      <td>Horror/Thriller</td>
      <td>Fiction</td>
      <td>5.2</td>
      <td>7595</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Buffalo Soldiers</td>
      <td>353743</td>
      <td>353743</td>
      <td>15000000</td>
      <td>Jul 25 2003</td>
      <td>R</td>
      <td>Adapted screenplay</td>
      <td>Comedy</td>
      <td>Fiction</td>
      <td>6.9</td>
      <td>13510</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Last Sin Eater</td>
      <td>388390</td>
      <td>388390</td>
      <td>2200000</td>
      <td>Feb 09 2007</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Drama</td>
      <td>Fiction</td>
      <td>5.7</td>
      <td>1012</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<section id="row-indices-and-column-names-axis-labels" class="level4" data-number="3.2.3.1">
<h4 data-number="3.2.3.1" class="anchored" data-anchor-id="row-indices-and-column-names-axis-labels"><span class="header-section-number">3.2.3.1</span> Row Indices and column names (axis labels)</h4>
<p>The bold integers on the left are the indices of the DataFrame. Each index refers to a distinct row. For example, the index <em>2</em> correponds to the row of the movie <em>The Informers</em>. By default, the indices are integers starting from 0. However, they can be changed (to even non-integer values) if desired by the user.</p>
<p>The bold text on top of the DataFrame refers to column names. For example, the column <em>US Gross</em> consists of the gross revenue of a movie in the US.</p>
<p>Collectively, the indices and column names are referred as <strong>axis labels</strong>.</p>
</section>
<section id="shape-of-dataframe" class="level4" data-number="3.2.3.2">
<h4 data-number="3.2.3.2" class="anchored" data-anchor-id="shape-of-dataframe"><span class="header-section-number">3.2.3.2</span> Shape of DataFrame</h4>
<p>For finding the number of rows and columns in the data, you may use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.shape.html">shape()</a> function.</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the shape of movie_ratings dataset</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>(2228, 11)</code></pre>
</div>
</div>
<p>The <em>movie_ratings</em> dataset contains 2,228 observations (or rows) and 11 variables (or columns).</p>
</section>
</section>
<section id="summary-statistics" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="summary-statistics"><span class="header-section-number">3.2.4</span> Summary statistics</h3>
<section id="numeric-columns-summary" class="level4" data-number="3.2.4.1">
<h4 data-number="3.2.4.1" class="anchored" data-anchor-id="numeric-columns-summary"><span class="header-section-number">3.2.4.1</span> Numeric columns summary</h4>
<p>The Pandas function of the DataFrame class, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html">describe()</a> can be used very conviniently to print the summary statistics of numeric columns of the data.</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding summary statistics of movie_ratings dataset</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<div id="tbl-ss" class="anchored">

<div>

<table class="dataframe table table-sm table-striped"><caption>Table&nbsp;3.1:  Summary statistics of numeric variables </caption>
  <thead>
    <tr>
      <th></th>
      <th>US Gross</th>
      <th>Worldwide Gross</th>
      <th>Production Budget</th>
      <th>IMDB Rating</th>
      <th>IMDB Votes</th>
      <th>Release Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.228000e+03</td>
      <td>2.228000e+03</td>
      <td>2.228000e+03</td>
      <td>2228.000000</td>
      <td>2228.000000</td>
      <td>2228.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.076370e+07</td>
      <td>1.019370e+08</td>
      <td>3.816055e+07</td>
      <td>6.239004</td>
      <td>33585.154847</td>
      <td>2002.005386</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.643081e+07</td>
      <td>1.648589e+08</td>
      <td>3.782604e+07</td>
      <td>1.243285</td>
      <td>47325.651561</td>
      <td>5.524324</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
      <td>8.840000e+02</td>
      <td>2.180000e+02</td>
      <td>1.400000</td>
      <td>18.000000</td>
      <td>1953.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>9.646188e+06</td>
      <td>1.320737e+07</td>
      <td>1.200000e+07</td>
      <td>5.500000</td>
      <td>6659.250000</td>
      <td>1999.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.838649e+07</td>
      <td>4.266892e+07</td>
      <td>2.600000e+07</td>
      <td>6.400000</td>
      <td>18169.000000</td>
      <td>2002.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.453140e+07</td>
      <td>1.200000e+08</td>
      <td>5.300000e+07</td>
      <td>7.100000</td>
      <td>40092.750000</td>
      <td>2006.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.601676e+08</td>
      <td>2.767891e+09</td>
      <td>3.000000e+08</td>
      <td>9.200000</td>
      <td>519541.000000</td>
      <td>2039.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<p>Answer the following questions based on the above table.</p>
<div class="cell" data-execution_count="11">
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="fFTLurdBzqbM" data-shufflequestions="False" data-shuffleanswers="True" data-preserveresponses="false" data-numquestions="1000000"> <style>:root {
    --medium-slate-blue: #6f78ffff;
    --orange-pantone: #f75c03ff;
    --russian-violet: #392061ff;
    --maximum-yellow-red: #ffc857ff;
    --viridian-green: #119da4ff;
    --incorrect-red: #c80202;
    --correct-green: #009113;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: auto auto;
    grid-gap: 10px;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: #c0c0c0;
    color: #fff;
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: #c0c0c0;
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem #999999;
}

.MCButton {
    background: #fafafa;
    border: 1px solid #eee;
    border-radius: 10px;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--medium-slate-blue);
    color: #fafafa;
    border-radius: 10px;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--orange-pantone);
    color: #fafafa;
    border-radius: 10px;
}

.NumericQn {
    padding: 10px;
    background: var(--russian-violet);
    color: #fafafa;
    border-radius: 10px;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: #101010;
    font-size: 15pt;
}

.incorrect {
    color: var(--incorrect-red);
}

.correct {
    color: var(--correct-green);
}

.correctButton {
    /*
    background: var(--correct-green);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: #fafafa;
    box-shadow: inset 0px 0px 5px #555555;
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: #fafafa;
    box-shadow: inset 0px 0px 5px #555555;
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--incorrect-red);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--correct-green);
    }
}</style><script type="text/Javascript">var questionsfFTLurdBzqbM=[{"question": "Do majority of the movies have a higher IMDB rating than the average IMDB rating of a movie?", "type": "multiple_choice", "answers": [{"answer": "Yes", "correct": true, "feedback": "Correct! 50% of the movies have an IMDB rating greater than 6.4, while the average rating is 6.24. Thus, more than 50% (or majority) of the movies will have an IMDB rating greater than 6.24."}, {"answer": "No", "correct": false, "feedback": "Incorrect"}]}, {"question": "What is approximately the average profit of a movie? Profit = Worldwide gross - Production budget", "type": "multiple_choice", "answers": [{"answer": "\\$64 million", "correct": true, "feedback": "Correct! Subtract the mean production budget from the mean worldwide gross."}, {"answer": "\\$17 million", "correct": false, "feedback": "Incorrect"}, {"answer": "\\$127 million", "correct": false, "feedback": "Incorrect"}]}, {"question": "Can you find the maximum profit of a movie?", "type": "multiple_choice", "answers": [{"answer": "Yes", "correct": false, "feedback": "Incorrect! The 'maximum' statistic for worlwide gross and production budget may correspond to different movies."}, {"answer": "No", "correct": true, "feedback": "Correct!"}]}];
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;

        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;

        iDiv.append(outerqDiv);

        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        //qDiv.textContent=qa.question;
        qDiv.innerHTML = jaxify(qa.question);

        outerqDiv.append(qDiv);

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if (qa.type == "multiple_choice") {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
        } else if (qa.type == "many_choice") {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}

        {
        show_questions(questionsfFTLurdBzqbM,  fFTLurdBzqbM);
        }
        </script>
        
</div>
</div>
<div class="cell" data-execution_count="9">
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="vqyiDPHpPvIc" data-shufflequestions="False" data-shuffleanswers="True" data-preserveresponses="false" data-numquestions="1000000"> <style>:root {
    --medium-slate-blue: #6f78ffff;
    --orange-pantone: #f75c03ff;
    --russian-violet: #392061ff;
    --maximum-yellow-red: #ffc857ff;
    --viridian-green: #119da4ff;
    --incorrect-red: #c80202;
    --correct-green: #009113;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: auto auto;
    grid-gap: 10px;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: #c0c0c0;
    color: #fff;
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: #c0c0c0;
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem #999999;
}

.MCButton {
    background: #fafafa;
    border: 1px solid #eee;
    border-radius: 10px;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--medium-slate-blue);
    color: #fafafa;
    border-radius: 10px;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--orange-pantone);
    color: #fafafa;
    border-radius: 10px;
}

.NumericQn {
    padding: 10px;
    background: var(--russian-violet);
    color: #fafafa;
    border-radius: 10px;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: #101010;
    font-size: 15pt;
}

.incorrect {
    color: var(--incorrect-red);
}

.correct {
    color: var(--correct-green);
}

.correctButton {
    /*
    background: var(--correct-green);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: #fafafa;
    box-shadow: inset 0px 0px 5px #555555;
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: #fafafa;
    box-shadow: inset 0px 0px 5px #555555;
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--incorrect-red);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--correct-green);
    }
}</style><script type="text/Javascript">var questionsvqyiDPHpPvIc=[{"question": "Suppose the movies are arrange in decreasing order of IMDB ratings. What is the maximum IMDB rating of a movie that is not in the top 25% movies?", "type": "numeric", "answers": [{"type": "value", "value": 7.1, "correct": true, "feedback": "Correct! Since the 75th percentile IMDB rating is 7.1, 25% of the movies have an IMDB rating greater than 7.1"}, {"type": "default", "feedback": "Incorrect."}]}];
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;

        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;

        iDiv.append(outerqDiv);

        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        //qDiv.textContent=qa.question;
        qDiv.innerHTML = jaxify(qa.question);

        outerqDiv.append(qDiv);

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if (qa.type == "multiple_choice") {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
        } else if (qa.type == "many_choice") {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}

        {
        show_questions(questionsvqyiDPHpPvIc,  vqyiDPHpPvIc);
        }
        </script>
        
</div>
</div>
</div></div></section>
<section id="summary-statistics-across-rowscolumns" class="level4" data-number="3.2.4.2">
<h4 data-number="3.2.4.2" class="anchored" data-anchor-id="summary-statistics-across-rowscolumns"><span class="header-section-number">3.2.4.2</span> Summary statistics across rows/columns</h4>
<p>The Pandas DataFrame class has functions such as <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sum.html">sum()</a> and <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mean.html">mean()</a> to compute sum over rows or columns of a DataFrame.</p>
<p>Let us compute the mean of all the numeric columns of the data:</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>movie_ratings.mean(axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>US Gross             5.076370e+07
Worldwide Gross      1.019370e+08
Production Budget    3.816055e+07
IMDB Rating          6.239004e+00
IMDB Votes           3.358515e+04
dtype: float64</code></pre>
</div>
</div>
<p>The argument <code>axis=0</code> denotes that the mean is taken over all the rows of the DataFrame. For computing a statistic across column the argument <code>axis=1</code> will be used.</p>
<p>If mean over a subset of columns is desired, then those column names can be subset from the data. For example, let us compute the mean IMDB rating, and mean IMDB votes of all the movies:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>movie_ratings[[<span class="st">'IMDB Rating'</span>,<span class="st">'IMDB Votes'</span>]].mean(axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>IMDB Rating        6.239004
IMDB Votes     33585.154847
dtype: float64</code></pre>
</div>
</div>
</section>
</section>
<section id="practice-exercise-1" class="level3" data-number="3.2.5">
<h3 data-number="3.2.5" class="anchored" data-anchor-id="practice-exercise-1"><span class="header-section-number">3.2.5</span> Practice exercise 1</h3>
<p>Read the file <em>Top 10 Albums By Year.csv</em>. This file contains the top 10 albums for each year from 1990 to 2021. Each row corresponds to a unique album.</p>
<section id="section" class="level4" data-number="3.2.5.1">
<h4 data-number="3.2.5.1" class="anchored" data-anchor-id="section"><span class="header-section-number">3.2.5.1</span> </h4>
<p>Print the first 5 rows of the data.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>album_data <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/Top 10 Albums By Year.csv'</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>album_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Year</th>
      <th>Ranking</th>
      <th>Artist</th>
      <th>Album</th>
      <th>Worldwide Sales</th>
      <th>CDs</th>
      <th>Tracks</th>
      <th>Album Length</th>
      <th>Hours</th>
      <th>Minutes</th>
      <th>Seconds</th>
      <th>Genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1990</td>
      <td>8</td>
      <td>Phil Collins</td>
      <td>Serious Hits... Live!</td>
      <td>9956520</td>
      <td>1</td>
      <td>15</td>
      <td>1:16:53</td>
      <td>1.28</td>
      <td>76.88</td>
      <td>4613</td>
      <td>Rock</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1990</td>
      <td>1</td>
      <td>Madonna</td>
      <td>The Immaculate Collection</td>
      <td>30000000</td>
      <td>1</td>
      <td>17</td>
      <td>1:13:32</td>
      <td>1.23</td>
      <td>73.53</td>
      <td>4412</td>
      <td>Pop</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1990</td>
      <td>10</td>
      <td>The Three Tenors</td>
      <td>Carreras Domingo Pavarotti In Concert 1990</td>
      <td>8533000</td>
      <td>1</td>
      <td>17</td>
      <td>1:07:55</td>
      <td>1.13</td>
      <td>67.92</td>
      <td>4075</td>
      <td>Classical</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1990</td>
      <td>4</td>
      <td>MC Hammer</td>
      <td>Please Hammer Don't Hurt Em</td>
      <td>18000000</td>
      <td>1</td>
      <td>13</td>
      <td>0:59:04</td>
      <td>0.98</td>
      <td>59.07</td>
      <td>3544</td>
      <td>Hip Hop</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1990</td>
      <td>6</td>
      <td>Movie Soundtrack</td>
      <td>Aashiqui</td>
      <td>15000000</td>
      <td>1</td>
      <td>12</td>
      <td>0:58:13</td>
      <td>0.97</td>
      <td>58.22</td>
      <td>3493</td>
      <td>World</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="section-1" class="level4" data-number="3.2.5.2">
<h4 data-number="3.2.5.2" class="anchored" data-anchor-id="section-1"><span class="header-section-number">3.2.5.2</span> </h4>
<p>How many rows and columns are there in the data?</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>album_data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>(320, 12)</code></pre>
</div>
</div>
<p>There are 320 rows and 12 columns in the data</p>
</section>
<section id="section-2" class="level4" data-number="3.2.5.3">
<h4 data-number="3.2.5.3" class="anchored" data-anchor-id="section-2"><span class="header-section-number">3.2.5.3</span> </h4>
<p>Print the summary statistics of the data, and answer the following questions:</p>
<ol type="1">
<li>What proportion of albums have 15 or lesser tracks? Mention a range for the proportion.</li>
<li>What is the mean length of a track (in minutes)?</li>
</ol>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>album_data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Year</th>
      <th>Ranking</th>
      <th>CDs</th>
      <th>Tracks</th>
      <th>Hours</th>
      <th>Minutes</th>
      <th>Seconds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>320.000000</td>
      <td>320.00000</td>
      <td>320.000000</td>
      <td>320.000000</td>
      <td>320.000000</td>
      <td>320.000000</td>
      <td>320.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2005.500000</td>
      <td>5.50000</td>
      <td>1.043750</td>
      <td>14.306250</td>
      <td>0.941406</td>
      <td>56.478500</td>
      <td>3388.715625</td>
    </tr>
    <tr>
      <th>std</th>
      <td>9.247553</td>
      <td>2.87678</td>
      <td>0.246528</td>
      <td>5.868995</td>
      <td>0.382895</td>
      <td>22.970109</td>
      <td>1378.209812</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1990.000000</td>
      <td>1.00000</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>0.320000</td>
      <td>19.430000</td>
      <td>1166.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1997.750000</td>
      <td>3.00000</td>
      <td>1.000000</td>
      <td>12.000000</td>
      <td>0.740000</td>
      <td>44.137500</td>
      <td>2648.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2005.500000</td>
      <td>5.50000</td>
      <td>1.000000</td>
      <td>13.000000</td>
      <td>0.860000</td>
      <td>51.555000</td>
      <td>3093.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2013.250000</td>
      <td>8.00000</td>
      <td>1.000000</td>
      <td>15.000000</td>
      <td>1.090000</td>
      <td>65.112500</td>
      <td>3906.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2021.000000</td>
      <td>10.00000</td>
      <td>4.000000</td>
      <td>67.000000</td>
      <td>5.070000</td>
      <td>304.030000</td>
      <td>18242.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>At least 75% of the albums have 15 tracks since the 75th percentile value of the number of tracks is 15. However, albums between those having 75th percentile value for the number of tracks and those having the maximum number of tracks can also have 15 tracks. Thus, the proportion of albums having 15 or lesser tracks = [75%-99.99%].</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean length of a track ="</span>,<span class="fl">56.478500</span><span class="op">/</span><span class="fl">14.306250</span>, <span class="st">"minutes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mean length of a track = 3.9478200087374398 minutes</code></pre>
</div>
</div>
</section>
</section>
<section id="creating-new-columns-from-existing-columns" class="level3" data-number="3.2.6">
<h3 data-number="3.2.6" class="anchored" data-anchor-id="creating-new-columns-from-existing-columns"><span class="header-section-number">3.2.6</span> Creating new columns from existing columns</h3>
<p>New variables (or columns) can be created based on existing variables, or with external data (we’ll see adding external data later). For example, let us create a new variable <code>ratio_wgross_by_budget</code>, which is the ratio of <code>Worldwide Gross</code> and <code>Production Budget</code> for each movie:</p>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'ratio_wgross_by_budget'</span>] <span class="op">=</span> movie_ratings[<span class="st">'Worldwide Gross'</span>]<span class="op">/</span>movie_ratings[<span class="st">'Production Budget'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The new variable can be seen at the right end of the updated DataFrame as shown below.</p>
<div class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Title</th>
      <th>US Gross</th>
      <th>Worldwide Gross</th>
      <th>Production Budget</th>
      <th>Release Date</th>
      <th>MPAA Rating</th>
      <th>Source</th>
      <th>Major Genre</th>
      <th>Creative Type</th>
      <th>IMDB Rating</th>
      <th>IMDB Votes</th>
      <th>ratio_wgross_by_budget</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Opal Dreams</td>
      <td>14443</td>
      <td>14443</td>
      <td>9000000</td>
      <td>Nov 22 2006</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Drama</td>
      <td>Fiction</td>
      <td>6.5</td>
      <td>468</td>
      <td>0.001605</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Major Dundee</td>
      <td>14873</td>
      <td>14873</td>
      <td>3800000</td>
      <td>Apr 07 1965</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Western/Musical</td>
      <td>Fiction</td>
      <td>6.7</td>
      <td>2588</td>
      <td>0.003914</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The Informers</td>
      <td>315000</td>
      <td>315000</td>
      <td>18000000</td>
      <td>Apr 24 2009</td>
      <td>R</td>
      <td>Adapted screenplay</td>
      <td>Horror/Thriller</td>
      <td>Fiction</td>
      <td>5.2</td>
      <td>7595</td>
      <td>0.017500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Buffalo Soldiers</td>
      <td>353743</td>
      <td>353743</td>
      <td>15000000</td>
      <td>Jul 25 2003</td>
      <td>R</td>
      <td>Adapted screenplay</td>
      <td>Comedy</td>
      <td>Fiction</td>
      <td>6.9</td>
      <td>13510</td>
      <td>0.023583</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Last Sin Eater</td>
      <td>388390</td>
      <td>388390</td>
      <td>2200000</td>
      <td>Feb 09 2007</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Drama</td>
      <td>Fiction</td>
      <td>5.7</td>
      <td>1012</td>
      <td>0.176541</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="datatype-of-variables" class="level3" data-number="3.2.7">
<h3 data-number="3.2.7" class="anchored" data-anchor-id="datatype-of-variables"><span class="header-section-number">3.2.7</span> Datatype of variables</h3>
<p>Note that in <a href="#tbl-ss">Table&nbsp;<span>3.1</span></a> (summary statistics), we don’t see <code>Release Date</code>. This is because the datatype of <code>Release Data</code> is not <code>numeric</code>.</p>
<p>The datatype of each variable can be seen using the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dtypes.html">dtypes()</a> function of the DataFrame class.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the datatypes of the variables </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>Title                 object
US Gross               int64
Worldwide Gross        int64
Production Budget      int64
Release Date          object
MPAA Rating           object
Source                object
Major Genre           object
Creative Type         object
IMDB Rating          float64
IMDB Votes             int64
dtype: object</code></pre>
</div>
</div>
<p>Often, we wish to convert the datatypes of some of the variables to make them suitable for analysis. For example, the datatype of <code>Release Date</code> in the DataFrame <em>movie_ratings</em> is <code>object</code>. To perform numerical computations on this variable, we’ll need to convert it to a <code>datatime</code> format. We’ll use the Pandas function <a href="https://pandas.pydata.org/docs/reference/api/pandas.to_datetime.html">to_datatime()</a> to covert it to a <code>datatime</code> format. Similar functions such as <a href="https://pandas.pydata.org/docs/reference/api/pandas.to_numeric.html">to_numeric()</a>, <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_string.html">to_string()</a> etc., can be used for other conversions.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pd.to_datetime(movie_ratings[<span class="st">'Release Date'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>0      2006-11-22
1      1965-04-07
2      2009-04-24
3      2003-07-25
4      2007-02-09
          ...    
2223   2004-07-07
2224   1998-06-19
2225   2010-05-14
2226   1991-06-14
2227   1998-01-23
Name: Release Date, Length: 2228, dtype: datetime64[ns]</code></pre>
</div>
</div>
<p>We can see above that the function <code>to_datetime()</code> converts <em>Release Date</em> to a <code>datetime</code> format.</p>
<p>Now, we’ll update the variable <code>Release Date</code> in the DataFrame to be in the <code>datetime</code> format:</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'Release Date'</span>] <span class="op">=</span> pd.to_datetime(movie_ratings[<span class="st">'Release Date'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>movie_ratings.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>Title                        object
US Gross                      int64
Worldwide Gross               int64
Production Budget             int64
Release Date         datetime64[ns]
MPAA Rating                  object
Source                       object
Major Genre                  object
Creative Type                object
IMDB Rating                 float64
IMDB Votes                    int64
dtype: object</code></pre>
</div>
</div>
<p>We can see that the datatype of <em>Release Date</em> has changed to <code>datetime</code> in the updated DataFrame, <em>movie_ratings</em>. Now we can perform computations on <code>Release Date</code>. Suppose we wish to create a new variable <code>Release_year</code> that consists of the year of release of the movie. We’ll use the attribute <code>year</code> of the <a href="https://docs.python.org/3/library/datetime.html">datetime</a> module to extract the year from <code>Release Date</code>:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting year from Release Date</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'Release Year'</span>] <span class="op">=</span> movie_ratings[<span class="st">'Release Date'</span>].dt.year</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Title</th>
      <th>US Gross</th>
      <th>Worldwide Gross</th>
      <th>Production Budget</th>
      <th>Release Date</th>
      <th>MPAA Rating</th>
      <th>Source</th>
      <th>Major Genre</th>
      <th>Creative Type</th>
      <th>IMDB Rating</th>
      <th>IMDB Votes</th>
      <th>Release Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Opal Dreams</td>
      <td>14443</td>
      <td>14443</td>
      <td>9000000</td>
      <td>2006-11-22</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Drama</td>
      <td>Fiction</td>
      <td>6.5</td>
      <td>468</td>
      <td>2006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Major Dundee</td>
      <td>14873</td>
      <td>14873</td>
      <td>3800000</td>
      <td>1965-04-07</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Western/Musical</td>
      <td>Fiction</td>
      <td>6.7</td>
      <td>2588</td>
      <td>1965</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The Informers</td>
      <td>315000</td>
      <td>315000</td>
      <td>18000000</td>
      <td>2009-04-24</td>
      <td>R</td>
      <td>Adapted screenplay</td>
      <td>Horror/Thriller</td>
      <td>Fiction</td>
      <td>5.2</td>
      <td>7595</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Buffalo Soldiers</td>
      <td>353743</td>
      <td>353743</td>
      <td>15000000</td>
      <td>2003-07-25</td>
      <td>R</td>
      <td>Adapted screenplay</td>
      <td>Comedy</td>
      <td>Fiction</td>
      <td>6.9</td>
      <td>13510</td>
      <td>2003</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Last Sin Eater</td>
      <td>388390</td>
      <td>388390</td>
      <td>2200000</td>
      <td>2007-02-09</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Drama</td>
      <td>Fiction</td>
      <td>5.7</td>
      <td>1012</td>
      <td>2007</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>As year is a numeric variable, it will appear in the numeric summary statistics with the <code>describe()</code> function, as shown below.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>movie_ratings.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>US Gross</th>
      <th>Worldwide Gross</th>
      <th>Production Budget</th>
      <th>IMDB Rating</th>
      <th>IMDB Votes</th>
      <th>Release Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.228000e+03</td>
      <td>2.228000e+03</td>
      <td>2.228000e+03</td>
      <td>2228.000000</td>
      <td>2228.000000</td>
      <td>2228.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>5.076370e+07</td>
      <td>1.019370e+08</td>
      <td>3.816055e+07</td>
      <td>6.239004</td>
      <td>33585.154847</td>
      <td>2002.005386</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.643081e+07</td>
      <td>1.648589e+08</td>
      <td>3.782604e+07</td>
      <td>1.243285</td>
      <td>47325.651561</td>
      <td>5.524324</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000e+00</td>
      <td>8.840000e+02</td>
      <td>2.180000e+02</td>
      <td>1.400000</td>
      <td>18.000000</td>
      <td>1953.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>9.646188e+06</td>
      <td>1.320737e+07</td>
      <td>1.200000e+07</td>
      <td>5.500000</td>
      <td>6659.250000</td>
      <td>1999.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.838649e+07</td>
      <td>4.266892e+07</td>
      <td>2.600000e+07</td>
      <td>6.400000</td>
      <td>18169.000000</td>
      <td>2002.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.453140e+07</td>
      <td>1.200000e+08</td>
      <td>5.300000e+07</td>
      <td>7.100000</td>
      <td>40092.750000</td>
      <td>2006.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.601676e+08</td>
      <td>2.767891e+09</td>
      <td>3.000000e+08</td>
      <td>9.200000</td>
      <td>519541.000000</td>
      <td>2039.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="practice-exercise-2" class="level3" data-number="3.2.8">
<h3 data-number="3.2.8" class="anchored" data-anchor-id="practice-exercise-2"><span class="header-section-number">3.2.8</span> Practice exercise 2</h3>
<section id="section-3" class="level4" data-number="3.2.8.1">
<h4 data-number="3.2.8.1" class="anchored" data-anchor-id="section-3"><span class="header-section-number">3.2.8.1</span> </h4>
<p>Why is <code>Worldwide Sales</code> not included in the summary statistics table printed in Practice exercise 1?</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>album_data.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>Year                 int64
Ranking              int64
Artist              object
Album               object
Worldwide Sales     object
CDs                  int64
Tracks               int64
Album Length        object
Hours              float64
Minutes            float64
Seconds              int64
Genre               object
dtype: object</code></pre>
</div>
</div>
<p><code>Worldwide Sales</code> is not included in the summary statistics table printed in Practice exercise 1 because its data type is <code>object</code> and not <code>int</code> or <code>float</code></p>
</section>
<section id="section-4" class="level4" data-number="3.2.8.2">
<h4 data-number="3.2.8.2" class="anchored" data-anchor-id="section-4"><span class="header-section-number">3.2.8.2</span> </h4>
<p>Update the DataFrame so that <code>Worldwide Sales</code> is included in the summary statistics table. Print the summary statistics table.</p>
<p><strong>Hint:</strong> Sometimes it may not be possible to convert an object to numeric(). For example, the object ‘hi’ cannot be converted to a numeric() by the python compiler. To avoid getting an error, use the <em>errors</em> argument of <a href="https://pandas.pydata.org/docs/reference/api/pandas.to_numeric.html">to_numeric()</a> to force such conversions to NaN (missing value).</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>album_data[<span class="st">'Worldwide Sales'</span>] <span class="op">=</span> pd.to_numeric(album_data[<span class="st">'Worldwide Sales'</span>], errors <span class="op">=</span> <span class="st">'coerce'</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>album_data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Year</th>
      <th>Ranking</th>
      <th>Worldwide Sales</th>
      <th>CDs</th>
      <th>Tracks</th>
      <th>Hours</th>
      <th>Minutes</th>
      <th>Seconds</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>320.000000</td>
      <td>320.00000</td>
      <td>3.190000e+02</td>
      <td>320.000000</td>
      <td>320.000000</td>
      <td>320.000000</td>
      <td>320.000000</td>
      <td>320.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2005.500000</td>
      <td>5.50000</td>
      <td>1.071093e+07</td>
      <td>1.043750</td>
      <td>14.306250</td>
      <td>0.941406</td>
      <td>56.478500</td>
      <td>3388.715625</td>
    </tr>
    <tr>
      <th>std</th>
      <td>9.247553</td>
      <td>2.87678</td>
      <td>7.566796e+06</td>
      <td>0.246528</td>
      <td>5.868995</td>
      <td>0.382895</td>
      <td>22.970109</td>
      <td>1378.209812</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1990.000000</td>
      <td>1.00000</td>
      <td>1.909009e+06</td>
      <td>1.000000</td>
      <td>6.000000</td>
      <td>0.320000</td>
      <td>19.430000</td>
      <td>1166.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1997.750000</td>
      <td>3.00000</td>
      <td>5.000000e+06</td>
      <td>1.000000</td>
      <td>12.000000</td>
      <td>0.740000</td>
      <td>44.137500</td>
      <td>2648.250000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2005.500000</td>
      <td>5.50000</td>
      <td>8.255866e+06</td>
      <td>1.000000</td>
      <td>13.000000</td>
      <td>0.860000</td>
      <td>51.555000</td>
      <td>3093.500000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2013.250000</td>
      <td>8.00000</td>
      <td>1.400000e+07</td>
      <td>1.000000</td>
      <td>15.000000</td>
      <td>1.090000</td>
      <td>65.112500</td>
      <td>3906.750000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2021.000000</td>
      <td>10.00000</td>
      <td>4.500000e+07</td>
      <td>4.000000</td>
      <td>67.000000</td>
      <td>5.070000</td>
      <td>304.030000</td>
      <td>18242.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="section-5" class="level4" data-number="3.2.8.3">
<h4 data-number="3.2.8.3" class="anchored" data-anchor-id="section-5"><span class="header-section-number">3.2.8.3</span> </h4>
<p>Create a new column that computes the average worldwide sales per year for each album, assuming that the worldwide sales are as of 2022. Print the first 5 rows of the updated DataFrame.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>album_data[<span class="st">'mean_sales_per_year'</span>] <span class="op">=</span> album_data[<span class="st">'Worldwide Sales'</span>]<span class="op">/</span>(<span class="dv">2022</span><span class="op">-</span>album_data[<span class="st">'Year'</span>])</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>album_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Year</th>
      <th>Ranking</th>
      <th>Artist</th>
      <th>Album</th>
      <th>Worldwide Sales</th>
      <th>CDs</th>
      <th>Tracks</th>
      <th>Album Length</th>
      <th>Hours</th>
      <th>Minutes</th>
      <th>Seconds</th>
      <th>Genre</th>
      <th>mean_sales_per_year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1990</td>
      <td>8</td>
      <td>Phil Collins</td>
      <td>Serious Hits... Live!</td>
      <td>9956520.0</td>
      <td>1</td>
      <td>15</td>
      <td>1:16:53</td>
      <td>1.28</td>
      <td>76.88</td>
      <td>4613</td>
      <td>Rock</td>
      <td>311141.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1990</td>
      <td>1</td>
      <td>Madonna</td>
      <td>The Immaculate Collection</td>
      <td>30000000.0</td>
      <td>1</td>
      <td>17</td>
      <td>1:13:32</td>
      <td>1.23</td>
      <td>73.53</td>
      <td>4412</td>
      <td>Pop</td>
      <td>937500.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1990</td>
      <td>10</td>
      <td>The Three Tenors</td>
      <td>Carreras Domingo Pavarotti In Concert 1990</td>
      <td>8533000.0</td>
      <td>1</td>
      <td>17</td>
      <td>1:07:55</td>
      <td>1.13</td>
      <td>67.92</td>
      <td>4075</td>
      <td>Classical</td>
      <td>266656.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1990</td>
      <td>4</td>
      <td>MC Hammer</td>
      <td>Please Hammer Don't Hurt Em</td>
      <td>18000000.0</td>
      <td>1</td>
      <td>13</td>
      <td>0:59:04</td>
      <td>0.98</td>
      <td>59.07</td>
      <td>3544</td>
      <td>Hip Hop</td>
      <td>562500.00</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1990</td>
      <td>6</td>
      <td>Movie Soundtrack</td>
      <td>Aashiqui</td>
      <td>15000000.0</td>
      <td>1</td>
      <td>12</td>
      <td>0:58:13</td>
      <td>0.97</td>
      <td>58.22</td>
      <td>3493</td>
      <td>World</td>
      <td>468750.00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="reading-a-sub-set-of-data-loc-and-iloc" class="level3" data-number="3.2.9">
<h3 data-number="3.2.9" class="anchored" data-anchor-id="reading-a-sub-set-of-data-loc-and-iloc"><span class="header-section-number">3.2.9</span> Reading a sub-set of data: <code>loc</code> and <code>iloc</code></h3>
<p>Sometimes we may be interested in working with a subset of rows and columns of the data, instead of working with the entire dataset. The indexing operators <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html">loc</a> and <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.iloc.html">iloc</a> provide a convenient way of selecting a subset of desired rows and columns. The operator <code>loc</code> uses axis labels (row indices and column names) to subset the data, while <code>iloc</code> uses the position of rows or columns, where position has values 0,1,2,3,…and so on, for rows from top to bottom and columns from left to right. In other words, the first row has position 0, the second row has position 1, the third row has position 2, and so on. Similarly, the first column from left has position 0, the second column from left has position 1, the third column from left has position 2, and so on.</p>
<p>Let us read the file <em>movie_IMDBratings_sorted.csv</em>, which has movies sorted in the descending order of their IMDB ratings.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>movies_sorted <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/movie_IMDBratings_sorted.csv'</span>,index_col <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The argument <code>index_col=0</code> assigns the first column of the file as the row indices of the DataFrame.</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>movies_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Title</th>
      <th>US Gross</th>
      <th>Worldwide Gross</th>
      <th>Production Budget</th>
      <th>Release Date</th>
      <th>MPAA Rating</th>
      <th>Source</th>
      <th>Major Genre</th>
      <th>Creative Type</th>
      <th>IMDB Rating</th>
      <th>IMDB Votes</th>
    </tr>
    <tr>
      <th>Rank</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>The Shawshank Redemption</td>
      <td>28241469</td>
      <td>28241469</td>
      <td>25000000</td>
      <td>Sep 23 1994</td>
      <td>R</td>
      <td>Adapted screenplay</td>
      <td>Drama</td>
      <td>Fiction</td>
      <td>9.2</td>
      <td>519541</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Inception</td>
      <td>285630280</td>
      <td>753830280</td>
      <td>160000000</td>
      <td>Jul 16 2010</td>
      <td>PG/PG-13</td>
      <td>Original Screenplay</td>
      <td>Horror/Thriller</td>
      <td>Fiction</td>
      <td>9.1</td>
      <td>188247</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight</td>
      <td>533345358</td>
      <td>1022345358</td>
      <td>185000000</td>
      <td>Jul 18 2008</td>
      <td>PG/PG-13</td>
      <td>Adapted screenplay</td>
      <td>Action/Adventure</td>
      <td>Fiction</td>
      <td>8.9</td>
      <td>465000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Schindler's List</td>
      <td>96067179</td>
      <td>321200000</td>
      <td>25000000</td>
      <td>Dec 15 1993</td>
      <td>R</td>
      <td>Adapted screenplay</td>
      <td>Drama</td>
      <td>Non-Fiction</td>
      <td>8.9</td>
      <td>276283</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Pulp Fiction</td>
      <td>107928762</td>
      <td>212928762</td>
      <td>8000000</td>
      <td>Oct 14 1994</td>
      <td>R</td>
      <td>Original Screenplay</td>
      <td>Drama</td>
      <td>Fiction</td>
      <td>8.9</td>
      <td>417703</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Let us say, we wish to subset the title, worldwide gross, production budget, and IMDB raring of top 3 movies.</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting the DataFrame by loc - using axis labels</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>movies_subset <span class="op">=</span> movies_sorted.loc[<span class="dv">1</span>:<span class="dv">3</span>,[<span class="st">'Title'</span>,<span class="st">'Worldwide Gross'</span>,<span class="st">'Production Budget'</span>,<span class="st">'IMDB Rating'</span>]]</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>movies_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Title</th>
      <th>Worldwide Gross</th>
      <th>Production Budget</th>
      <th>IMDB Rating</th>
    </tr>
    <tr>
      <th>Rank</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>The Shawshank Redemption</td>
      <td>28241469</td>
      <td>25000000</td>
      <td>9.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Inception</td>
      <td>753830280</td>
      <td>160000000</td>
      <td>9.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight</td>
      <td>1022345358</td>
      <td>185000000</td>
      <td>8.9</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting the DataFrame by iloc - using index of the position of rows and columns</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>movies_subset <span class="op">=</span> movies_sorted.iloc[<span class="dv">0</span>:<span class="dv">3</span>,[<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">9</span>]]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>movies_subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Title</th>
      <th>Worldwide Gross</th>
      <th>Production Budget</th>
      <th>IMDB Rating</th>
    </tr>
    <tr>
      <th>Rank</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>The Shawshank Redemption</td>
      <td>28241469</td>
      <td>25000000</td>
      <td>9.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Inception</td>
      <td>753830280</td>
      <td>160000000</td>
      <td>9.1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight</td>
      <td>1022345358</td>
      <td>185000000</td>
      <td>8.9</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Let us find the movie with the maximum <code>Worldwide Gross</code>.</p>
<p>We will use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.argmax.html">argmax()</a> function of the Pandas Series class to find the position of the movie with the maximum worldwide gross, and then use the position to find the movie.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>position_max_wgross <span class="op">=</span> movies_sorted[<span class="st">'Worldwide Gross'</span>].argmax()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>movies_sorted.iloc[position_max_wgross,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>Title                             Avatar
US Gross                       760167650
Worldwide Gross               2767891499
Production Budget              237000000
Release Date                 Dec 18 2009
MPAA Rating                     PG/PG-13
Source               Original Screenplay
Major Genre             Action/Adventure
Creative Type                    Fiction
IMDB Rating                          8.3
IMDB Votes                        261439
Name: 59, dtype: object</code></pre>
</div>
</div>
<p><em>Avatar</em> has the highest worldwide gross of all the movies. Note that the <code>:</code> indicates that all the columns of the DataFrame are selected.</p>
</section>
<section id="practice-exercise-3" class="level3" data-number="3.2.10">
<h3 data-number="3.2.10" class="anchored" data-anchor-id="practice-exercise-3"><span class="header-section-number">3.2.10</span> Practice exercise 3</h3>
<section id="section-6" class="level4" data-number="3.2.10.1">
<h4 data-number="3.2.10.1" class="anchored" data-anchor-id="section-6"><span class="header-section-number">3.2.10.1</span> </h4>
<p>Find the album having the highest worldwide sales per year, and its artist.</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>album_data.iloc[album_data[<span class="st">'mean_sales_per_year'</span>].argmax(),:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Year                        2021
Ranking                        1
Artist                     Adele
Album                         30
Worldwide Sales        4485025.0
CDs                            1
Tracks                        12
Album Length             0:58:14
Hours                       0.97
Minutes                    58.23
Seconds                     3494
Genre                        Pop
mean_sales_per_year    4485025.0
Name: 312, dtype: object</code></pre>
</div>
</div>
<p>‘30’ has the highest worldwide sales and its artist is Adele.</p>
</section>
<section id="section-7" class="level4" data-number="3.2.10.2">
<h4 data-number="3.2.10.2" class="anchored" data-anchor-id="section-7"><span class="header-section-number">3.2.10.2</span> </h4>
<p>Subset the data to include only Hip-Hop albums. How many Hip_Hop albums are there?</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>hiphop_albums <span class="op">=</span> album_data.loc[album_data[<span class="st">'Genre'</span>]<span class="op">==</span><span class="st">'Hip Hop'</span>,:]</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"There are"</span>,hiphop_albums.shape[<span class="dv">0</span>], <span class="st">"hip-hop albums"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>There are 42 hip-hop albums</code></pre>
</div>
</div>
</section>
<section id="section-8" class="level4" data-number="3.2.10.3">
<h4 data-number="3.2.10.3" class="anchored" data-anchor-id="section-8"><span class="header-section-number">3.2.10.3</span> </h4>
<p>Which album amongst hip-hop has the higest mean sales per year per track, and who is its artist?</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>hiphop_albums.loc[:,<span class="st">'mean_sales_per_year_track'</span>] <span class="op">=</span> hiphop_albums.loc[:,<span class="st">'Worldwide Sales'</span>]<span class="op">/</span>((<span class="dv">2022</span><span class="op">-</span>hiphop_albums.loc[:,<span class="st">'Year'</span>])<span class="op">*</span>(hiphop_albums.loc[:,<span class="st">'Tracks'</span>]))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>hiphop_albums.iloc[hiphop_albums[<span class="st">'mean_sales_per_year_track'</span>].argmax(),:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>Year                                  2021
Ranking                                  6
Artist                           Cai Xukun
Album                                    迷
Worldwide Sales                  3402981.0
CDs                                      1
Tracks                                  11
Album Length                       0:24:16
Hours                                  0.4
Minutes                              24.27
Seconds                               1456
Genre                              Hip Hop
mean_sales_per_year              3402981.0
mean_sales_per_year_track    309361.909091
Name: 318, dtype: object</code></pre>
</div>
</div>
<p>迷 has the higest mean sales per year per track amongst hip-hop albumns, and its artist is Cai Xukun.</p>
</section>
</section>
</section>
<section id="reading-other-data-formats---txt-html-json" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="reading-other-data-formats---txt-html-json"><span class="header-section-number">3.3</span> Reading other data formats - txt, html, json</h2>
<p>Although <em>csv</em> is a very popular format for structured data, data is found in several other formats as well. Some of the other data formats are <em>txt, html</em> and <em>json</em>.</p>
<section id="reading-txt-files" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="reading-txt-files"><span class="header-section-number">3.3.1</span> Reading <em>txt</em> files</h3>
<p>The <em>txt</em> format offers some additional flexibility as compared to the <em>csv</em> format. In the <em>csv</em> format, the delimiter is a comma (or the column values are separated by a comma). However, in a <em>txt</em> file, the delimiter can be anything as desired by the user. Let us read the file <em>movie_ratings.txt</em>, where the variable values are separated by a tab character.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>movie_ratings_txt <span class="op">=</span> pd.read_csv(<span class="st">'movie_ratings.txt'</span>,sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We use the function <em>read_csv</em> to read a <em>txt</em> file. However, we mention the tab character (r”) as a separator of variable values.</p>
<p>Note that there is no need to remember the argument name - <em>sep</em> for specifying the delimiter. You can always refer to the <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html">read_csv()</a> documentation to find the relevant argument.</p>
</section>
<section id="practice-exercise-4" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="practice-exercise-4"><span class="header-section-number">3.3.2</span> Practice exercise 4</h3>
<p>Read the file <em>bestseller_books.txt</em>. It contains top 50 best-selling books on amazon from 2009 to 2019. Identify the delimiter without opening the file with Notepad or a text-editing software. How many rows and columns are there in the dataset?</p>
<p><strong>Solution:</strong></p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading some lines with 'error_bad_lines=False' to identify the delimiter</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>bestseller_books <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/bestseller_books.txt'</span>,error_bad_lines<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>bestseller_books.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>b'Skipping line 6: expected 1 fields, saw 2\nSkipping line 10: expected 1 fields, saw 3\nSkipping line 16: expected 1 fields, saw 5\nSkipping line 17: expected 1 fields, saw 4\nSkipping line 20: expected 1 fields, saw 3\nSkipping line 29: expected 1 fields, saw 2\nSkipping line 33: expected 1 fields, saw 2\nSkipping line 40: expected 1 fields, saw 2\nSkipping line 41: expected 1 fields, saw 2\nSkipping line 42: expected 1 fields, saw 3\nSkipping line 43: expected 1 fields, saw 3\nSkipping line 44: expected 1 fields, saw 2\nSkipping line 60: expected 1 fields, saw 4\nSkipping line 61: expected 1 fields, saw 3\nSkipping line 63: expected 1 fields, saw 2\nSkipping line 64: expected 1 fields, saw 2\nSkipping line 70: expected 1 fields, saw 3\nSkipping line 71: expected 1 fields, saw 2\nSkipping line 72: expected 1 fields, saw 2\nSkipping line 73: expected 1 fields, saw 2\nSkipping line 80: expected 1 fields, saw 4\nSkipping line 82: expected 1 fields, saw 2\nSkipping line 94: expected 1 fields, saw 4\nSkipping line 95: expected 1 fields, saw 2\nSkipping line 96: expected 1 fields, saw 2\nSkipping line 101: expected 1 fields, saw 3\nSkipping line 119: expected 1 fields, saw 3\nSkipping line 130: expected 1 fields, saw 2\nSkipping line 131: expected 1 fields, saw 2\nSkipping line 132: expected 1 fields, saw 2\nSkipping line 133: expected 1 fields, saw 2\nSkipping line 148: expected 1 fields, saw 3\nSkipping line 149: expected 1 fields, saw 3\nSkipping line 150: expected 1 fields, saw 3\nSkipping line 154: expected 1 fields, saw 3\nSkipping line 155: expected 1 fields, saw 2\nSkipping line 156: expected 1 fields, saw 3\nSkipping line 157: expected 1 fields, saw 2\nSkipping line 158: expected 1 fields, saw 2\nSkipping line 159: expected 1 fields, saw 2\nSkipping line 177: expected 1 fields, saw 4\nSkipping line 178: expected 1 fields, saw 2\nSkipping line 179: expected 1 fields, saw 2\nSkipping line 183: expected 1 fields, saw 3\nSkipping line 209: expected 1 fields, saw 2\nSkipping line 215: expected 1 fields, saw 3\nSkipping line 224: expected 1 fields, saw 3\nSkipping line 230: expected 1 fields, saw 2\nSkipping line 241: expected 1 fields, saw 2\nSkipping line 247: expected 1 fields, saw 2\nSkipping line 248: expected 1 fields, saw 2\nSkipping line 249: expected 1 fields, saw 2\nSkipping line 250: expected 1 fields, saw 2\nSkipping line 251: expected 1 fields, saw 2\nSkipping line 252: expected 1 fields, saw 2\nSkipping line 253: expected 1 fields, saw 2\nSkipping line 254: expected 1 fields, saw 2\nSkipping line 259: expected 1 fields, saw 3\nSkipping line 273: expected 1 fields, saw 2\nSkipping line 274: expected 1 fields, saw 2\nSkipping line 275: expected 1 fields, saw 2\nSkipping line 276: expected 1 fields, saw 2\nSkipping line 277: expected 1 fields, saw 2\nSkipping line 278: expected 1 fields, saw 2\nSkipping line 279: expected 1 fields, saw 2\nSkipping line 280: expected 1 fields, saw 2\nSkipping line 281: expected 1 fields, saw 2\nSkipping line 282: expected 1 fields, saw 2\nSkipping line 292: expected 1 fields, saw 4\nSkipping line 293: expected 1 fields, saw 4\nSkipping line 295: expected 1 fields, saw 7\nSkipping line 296: expected 1 fields, saw 7\nSkipping line 297: expected 1 fields, saw 2\nSkipping line 302: expected 1 fields, saw 3\nSkipping line 315: expected 1 fields, saw 3\nSkipping line 321: expected 1 fields, saw 2\nSkipping line 346: expected 1 fields, saw 3\nSkipping line 347: expected 1 fields, saw 3\nSkipping line 365: expected 1 fields, saw 2\nSkipping line 408: expected 1 fields, saw 2\nSkipping line 420: expected 1 fields, saw 2\nSkipping line 421: expected 1 fields, saw 2\nSkipping line 430: expected 1 fields, saw 2\nSkipping line 434: expected 1 fields, saw 2\nSkipping line 446: expected 1 fields, saw 2\nSkipping line 448: expected 1 fields, saw 2\nSkipping line 449: expected 1 fields, saw 4\nSkipping line 451: expected 1 fields, saw 3\nSkipping line 458: expected 1 fields, saw 2\nSkipping line 459: expected 1 fields, saw 2\nSkipping line 460: expected 1 fields, saw 2\nSkipping line 465: expected 1 fields, saw 2\nSkipping line 470: expected 1 fields, saw 2\nSkipping line 471: expected 1 fields, saw 2\nSkipping line 476: expected 1 fields, saw 2\nSkipping line 495: expected 1 fields, saw 2\nSkipping line 496: expected 1 fields, saw 2\nSkipping line 497: expected 1 fields, saw 2\nSkipping line 512: expected 1 fields, saw 5\nSkipping line 513: expected 1 fields, saw 2\nSkipping line 515: expected 1 fields, saw 2\nSkipping line 517: expected 1 fields, saw 3\nSkipping line 518: expected 1 fields, saw 3\nSkipping line 519: expected 1 fields, saw 3\nSkipping line 520: expected 1 fields, saw 3\nSkipping line 521: expected 1 fields, saw 3\nSkipping line 525: expected 1 fields, saw 3\nSkipping line 533: expected 1 fields, saw 3\nSkipping line 534: expected 1 fields, saw 3\n'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>;Unnamed: 0;Name;Author;User Rating;Reviews;Price;Year;Genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0;0;10-Day Green Smoothie Cleanse;JJ Smith;4.7...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1;1;11/22/63: A Novel;Stephen King;4.6;2052;22...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2;2;12 Rules for Life: An Antidote to Chaos;Jo...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3;3;1984 (Signet Classics);George Orwell;4.7;2...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5;5;A Dance with Dragons (A Song of Ice and Fi...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The delimiter seems to be ';' based on the output of the above code</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>bestseller_books <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/bestseller_books.txt'</span>,sep<span class="op">=</span><span class="st">';'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>bestseller_books.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Name</th>
      <th>Author</th>
      <th>User Rating</th>
      <th>Reviews</th>
      <th>Price</th>
      <th>Year</th>
      <th>Genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>10-Day Green Smoothie Cleanse</td>
      <td>JJ Smith</td>
      <td>4.7</td>
      <td>17350</td>
      <td>8</td>
      <td>2016</td>
      <td>Non Fiction</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>11/22/63: A Novel</td>
      <td>Stephen King</td>
      <td>4.6</td>
      <td>2052</td>
      <td>22</td>
      <td>2011</td>
      <td>Fiction</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>12 Rules for Life: An Antidote to Chaos</td>
      <td>Jordan B. Peterson</td>
      <td>4.7</td>
      <td>18979</td>
      <td>15</td>
      <td>2018</td>
      <td>Non Fiction</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>1984 (Signet Classics)</td>
      <td>George Orwell</td>
      <td>4.7</td>
      <td>21424</td>
      <td>6</td>
      <td>2017</td>
      <td>Fiction</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>5,000 Awesome Facts (About Everything!) (Natio...</td>
      <td>National Geographic Kids</td>
      <td>4.8</td>
      <td>7665</td>
      <td>12</td>
      <td>2019</td>
      <td>Non Fiction</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The file read with ';' as the delimited is correct</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The file has"</span>,bestseller_books.shape[<span class="dv">0</span>],<span class="st">"rows and"</span>,bestseller_books.shape[<span class="dv">1</span>],<span class="st">"columns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The file has 550 rows and 9 columns</code></pre>
</div>
</div>
<p>Alternatively, you can use the argument <code>sep = None</code>, and <code>engine = 'python'</code>. The default engine is C. However, the ‘python’ engine has a ‘sniffer’ tool which may identify the delimiter automatically.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>bestseller_books <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/bestseller_books.txt'</span>,sep<span class="op">=</span><span class="va">None</span>, engine <span class="op">=</span> <span class="st">'python'</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>bestseller_books.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>Unnamed: 0.1</th>
      <th>Name</th>
      <th>Author</th>
      <th>User Rating</th>
      <th>Reviews</th>
      <th>Price</th>
      <th>Year</th>
      <th>Genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>10-Day Green Smoothie Cleanse</td>
      <td>JJ Smith</td>
      <td>4.7</td>
      <td>17350</td>
      <td>8</td>
      <td>2016</td>
      <td>Non Fiction</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>11/22/63: A Novel</td>
      <td>Stephen King</td>
      <td>4.6</td>
      <td>2052</td>
      <td>22</td>
      <td>2011</td>
      <td>Fiction</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2</td>
      <td>12 Rules for Life: An Antidote to Chaos</td>
      <td>Jordan B. Peterson</td>
      <td>4.7</td>
      <td>18979</td>
      <td>15</td>
      <td>2018</td>
      <td>Non Fiction</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>3</td>
      <td>1984 (Signet Classics)</td>
      <td>George Orwell</td>
      <td>4.7</td>
      <td>21424</td>
      <td>6</td>
      <td>2017</td>
      <td>Fiction</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>4</td>
      <td>5,000 Awesome Facts (About Everything!) (Natio...</td>
      <td>National Geographic Kids</td>
      <td>4.8</td>
      <td>7665</td>
      <td>12</td>
      <td>2019</td>
      <td>Non Fiction</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="reading-html-data" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="reading-html-data"><span class="header-section-number">3.3.3</span> Reading HTML data</h3>
<p>The <em>Pandas</em> function <em>read_html</em> searches for tabular data, i.e., data contained within the <em>&lt;table&gt;</em> tags of an html file. Let us read the tables in the GDP per capita <a href="https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)_per_capita">page</a> on Wikipedia.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading all the tables from the Wikipedia page on GDP per capita</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>tables <span class="op">=</span> pd.read_html(<span class="st">'https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)_per_capita'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All the tables will be read and stored in the variable named as <em>tables</em>. Let us find the datatype of the variable <em>tables</em>.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finidng datatype of the variable - tables</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(tables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>list</code></pre>
</div>
</div>
<p>The variable - tables is a list of all the tables read from the HTML data.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of tables read from the page</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(tables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>6</code></pre>
</div>
</div>
<p>The in-built function <em>len</em> can be used to find the length of the list - <em>tables</em> or the number of tables read from the Wikipedia page. Let us check out the first table.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking out the first table. Note that the index of the first table will be 0.</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>tables[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>.mw-parser-output .legend{page-break-inside:av...</td>
      <td>$20,000 - $30,000 $10,000 - $20,000 $5,000 - $...</td>
      <td>$1,000 - $2,500 $500 - $1,000 &lt;$500 No data</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The above table doesn’t seem to be useful. Let us check out the second table.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking out the second table. Note that the index of the first table will be 1.</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>tables[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Country/Territory</th>
      <th>UN Region</th>
      <th colspan="2" halign="left">IMF[4][5]</th>
      <th colspan="2" halign="left">United Nations[6]</th>
      <th colspan="2" halign="left">World Bank[7]</th>
    </tr>
    <tr>
      <th></th>
      <th>Country/Territory</th>
      <th>UN Region</th>
      <th>Estimate</th>
      <th>Year</th>
      <th>Estimate</th>
      <th>Year</th>
      <th>Estimate</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Liechtenstein *</td>
      <td>Europe</td>
      <td>—</td>
      <td>—</td>
      <td>180227</td>
      <td>2020</td>
      <td>169049</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Monaco *</td>
      <td>Europe</td>
      <td>—</td>
      <td>—</td>
      <td>173696</td>
      <td>2020</td>
      <td>173688</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Luxembourg *</td>
      <td>Europe</td>
      <td>135046</td>
      <td>2022</td>
      <td>117182</td>
      <td>2020</td>
      <td>135683</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bermuda *</td>
      <td>Americas</td>
      <td>—</td>
      <td>—</td>
      <td>123945</td>
      <td>2020</td>
      <td>110870</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ireland *</td>
      <td>Europe</td>
      <td>101509</td>
      <td>2022</td>
      <td>86251</td>
      <td>2020</td>
      <td>85268</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Central AfricanRepublic *</td>
      <td>Africa</td>
      <td>527</td>
      <td>2022</td>
      <td>481</td>
      <td>2020</td>
      <td>477</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>213</th>
      <td>Sierra Leone *</td>
      <td>Africa</td>
      <td>513</td>
      <td>2022</td>
      <td>475</td>
      <td>2020</td>
      <td>485</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>214</th>
      <td>Madagascar *</td>
      <td>Africa</td>
      <td>504</td>
      <td>2022</td>
      <td>470</td>
      <td>2020</td>
      <td>496</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>215</th>
      <td>South Sudan *</td>
      <td>Africa</td>
      <td>393</td>
      <td>2022</td>
      <td>1421</td>
      <td>2020</td>
      <td>1120</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>216</th>
      <td>Burundi *</td>
      <td>Africa</td>
      <td>272</td>
      <td>2022</td>
      <td>286</td>
      <td>2020</td>
      <td>274</td>
      <td>2020</td>
    </tr>
  </tbody>
</table>
<p>217 rows × 8 columns</p>
</div>
</div>
</div>
<p>The above table contains the estimated GDP per capita of all countries. This is the table that is likely to be relevant to a user interested in analyzing GDP per capita of countries. Instead of reading all tables of an HTML file, we can focus the search to tables containing certain relevant keywords. Let us try searching all table containing the word ‘Country’.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading all the tables from the Wikipedia page on GDP per capita, containing the word 'Country'</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>tables <span class="op">=</span> pd.read_html(<span class="st">'https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)_per_capita'</span>, match <span class="op">=</span> <span class="st">'Country'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <em>match</em> argument can be used to specify the keywords to be present in the table to be read.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(tables)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>1</code></pre>
</div>
</div>
<p>Only one table contains the keyword - ‘Country’. Let us check out the table obtained.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Table having the keyword - 'Country' from the HTML page</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>tables[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Country/Territory</th>
      <th>UN Region</th>
      <th colspan="2" halign="left">IMF[4][5]</th>
      <th colspan="2" halign="left">United Nations[6]</th>
      <th colspan="2" halign="left">World Bank[7]</th>
    </tr>
    <tr>
      <th></th>
      <th>Country/Territory</th>
      <th>UN Region</th>
      <th>Estimate</th>
      <th>Year</th>
      <th>Estimate</th>
      <th>Year</th>
      <th>Estimate</th>
      <th>Year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Liechtenstein *</td>
      <td>Europe</td>
      <td>—</td>
      <td>—</td>
      <td>180227</td>
      <td>2020</td>
      <td>169049</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Monaco *</td>
      <td>Europe</td>
      <td>—</td>
      <td>—</td>
      <td>173696</td>
      <td>2020</td>
      <td>173688</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Luxembourg *</td>
      <td>Europe</td>
      <td>135046</td>
      <td>2022</td>
      <td>117182</td>
      <td>2020</td>
      <td>135683</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bermuda *</td>
      <td>Americas</td>
      <td>—</td>
      <td>—</td>
      <td>123945</td>
      <td>2020</td>
      <td>110870</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ireland *</td>
      <td>Europe</td>
      <td>101509</td>
      <td>2022</td>
      <td>86251</td>
      <td>2020</td>
      <td>85268</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Central AfricanRepublic *</td>
      <td>Africa</td>
      <td>527</td>
      <td>2022</td>
      <td>481</td>
      <td>2020</td>
      <td>477</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>213</th>
      <td>Sierra Leone *</td>
      <td>Africa</td>
      <td>513</td>
      <td>2022</td>
      <td>475</td>
      <td>2020</td>
      <td>485</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>214</th>
      <td>Madagascar *</td>
      <td>Africa</td>
      <td>504</td>
      <td>2022</td>
      <td>470</td>
      <td>2020</td>
      <td>496</td>
      <td>2020</td>
    </tr>
    <tr>
      <th>215</th>
      <td>South Sudan *</td>
      <td>Africa</td>
      <td>393</td>
      <td>2022</td>
      <td>1421</td>
      <td>2020</td>
      <td>1120</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>216</th>
      <td>Burundi *</td>
      <td>Africa</td>
      <td>272</td>
      <td>2022</td>
      <td>286</td>
      <td>2020</td>
      <td>274</td>
      <td>2020</td>
    </tr>
  </tbody>
</table>
<p>217 rows × 8 columns</p>
</div>
</div>
</div>
<p>The argument <em>match</em> helps with a more focussed search, and helps us discard irrelevant tables.</p>
</section>
<section id="practice-exercise-5" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="practice-exercise-5"><span class="header-section-number">3.3.4</span> Practice exercise 5</h3>
<p>Read the table(s) consisting of attendance of spectators in FIFA worlds cup from this <a href="https://en.wikipedia.org/wiki/FIFA_World_Cup">page</a>. Read only those table(s) that have the word <em>‘attendance’</em> in them. How many rows and columns are there in the table(s)?</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>dfs <span class="op">=</span> pd.read_html(<span class="st">'https://en.wikipedia.org/wiki/FIFA_World_Cup'</span>,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>                       match<span class="op">=</span><span class="st">'attendance'</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(dfs))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> dfs[<span class="dv">0</span>]</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of rows ="</span>,data.shape[<span class="dv">0</span>], <span class="st">"and number of columns="</span>,data.shape[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
Number of rows = 22 and number of columns= 9</code></pre>
</div>
</div>
</section>
<section id="reading-json-data" class="level3" data-number="3.3.5">
<h3 data-number="3.3.5" class="anchored" data-anchor-id="reading-json-data"><span class="header-section-number">3.3.5</span> Reading JSON data</h3>
<p>JSON stands for JavaScript Object Notation, in which the data is stored and transmitted as plain text. A couple of benefits of the JSON format are:</p>
<ol type="1">
<li><p>Since the format is text only, JSON data can easily be exchanged between web applications, and used by any programming language.</p></li>
<li><p>Unlike the <em>csv</em> format, JSON supports a hierarchical data structure, and is easier to integrate with APIs.</p></li>
</ol>
<p>The JSON format can support a hierachical data structure, as it is built on the following two data structures (<em>Source: <a href="https://www.json.org/json-en.html">technical documentation</a></em>):</p>
<ul>
<li>A collection of name/value pairs. In various languages, this is realized as an object, record, struct, dictionary, hash table, keyed list, or associative array.</li>
<li>An ordered list of values. In most languages, this is realized as an array, vector, list, or sequence.</li>
</ul>
<p>These are universal data structures. Virtually all modern programming languages support them in one form or another. It makes sense that a data format that is interchangeable with programming languages also be based on these structures.</p>
<p>The <em>Pandas</em> function <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_json.html">read_json</a> converts a JSON string to a Pandas DataFrame. The function <em>dumps()</em> of the <em>json</em> library converts a Python object to a JSON string.</p>
<p>Lets read the JSON data on Ted Talks.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>tedtalks_data <span class="op">=</span> pd.read_json(<span class="st">'https://raw.githubusercontent.com/cwkenwaysun/TEDmap/master/data/TED_Talks.json'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>tedtalks_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>id</th>
      <th>speaker</th>
      <th>headline</th>
      <th>URL</th>
      <th>description</th>
      <th>transcript_URL</th>
      <th>month_filmed</th>
      <th>year_filmed</th>
      <th>event</th>
      <th>duration</th>
      <th>date_published</th>
      <th>tags</th>
      <th>newURL</th>
      <th>date</th>
      <th>views</th>
      <th>rates</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>David Pogue</td>
      <td>Simplicity sells</td>
      <td>http://www.ted.com/talks/view/id/7</td>
      <td>New York Times columnist David Pogue takes aim...</td>
      <td>http://www.ted.com/talks/view/id/7/transcript?...</td>
      <td>2</td>
      <td>2006</td>
      <td>TED2006</td>
      <td>0:21:26</td>
      <td>6/27/06</td>
      <td>simplicity,computers,software,interface design...</td>
      <td>https://www.ted.com/talks/david_pogue_says_sim...</td>
      <td>2006-06-27</td>
      <td>1646773</td>
      <td>[{'id': 7, 'name': 'Funny', 'count': 968}, {'i...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
      <td>Craig Venter</td>
      <td>Sampling the ocean's DNA</td>
      <td>http://www.ted.com/talks/view/id/6</td>
      <td>Genomics pioneer Craig Venter takes a break fr...</td>
      <td>http://www.ted.com/talks/view/id/6/transcript?...</td>
      <td>7</td>
      <td>2005</td>
      <td>TEDGlobal 2005</td>
      <td>0:16:51</td>
      <td>2004/05/07</td>
      <td>biotech,invention,oceans,genetics,DNA,biology,...</td>
      <td>https://www.ted.com/talks/craig_venter_on_dna_...</td>
      <td>2004-05-07</td>
      <td>562625</td>
      <td>[{'id': 3, 'name': 'Courageous', 'count': 21},...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>Burt Rutan</td>
      <td>The real future of space exploration</td>
      <td>http://www.ted.com/talks/view/id/4</td>
      <td>In this passionate talk, legendary spacecraft ...</td>
      <td>http://www.ted.com/talks/view/id/4/transcript?...</td>
      <td>2</td>
      <td>2006</td>
      <td>TED2006</td>
      <td>0:19:37</td>
      <td>10/25/06</td>
      <td>aircraft,flight,industrial design,NASA,rocket ...</td>
      <td>https://www.ted.com/talks/burt_rutan_sees_the_...</td>
      <td>2006-10-25</td>
      <td>2046869</td>
      <td>[{'id': 3, 'name': 'Courageous', 'count': 169}...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Ashraf Ghani</td>
      <td>How to rebuild a broken state</td>
      <td>http://www.ted.com/talks/view/id/3</td>
      <td>Ashraf Ghani's passionate and powerful 10-minu...</td>
      <td>http://www.ted.com/talks/view/id/3/transcript?...</td>
      <td>7</td>
      <td>2005</td>
      <td>TEDGlobal 2005</td>
      <td>0:18:45</td>
      <td>10/18/06</td>
      <td>corruption,poverty,economics,investment,milita...</td>
      <td>https://www.ted.com/talks/ashraf_ghani_on_rebu...</td>
      <td>2006-10-18</td>
      <td>814554</td>
      <td>[{'id': 3, 'name': 'Courageous', 'count': 140}...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Chris Bangle</td>
      <td>Great cars are great art</td>
      <td>http://www.ted.com/talks/view/id/5</td>
      <td>American designer Chris Bangle explains his ph...</td>
      <td>http://www.ted.com/talks/view/id/5/transcript?...</td>
      <td>2</td>
      <td>2002</td>
      <td>TED2002</td>
      <td>0:20:04</td>
      <td>2004/05/07</td>
      <td>cars,industrial design,transportation,inventio...</td>
      <td>https://www.ted.com/talks/chris_bangle_says_gr...</td>
      <td>2004-05-07</td>
      <td>870950</td>
      <td>[{'id': 1, 'name': 'Beautiful', 'count': 89}, ...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="practice-exercise-6" class="level3" data-number="3.3.6">
<h3 data-number="3.3.6" class="anchored" data-anchor-id="practice-exercise-6"><span class="header-section-number">3.3.6</span> Practice exercise 6</h3>
<p>Read the movies dataset from <a href="https://raw.githubusercontent.com/vega/vega-datasets/master/data/movies.json">here</a>. How many rows and columns are there in the data?</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>movies_data <span class="op">=</span> pd.read_json(<span class="st">'https://raw.githubusercontent.com/vega/vega-datasets/master/data/movies.json'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Number of rows ="</span>,movies_data.shape[<span class="dv">0</span>], <span class="st">"and number of columns="</span>,movies_data.shape[<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of rows = 3201 and number of columns= 16</code></pre>
</div>
</div>
</section>
<section id="reading-data-from-web-apis" class="level3" data-number="3.3.7">
<h3 data-number="3.3.7" class="anchored" data-anchor-id="reading-data-from-web-apis"><span class="header-section-number">3.3.7</span> Reading data from web APIs</h3>
<p><a href="https://en.wikipedia.org/wiki/API">API</a>, an acronym for Application programming interface, is a way of transferring information between systems. Many websites have public APIs that provide data via JSON or other formats. For example, the <a href="https://imdb-api.com/">IMDb-API</a> is a web service for receiving movies, serial, and cast information. API results are in the JSON format and include items such as movie specifications, ratings, Wikipedia page content, etc. One of these APIs contains ratings of the top 250 movies on IMDB. Let us read this data using the IMDB API.</p>
<p>We’ll use the <em>get</em> function from the python library <em>requests</em> to request data from the API and obtain a response code. The response code will let us know if our request to pull data from this API was successful.</p>
<div class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Importing the requests library</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> requests <span class="im">as</span> rq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Downloading imdb top 250 movie's data</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://imdb-api.com/en/API/Top250Movies/k_v6gf8ppf'</span> <span class="co">#URL of the API containing top 250 movies based on IMDB ratings</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> rq.get(url) <span class="co">#Requesting data from the API</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>response</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">
<pre><code>&lt;Response [200]&gt;</code></pre>
</div>
</div>
<p>We have a response code of 200, which indicates that the request was successful.</p>
<p>The response object’s JSON method will return a dictionary containing JSON parsed into native Python objects.</p>
<div class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>movie_data <span class="op">=</span> response.json()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>movie_data.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">
<pre><code>dict_keys(['items', 'errorMessage'])</code></pre>
</div>
</div>
<p>The <em>movie_data</em> contains only two keys. The <em>items</em> key seems likely to contain information about the top 250 movies. Let us convert the values of the <em>items</em> key (which is list of dictionaries) to a dataframe, so that we can view it in a tabular form.</p>
<div class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting a list of dictionaries to a dataframe</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>movie_data_df <span class="op">=</span> pd.DataFrame(movie_data[<span class="st">'items'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Checking the movie data pulled using the API</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>movie_data_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>id</th>
      <th>rank</th>
      <th>title</th>
      <th>fullTitle</th>
      <th>year</th>
      <th>image</th>
      <th>crew</th>
      <th>imDbRating</th>
      <th>imDbRatingCount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>tt0111161</td>
      <td>1</td>
      <td>The Shawshank Redemption</td>
      <td>The Shawshank Redemption (1994)</td>
      <td>1994</td>
      <td>https://m.media-amazon.com/images/M/MV5BMDFkYT...</td>
      <td>Frank Darabont (dir.), Tim Robbins, Morgan Fre...</td>
      <td>9.2</td>
      <td>2624065</td>
    </tr>
    <tr>
      <th>1</th>
      <td>tt0068646</td>
      <td>2</td>
      <td>The Godfather</td>
      <td>The Godfather (1972)</td>
      <td>1972</td>
      <td>https://m.media-amazon.com/images/M/MV5BM2MyNj...</td>
      <td>Francis Ford Coppola (dir.), Marlon Brando, Al...</td>
      <td>9.2</td>
      <td>1817542</td>
    </tr>
    <tr>
      <th>2</th>
      <td>tt0468569</td>
      <td>3</td>
      <td>The Dark Knight</td>
      <td>The Dark Knight (2008)</td>
      <td>2008</td>
      <td>https://m.media-amazon.com/images/M/MV5BMTMxNT...</td>
      <td>Christopher Nolan (dir.), Christian Bale, Heat...</td>
      <td>9.0</td>
      <td>2595637</td>
    </tr>
    <tr>
      <th>3</th>
      <td>tt0071562</td>
      <td>4</td>
      <td>The Godfather Part II</td>
      <td>The Godfather Part II (1974)</td>
      <td>1974</td>
      <td>https://m.media-amazon.com/images/M/MV5BMWMwMG...</td>
      <td>Francis Ford Coppola (dir.), Al Pacino, Robert...</td>
      <td>9.0</td>
      <td>1248050</td>
    </tr>
    <tr>
      <th>4</th>
      <td>tt0050083</td>
      <td>5</td>
      <td>12 Angry Men</td>
      <td>12 Angry Men (1957)</td>
      <td>1957</td>
      <td>https://m.media-amazon.com/images/M/MV5BMWU4N2...</td>
      <td>Sidney Lumet (dir.), Henry Fonda, Lee J. Cobb</td>
      <td>8.9</td>
      <td>775140</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Rows and columns of the movie data</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>movie_data_df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>(250, 9)</code></pre>
</div>
</div>
<p>This API provides the names of the top 250 movies along with the year of release, IMDB ratings, and cast information.</p>
</section>
</section>
<section id="writing-data" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="writing-data"><span class="header-section-number">3.4</span> Writing data</h2>
<p>The <em>Pandas</em> function <em>to_csv</em> can be used to write (or export) data to a <em>csv</em> or <em>txt</em> file. Below are some examples.</p>
<p><strong>Example 1:</strong> Let us export the movies data of the top 250 movies to a <em>csv</em> file.</p>
<div class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Exporting the data of the top 250 movies to a csv file</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>movie_data_df.to_csv(<span class="st">'movie_data_exported.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The file <em>movie_data_exported.csv</em> will appear in the working directory.</p>
<p><strong>Example 2:</strong> Let us export the movies data of the top 250 movies to a <em>txt</em> file with a semi-colon as the delimiter.</p>
<div class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>movie_data_df.to_csv(<span class="st">'movie_data_exported.txt'</span>,sep<span class="op">=</span><span class="st">';'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Example 3:</strong> Let us export the movies data of the top 250 movies to a <em>JSON</em> file.</p>
<div class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'movie_data.json'</span>, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    json.dump(movie_data, f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data_structures.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data structures</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./NumPy.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>