<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Science with Python - 5&nbsp; Pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Data visualization.html" rel="next">
<link href="./NumPy.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pandas</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./NU_Stat_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science with Python</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to Python and Jupyter Notebooks.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Python and Jupyter Notebooks</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_structures.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data structures</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reading data</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pandas.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pandas</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data visualization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data visualization</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data cleaning and preparation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data cleaning and preparation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data wrangling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data wrangling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data aggregation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data aggregation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Datasets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Datasets</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="toc-section-number">5.1</span>  Introduction</a></li>
  <li><a href="#pandas-data-structures---series-and-dataframe" id="toc-pandas-data-structures---series-and-dataframe" class="nav-link" data-scroll-target="#pandas-data-structures---series-and-dataframe"><span class="toc-section-number">5.2</span>  Pandas data structures - Series and DataFrame</a></li>
  <li><a href="#creating-a-pandas-series-dataframe" id="toc-creating-a-pandas-series-dataframe" class="nav-link" data-scroll-target="#creating-a-pandas-series-dataframe"><span class="toc-section-number">5.3</span>  Creating a Pandas Series / DataFrame</a>
  <ul class="collapse">
  <li><a href="#specifying-data-within-the-series-dataframe-functions" id="toc-specifying-data-within-the-series-dataframe-functions" class="nav-link" data-scroll-target="#specifying-data-within-the-series-dataframe-functions"><span class="toc-section-number">5.3.1</span>  Specifying data within the Series() / DataFrame() functions</a></li>
  <li><a href="#transforming-in-built-data-structures" id="toc-transforming-in-built-data-structures" class="nav-link" data-scroll-target="#transforming-in-built-data-structures"><span class="toc-section-number">5.3.2</span>  Transforming in-built data structures</a></li>
  <li><a href="#importing-data-from-files" id="toc-importing-data-from-files" class="nav-link" data-scroll-target="#importing-data-from-files"><span class="toc-section-number">5.3.3</span>  Importing data from files</a></li>
  </ul></li>
  <li><a href="#attributes-and-methods-of-a-pandas-dataframe" id="toc-attributes-and-methods-of-a-pandas-dataframe" class="nav-link" data-scroll-target="#attributes-and-methods-of-a-pandas-dataframe"><span class="toc-section-number">5.4</span>  Attributes and Methods of a Pandas DataFrame</a>
  <ul class="collapse">
  <li><a href="#attributes-of-a-pandas-dataframe" id="toc-attributes-of-a-pandas-dataframe" class="nav-link" data-scroll-target="#attributes-of-a-pandas-dataframe"><span class="toc-section-number">5.4.1</span>  Attributes of a Pandas DataFrame</a></li>
  <li><a href="#methods-of-a-pandas-dataframe" id="toc-methods-of-a-pandas-dataframe" class="nav-link" data-scroll-target="#methods-of-a-pandas-dataframe"><span class="toc-section-number">5.4.2</span>  Methods of a Pandas DataFrame</a></li>
  </ul></li>
  <li><a href="#data-manipulations-with-pandas" id="toc-data-manipulations-with-pandas" class="nav-link" data-scroll-target="#data-manipulations-with-pandas"><span class="toc-section-number">5.5</span>  Data manipulations with Pandas</a>
  <ul class="collapse">
  <li><a href="#sub-setting-data" id="toc-sub-setting-data" class="nav-link" data-scroll-target="#sub-setting-data"><span class="toc-section-number">5.5.1</span>  Sub-setting data</a></li>
  <li><a href="#sorting-data" id="toc-sorting-data" class="nav-link" data-scroll-target="#sorting-data"><span class="toc-section-number">5.5.2</span>  Sorting data</a></li>
  <li><a href="#ranking-data" id="toc-ranking-data" class="nav-link" data-scroll-target="#ranking-data"><span class="toc-section-number">5.5.3</span>  Ranking data</a></li>
  <li><a href="#practice-exercise-1" id="toc-practice-exercise-1" class="nav-link" data-scroll-target="#practice-exercise-1"><span class="toc-section-number">5.5.4</span>  Practice exercise 1</a></li>
  </ul></li>
  <li><a href="#operations-between-dataframe-and-series" id="toc-operations-between-dataframe-and-series" class="nav-link" data-scroll-target="#operations-between-dataframe-and-series"><span class="toc-section-number">5.6</span>  Operations between DataFrame and Series</a></li>
  <li><a href="#correlation" id="toc-correlation" class="nav-link" data-scroll-target="#correlation"><span class="toc-section-number">5.7</span>  Correlation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pandas</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="introduction" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">5.1</span> Introduction</h2>
<p>The Pandas library contains several methods and functions for cleaning, manipulating and analyzing data. While NumPy is suited for working with homogenous numerical array data, Pandas is designed for working with tabular or heterogenous data.</p>
<p>Pandas is built on top of the NumPy package. Thus, there are some similarities between the two libraries. Like NumPy, Pandas provides the basic mathematical functionalities like addition, subtraction, conditional operations and broadcasting. However, unlike NumPy library which provides objects for multi-dimensional arrays, Pandas provides the 2D table object called Dataframe.</p>
<p>Data in pandas is often used to feed statistical analysis in&nbsp;SciPy, plotting functions from&nbsp;Matplotlib, and machine learning algorithms in&nbsp;Scikit-learn.</p>
<p>Typically, the Pandas library is used for:</p>
<ul>
<li>Cleaning the data by tasks such as removing missing values, filtering rows / columns, aggregating data, mutating data, etc.</li>
<li>Computing summary statistics such as the mean, median, max, min, standard deviation, etc.</li>
<li>Computing correlation among columns in the data</li>
<li>Computing the data distribution</li>
<li>Visualizing the data with help from the Matplotlib library</li>
<li>Writing the cleaned and transformed data into a CSV file or other database formats</li>
</ul>
<p>Let’s import the Pandas library to use its methods and functions.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pandas-data-structures---series-and-dataframe" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="pandas-data-structures---series-and-dataframe"><span class="header-section-number">5.2</span> Pandas data structures - Series and DataFrame</h2>
<p>There are two core components of the Pandas library - Series and DataFrame.</p>
<p>A DataFrame is a two-dimensional object - comprising of tabular data organized in rows and columns, where individual columns can be of different value types (numeric / string / boolean etc.). A DataFrame has row labels (also called row indices) which refer to individual rows, and column labels (also called column names) that refer to individual columns. By default, the row indices are integers starting from zero. However, both the row indices and column names can be customized by the user.</p>
<p>Let us read the spotify data - <em>spotify_data.csv</em>, using the Pandas function <code>read_csv()</code>.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>spotify_data <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/spotify_data.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>spotify_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>All Girls Are The Same</td>
      <td>0</td>
      <td>165820</td>
      <td>1</td>
      <td>2021</td>
      <td>0.673</td>
      <td>...</td>
      <td>0</td>
      <td>-7.226</td>
      <td>1</td>
      <td>0.3060</td>
      <td>0.0769</td>
      <td>0.000338</td>
      <td>0.0856</td>
      <td>0.203</td>
      <td>161.991</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Lucid Dreams</td>
      <td>0</td>
      <td>239836</td>
      <td>1</td>
      <td>2021</td>
      <td>0.511</td>
      <td>...</td>
      <td>6</td>
      <td>-7.230</td>
      <td>0</td>
      <td>0.2000</td>
      <td>0.3490</td>
      <td>0.000000</td>
      <td>0.3400</td>
      <td>0.218</td>
      <td>83.903</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Hear Me Calling</td>
      <td>0</td>
      <td>189977</td>
      <td>1</td>
      <td>2021</td>
      <td>0.699</td>
      <td>...</td>
      <td>7</td>
      <td>-3.997</td>
      <td>0</td>
      <td>0.1060</td>
      <td>0.3080</td>
      <td>0.000036</td>
      <td>0.1210</td>
      <td>0.499</td>
      <td>88.933</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Robbery</td>
      <td>0</td>
      <td>240527</td>
      <td>1</td>
      <td>2021</td>
      <td>0.708</td>
      <td>...</td>
      <td>2</td>
      <td>-5.181</td>
      <td>1</td>
      <td>0.0442</td>
      <td>0.3480</td>
      <td>0.000000</td>
      <td>0.2220</td>
      <td>0.543</td>
      <td>79.993</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5988689</td>
      <td>rap</td>
      <td>Roddy Ricch</td>
      <td>88</td>
      <td>Big Stepper</td>
      <td>0</td>
      <td>175170</td>
      <td>0</td>
      <td>2021</td>
      <td>0.753</td>
      <td>...</td>
      <td>8</td>
      <td>-8.469</td>
      <td>1</td>
      <td>0.2920</td>
      <td>0.0477</td>
      <td>0.000000</td>
      <td>0.1970</td>
      <td>0.616</td>
      <td>76.997</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<p>The object <code>spotify_data</code> is a pandas DataFrame:</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(spotify_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
<p>A Series is a one-dimensional object, containing a sequence of values, where each value has an index. Each column of a DataFrame is Series as shown in the example below.</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting movie titles from the movie_ratings DataFrame</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>spotify_songs <span class="op">=</span> spotify_data[<span class="st">'track_name'</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>spotify_songs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>0                           All Girls Are The Same
1                                     Lucid Dreams
2                                  Hear Me Calling
3                                          Robbery
4                                      Big Stepper
                            ...                   
243185                                    Stardust
243186             Knockin' A Jug - 78 rpm Version
243187            When It's Sleepy Time Down South
243188    On The Sunny Side Of The Street - Part 2
243189                                    My Sweet
Name: track_name, Length: 243190, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The object movie_titles is a Series</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(spotify_songs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>pandas.core.series.Series</code></pre>
</div>
</div>
<p>A&nbsp;Series&nbsp;is essentially a column, and a&nbsp;DataFrame&nbsp;is a two-dimensional table made up of a collection of Series</p>
<div class="cell" data-execution_count="29">
<div class="cell-output cell-output-display" data-execution_count="29">
<img src="./Datasets/series_dataframe.png" width="700" height="280">
</div>
</div>
</section>
<section id="creating-a-pandas-series-dataframe" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="creating-a-pandas-series-dataframe"><span class="header-section-number">5.3</span> Creating a Pandas Series / DataFrame</h2>
<section id="specifying-data-within-the-series-dataframe-functions" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="specifying-data-within-the-series-dataframe-functions"><span class="header-section-number">5.3.1</span> Specifying data within the Series() / DataFrame() functions</h3>
<p>A Pandas Series and DataFrame can be created by specifying the data within the <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html">Series()</a> / <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html">DataFrame()</a> function. Below are examples of defining a Pandas Series / DataFrame.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining a Pandas Series</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>series_example <span class="op">=</span> pd.Series([<span class="st">'these'</span>,<span class="st">'are'</span>,<span class="st">'english'</span>,<span class="st">'words'</span>])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>series_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>0      these
1        are
2    english
3      words
dtype: object</code></pre>
</div>
</div>
<p>Note that the default row indices are integers starting from 0. However, the index can be specified with the <code>index</code> argument if desired by the user:</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining a Pandas Series with custom row labels</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>series_example <span class="op">=</span> pd.Series([<span class="st">'these'</span>,<span class="st">'are'</span>,<span class="st">'english'</span>,<span class="st">'words'</span>], index <span class="op">=</span> <span class="bu">range</span>(<span class="dv">101</span>,<span class="dv">105</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>series_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>101      these
102        are
103    english
104      words
dtype: object</code></pre>
</div>
</div>
</section>
<section id="transforming-in-built-data-structures" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="transforming-in-built-data-structures"><span class="header-section-number">5.3.2</span> Transforming in-built data structures</h3>
<p>A Pandas DataFrame can be created by converting the in-built python data structures such as lists, dictionaries, and list of dictionaries to DataFrame. See the examples below.</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#List consisting of expected age to marry of students of the STAT303-1 Fall 2022 class</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>exp_marriage_age_list<span class="op">=</span>[<span class="st">'24'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'29'</span>,<span class="st">'30'</span>,<span class="st">'27'</span>,<span class="st">'26'</span>,<span class="st">'28'</span>,<span class="st">'30+'</span>,<span class="st">'26'</span>,<span class="st">'28'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'probably never'</span>,<span class="st">'30'</span>,<span class="st">'25'</span>,<span class="st">'25'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'30+ '</span>,<span class="st">'30'</span>,<span class="st">'25'</span>,<span class="st">'28'</span>,<span class="st">'28'</span>,<span class="st">'25'</span>,<span class="st">'25'</span>,<span class="st">'27'</span>,<span class="st">'28'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'35'</span>,<span class="st">'26'</span>,<span class="st">'28'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'30'</span>,<span class="st">'25'</span>,<span class="st">'30'</span>,<span class="st">'26'</span>,<span class="st">'32'</span>,<span class="st">'27'</span>,<span class="st">'26'</span>,<span class="st">'27'</span>,<span class="st">'26'</span>,<span class="st">'28'</span>,<span class="st">'37'</span>,<span class="st">'28'</span>,<span class="st">'28'</span>,<span class="st">'28'</span>,<span class="st">'35'</span>,<span class="st">'28'</span>,<span class="st">'27'</span>,<span class="st">'28'</span>,<span class="st">'26'</span>,<span class="st">'28'</span>,<span class="st">'26'</span>,<span class="st">'30'</span>,<span class="st">'27'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'25'</span>,<span class="st">'26'</span>,<span class="st">'28'</span>,<span class="st">'35'</span>,<span class="st">'29'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'30'</span>,<span class="st">'24'</span>,<span class="st">'25'</span>,<span class="st">'29'</span>,<span class="st">'27'</span>,<span class="st">'33'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'25'</span>,<span class="st">'26'</span>,<span class="st">'30'</span>,<span class="st">'32'</span>,<span class="st">'26'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'I wont'</span>,<span class="st">'25'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'25'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'32'</span>,<span class="st">'26'</span>,<span class="st">'25'</span>,<span class="st">'never'</span>,<span class="st">'28'</span>,<span class="st">'33'</span>,<span class="st">'28'</span>,<span class="st">'35'</span>,<span class="st">'25'</span>,<span class="st">'30'</span>,<span class="st">'29'</span>,<span class="st">'30'</span>,<span class="st">'31'</span>,<span class="st">'28'</span>,<span class="st">'28'</span>,<span class="st">'30'</span>,<span class="st">'40'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'30'</span>,<span class="st">'27'</span>,<span class="st">'by 30'</span>,<span class="st">'28'</span>,<span class="st">'27'</span>,<span class="st">'28'</span>,<span class="st">'30-35'</span>,<span class="st">'35'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'never'</span>,<span class="st">'30'</span>,<span class="st">'35'</span>,<span class="st">'28'</span>,<span class="st">'31'</span>,<span class="st">'30'</span>,<span class="st">'27'</span>,<span class="st">'33'</span>,<span class="st">'32'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'26'</span>,<span class="st">'N/A'</span>,<span class="st">'25'</span>,<span class="st">'26'</span>,<span class="st">'29'</span>,<span class="st">'28'</span>,<span class="st">'34'</span>,<span class="st">'26'</span>,<span class="st">'24'</span>,<span class="st">'28'</span>,<span class="st">'30'</span>,<span class="st">'120'</span>,<span class="st">'25'</span>,<span class="st">'33'</span>,<span class="st">'27'</span>,<span class="st">'28'</span>,<span class="st">'32'</span>,<span class="st">'30'</span>,<span class="st">'26'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'28'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'30'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'28'</span>,<span class="st">'30'</span>,<span class="st">'27'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'25'</span>,<span class="st">'never'</span>,<span class="st">'69'</span>,<span class="st">'28'</span>,<span class="st">'28'</span>,<span class="st">'33'</span>,<span class="st">'30'</span>,<span class="st">'28'</span>,<span class="st">'28'</span>,<span class="st">'26'</span>,<span class="st">'30'</span>,<span class="st">'26'</span>,<span class="st">'27'</span>,<span class="st">'30'</span>,<span class="st">'25'</span>,<span class="st">'Never'</span>,<span class="st">'27'</span>,<span class="st">'27'</span>,<span class="st">'25'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example 1: Creating a Pandas Series from a list</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>exp_marriage_age_series<span class="op">=</span>pd.Series(exp_marriage_age_list,name <span class="op">=</span> <span class="st">'expected_marriage_age'</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>exp_marriage_age_series.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>0    24
1    30
2    28
3    29
4    30
Name: expected_marriage_age, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dictionary consisting of the GDP per capita of the US from 1960 to 2021 with some missing values</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>GDP_per_capita_dict <span class="op">=</span> {<span class="st">'1960'</span>:<span class="dv">3007</span>,<span class="st">'1961'</span>:<span class="dv">3067</span>,<span class="st">'1962'</span>:<span class="dv">3244</span>,<span class="st">'1963'</span>:<span class="dv">3375</span>,<span class="st">'1964'</span>:<span class="dv">3574</span>,<span class="st">'1965'</span>:<span class="dv">3828</span>,<span class="st">'1966'</span>:<span class="dv">4146</span>,<span class="st">'1967'</span>:<span class="dv">4336</span>,<span class="st">'1968'</span>:<span class="dv">4696</span>,<span class="st">'1970'</span>:<span class="dv">5234</span>,<span class="st">'1971'</span>:<span class="dv">5609</span>,<span class="st">'1972'</span>:<span class="dv">6094</span>,<span class="st">'1973'</span>:<span class="dv">6726</span>,<span class="st">'1974'</span>:<span class="dv">7226</span>,<span class="st">'1975'</span>:<span class="dv">7801</span>,<span class="st">'1976'</span>:<span class="dv">8592</span>,<span class="st">'1978'</span>:<span class="dv">10565</span>,<span class="st">'1979'</span>:<span class="dv">11674</span>, <span class="st">'1980'</span>:<span class="dv">12575</span>,<span class="st">'1981'</span>:<span class="dv">13976</span>,<span class="st">'1982'</span>:<span class="dv">14434</span>,<span class="st">'1983'</span>:<span class="dv">15544</span>,<span class="st">'1984'</span>:<span class="dv">17121</span>,<span class="st">'1985'</span>:<span class="dv">18237</span>,  <span class="st">'1986'</span>:<span class="dv">19071</span>,<span class="st">'1987'</span>:<span class="dv">20039</span>,<span class="st">'1988'</span>:<span class="dv">21417</span>,<span class="st">'1989'</span>:<span class="dv">22857</span>,<span class="st">'1990'</span>:<span class="dv">23889</span>,<span class="st">'1991'</span>:<span class="dv">24342</span>,  <span class="st">'1992'</span>:<span class="dv">25419</span>,<span class="st">'1993'</span>:<span class="dv">26387</span>,<span class="st">'1994'</span>:<span class="dv">27695</span>,<span class="st">'1995'</span>:<span class="dv">28691</span>,<span class="st">'1996'</span>:<span class="dv">29968</span>,<span class="st">'1997'</span>:<span class="dv">31459</span>,  <span class="st">'1998'</span>:<span class="dv">32854</span>,<span class="st">'2000'</span>:<span class="dv">36330</span>,<span class="st">'2001'</span>:<span class="dv">37134</span>,<span class="st">'2002'</span>:<span class="dv">37998</span>,<span class="st">'2003'</span>:<span class="dv">39490</span>,<span class="st">'2004'</span>:<span class="dv">41725</span>,  <span class="st">'2005'</span>:<span class="dv">44123</span>,<span class="st">'2006'</span>:<span class="dv">46302</span>,<span class="st">'2007'</span>:<span class="dv">48050</span>,<span class="st">'2008'</span>:<span class="dv">48570</span>,<span class="st">'2009'</span>:<span class="dv">47195</span>,<span class="st">'2010'</span>:<span class="dv">48651</span>,  <span class="st">'2011'</span>:<span class="dv">50066</span>,<span class="st">'2012'</span>:<span class="dv">51784</span>,<span class="st">'2013'</span>:<span class="dv">53291</span>,<span class="st">'2015'</span>:<span class="dv">56763</span>,<span class="st">'2016'</span>:<span class="dv">57867</span>,<span class="st">'2017'</span>:<span class="dv">59915</span>,<span class="st">'2018'</span>:<span class="dv">62805</span>, <span class="st">'2019'</span>:<span class="dv">65095</span>,<span class="st">'2020'</span>:<span class="dv">63028</span>,<span class="st">'2021'</span>:<span class="dv">69288</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example 2: Creating a Pandas Series from a Dictionary</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>GDP_per_capita_series <span class="op">=</span> pd.Series(GDP_per_capita_dict)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>GDP_per_capita_series.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>1960    3007
1961    3067
1962    3244
1963    3375
1964    3574
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#List of dictionary consisting of 52 playing cards of the deck</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>deck_list_of_dictionaries <span class="op">=</span> [{<span class="st">'value'</span>:i, <span class="st">'suit'</span>:c}</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> [<span class="st">'spades'</span>, <span class="st">'clubs'</span>, <span class="st">'hearts'</span>, <span class="st">'diamonds'</span>]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>,<span class="dv">15</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="69">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example 3: Creating a Pandas DataFrame from a List of dictionaries</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>deck_df <span class="op">=</span> pd.DataFrame(deck_list_of_dictionaries)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>deck_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>value</th>
      <th>suit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>spades</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>spades</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>spades</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>spades</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>spades</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="importing-data-from-files" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="importing-data-from-files"><span class="header-section-number">5.3.3</span> Importing data from files</h3>
<p>In the real world, a Pandas DataFrame will typically be created by loading the datasets from existing storage such as SQL Database, CSV file, Excel file, text files, HTML files, etc., as we learned in the third chapter of the book on Reading data.</p>
</section>
</section>
<section id="attributes-and-methods-of-a-pandas-dataframe" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="attributes-and-methods-of-a-pandas-dataframe"><span class="header-section-number">5.4</span> Attributes and Methods of a Pandas DataFrame</h2>
<p>All attributes and methods of a Pandas DataFrame object can be viewed with the python’s built-in <a href="https://docs.python.org/3/library/functions.html#dir">dir()</a> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#List of attributes and methods of a Pandas DataFrame</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#This code is not executed as the list is too long</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">dir</span>(spotify_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Although we’ll see examples of attributes and methods of a Pandas DataFrame, please note that most of these attributes and methods are also applicable to the Pandas Series object.</p>
<section id="attributes-of-a-pandas-dataframe" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="attributes-of-a-pandas-dataframe"><span class="header-section-number">5.4.1</span> Attributes of a Pandas DataFrame</h3>
<p>Some of the attributes of the Pandas DataFrame class are the following.</p>
<ol type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dtypes.html">dtypes</a>: This attribute is a Series consisting the datatypes of columns of a Pandas DataFrame.</li>
</ol>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>spotify_data.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>artist_followers       int64
genres                object
artist_name           object
artist_popularity      int64
track_name            object
track_popularity       int64
duration_ms            int64
explicit               int64
release_year           int64
danceability         float64
energy               float64
key                    int64
loudness             float64
mode                   int64
speechiness          float64
acousticness         float64
instrumentalness     float64
liveness             float64
valence              float64
tempo                float64
time_signature         int64
dtype: object</code></pre>
</div>
</div>
<p>The table below describes the datatypes of columns in a Pandas DataFrame.</p>
<table class="table">
<thead>
<tr class="header">
<th>Pandas Type</th>
<th>Native Python Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>object</td>
<td>string</td>
<td>The most general dtype. This datatype is assigned to a column if the column has mixed types (numbers and strings)</td>
</tr>
<tr class="even">
<td>int64</td>
<td>int</td>
<td>This datatype is for integers from -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807 or for integers havind a maximum sizeo of 64 bits</td>
</tr>
<tr class="odd">
<td>float64</td>
<td>float</td>
<td>This datatype is for real numbers. If a column contains integers and NaNs, Pandas will default to float64. This is because the missing values may be a real number</td>
</tr>
<tr class="even">
<td>datetime64, timedelta[ns]</td>
<td>N/A (but see the&nbsp;<a href="https://docs.python.org/2/library/datetime.html">datetime</a>&nbsp;module in Python’s standard library)</td>
<td>Values meant to hold time data. This datatype is useful for time series analysis</td>
</tr>
</tbody>
</table>
<ol start="2" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.columns.html">columns</a>: This attribute consists of the column labels (or column names) of a Pandas DataFrame.</li>
</ol>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>spotify_data.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>Index(['artist_followers', 'genres', 'artist_name', 'artist_popularity',
       'track_name', 'track_popularity', 'duration_ms', 'explicit',
       'release_year', 'danceability', 'energy', 'key', 'loudness', 'mode',
       'speechiness', 'acousticness', 'instrumentalness', 'liveness',
       'valence', 'tempo', 'time_signature'],
      dtype='object')</code></pre>
</div>
</div>
<ol start="3" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Index.html">index</a>: This attribute consists of the row lables (or row indices) of a Pandas DataFrame.</li>
</ol>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>spotify_data.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>RangeIndex(start=0, stop=243190, step=1)</code></pre>
</div>
</div>
<ol start="4" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.axes.html">axes</a>: This is a list of length two, where the first element is the row labels, and the second element is the columns labels. In other words, this attribute combines the information in the attributes - <code>index</code> and <code>columns</code>.</li>
</ol>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>spotify_data.axes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>[RangeIndex(start=0, stop=243190, step=1),
 Index(['artist_followers', 'genres', 'artist_name', 'artist_popularity',
        'track_name', 'track_popularity', 'duration_ms', 'explicit',
        'release_year', 'danceability', 'energy', 'key', 'loudness', 'mode',
        'speechiness', 'acousticness', 'instrumentalness', 'liveness',
        'valence', 'tempo', 'time_signature'],
       dtype='object')]</code></pre>
</div>
</div>
<ol start="5" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.ndim.html">ndim</a> in NumPy, this attribute specifies the number of dimensions. However, unlike NumPy, a Pandas DataFrame has a fixed dimenstion of 2, and a Pandas Series has a fixed dimesion of 1.</li>
</ol>
<div class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>spotify_data.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>2</code></pre>
</div>
</div>
<ol start="6" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.size.html">size</a>: This attribute specifies the number of elements in a DataFrame. Its value is the product of the number of rows and columns.</li>
</ol>
<div class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>spotify_data.size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>5106990</code></pre>
</div>
</div>
<ol start="7" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.shape.html">shape</a>: This is a tuple consisting of the number of rows and columns in a Pandas DataFrame.</li>
</ol>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>spotify_data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>(243190, 21)</code></pre>
</div>
</div>
<ol start="8" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.values.html">values</a>: This provides a NumPy representation of a Pandas DataFrame.</li>
</ol>
<div class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>spotify_data.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>array([[16996777, 'rap', 'Juice WRLD', ..., 0.203, 161.991, 4],
       [16996777, 'rap', 'Juice WRLD', ..., 0.218, 83.903, 4],
       [16996777, 'rap', 'Juice WRLD', ..., 0.499, 88.933, 4],
       ...,
       [2256652, 'jazz', 'Louis Armstrong', ..., 0.37, 105.093, 4],
       [2256652, 'jazz', 'Louis Armstrong', ..., 0.576, 101.279, 4],
       [2256652, 'jazz', 'Louis Armstrong', ..., 0.816, 105.84, 4]],
      dtype=object)</code></pre>
</div>
</div>
</section>
<section id="methods-of-a-pandas-dataframe" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="methods-of-a-pandas-dataframe"><span class="header-section-number">5.4.2</span> Methods of a Pandas DataFrame</h3>
<p>Some of the commonly used methods of the Pandas DataFrame class are the following.</p>
<ol type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html">head()</a>: Prints the first <em>n</em> rows of a DataFrame.</li>
</ol>
<div class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>spotify_data.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>All Girls Are The Same</td>
      <td>0</td>
      <td>165820</td>
      <td>1</td>
      <td>2021</td>
      <td>0.673</td>
      <td>...</td>
      <td>0</td>
      <td>-7.226</td>
      <td>1</td>
      <td>0.306</td>
      <td>0.0769</td>
      <td>0.000338</td>
      <td>0.0856</td>
      <td>0.203</td>
      <td>161.991</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Lucid Dreams</td>
      <td>0</td>
      <td>239836</td>
      <td>1</td>
      <td>2021</td>
      <td>0.511</td>
      <td>...</td>
      <td>6</td>
      <td>-7.230</td>
      <td>0</td>
      <td>0.200</td>
      <td>0.3490</td>
      <td>0.000000</td>
      <td>0.3400</td>
      <td>0.218</td>
      <td>83.903</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 21 columns</p>
</div>
</div>
</div>
<ol start="2" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.tail.html">tail()</a>: Prints the last <em>n</em> rows of a DataFrame.</li>
</ol>
<div class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>spotify_data.tail(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>243187</th>
      <td>2256652</td>
      <td>jazz</td>
      <td>Louis Armstrong</td>
      <td>74</td>
      <td>When It's Sleepy Time Down South</td>
      <td>4</td>
      <td>200200</td>
      <td>0</td>
      <td>1923</td>
      <td>0.527</td>
      <td>...</td>
      <td>3</td>
      <td>-14.814</td>
      <td>1</td>
      <td>0.0793</td>
      <td>0.989</td>
      <td>0.00001</td>
      <td>0.1040</td>
      <td>0.370</td>
      <td>105.093</td>
      <td>4</td>
    </tr>
    <tr>
      <th>243188</th>
      <td>2256652</td>
      <td>jazz</td>
      <td>Louis Armstrong</td>
      <td>74</td>
      <td>On The Sunny Side Of The Street - Part 2</td>
      <td>4</td>
      <td>185973</td>
      <td>0</td>
      <td>1923</td>
      <td>0.559</td>
      <td>...</td>
      <td>0</td>
      <td>-9.804</td>
      <td>1</td>
      <td>0.0512</td>
      <td>0.989</td>
      <td>0.84700</td>
      <td>0.4480</td>
      <td>0.576</td>
      <td>101.279</td>
      <td>4</td>
    </tr>
    <tr>
      <th>243189</th>
      <td>2256652</td>
      <td>jazz</td>
      <td>Louis Armstrong</td>
      <td>74</td>
      <td>My Sweet</td>
      <td>4</td>
      <td>195960</td>
      <td>0</td>
      <td>1923</td>
      <td>0.741</td>
      <td>...</td>
      <td>3</td>
      <td>-10.406</td>
      <td>1</td>
      <td>0.0505</td>
      <td>0.927</td>
      <td>0.07880</td>
      <td>0.0633</td>
      <td>0.816</td>
      <td>105.840</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 21 columns</p>
</div>
</div>
</div>
<ol start="3" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html">describe()</a>: Print summary statistics of a Pandas DataFrame, as seen in chapter 3 on Reading Data.</li>
</ol>
<div class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>spotify_data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>artist_popularity</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>energy</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2.431900e+05</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>2.431900e+05</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.960931e+06</td>
      <td>65.342633</td>
      <td>36.080772</td>
      <td>2.263209e+05</td>
      <td>0.050039</td>
      <td>1992.475258</td>
      <td>0.568357</td>
      <td>0.580633</td>
      <td>5.240326</td>
      <td>-9.432548</td>
      <td>0.670928</td>
      <td>0.111984</td>
      <td>0.383938</td>
      <td>0.071169</td>
      <td>0.223756</td>
      <td>0.552302</td>
      <td>119.335060</td>
      <td>3.884177</td>
    </tr>
    <tr>
      <th>std</th>
      <td>5.028746e+06</td>
      <td>10.289182</td>
      <td>16.476836</td>
      <td>9.973214e+04</td>
      <td>0.218026</td>
      <td>18.481463</td>
      <td>0.159444</td>
      <td>0.236631</td>
      <td>3.532546</td>
      <td>4.449731</td>
      <td>0.469877</td>
      <td>0.198068</td>
      <td>0.321142</td>
      <td>0.209555</td>
      <td>0.198076</td>
      <td>0.250017</td>
      <td>29.864219</td>
      <td>0.458082</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.300000e+01</td>
      <td>51.000000</td>
      <td>0.000000</td>
      <td>3.344000e+03</td>
      <td>0.000000</td>
      <td>1923.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-60.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.832620e+05</td>
      <td>57.000000</td>
      <td>25.000000</td>
      <td>1.776670e+05</td>
      <td>0.000000</td>
      <td>1980.000000</td>
      <td>0.462000</td>
      <td>0.405000</td>
      <td>2.000000</td>
      <td>-11.990000</td>
      <td>0.000000</td>
      <td>0.033200</td>
      <td>0.070000</td>
      <td>0.000000</td>
      <td>0.098100</td>
      <td>0.353000</td>
      <td>96.099250</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>5.352520e+05</td>
      <td>64.000000</td>
      <td>36.000000</td>
      <td>2.188670e+05</td>
      <td>0.000000</td>
      <td>1994.000000</td>
      <td>0.579000</td>
      <td>0.591000</td>
      <td>5.000000</td>
      <td>-8.645000</td>
      <td>1.000000</td>
      <td>0.043100</td>
      <td>0.325000</td>
      <td>0.000011</td>
      <td>0.141000</td>
      <td>0.560000</td>
      <td>118.002000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.587332e+06</td>
      <td>72.000000</td>
      <td>48.000000</td>
      <td>2.645465e+05</td>
      <td>0.000000</td>
      <td>2008.000000</td>
      <td>0.685000</td>
      <td>0.776000</td>
      <td>8.000000</td>
      <td>-6.131000</td>
      <td>1.000000</td>
      <td>0.075300</td>
      <td>0.671000</td>
      <td>0.002220</td>
      <td>0.292000</td>
      <td>0.760000</td>
      <td>137.929000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.890023e+07</td>
      <td>100.000000</td>
      <td>99.000000</td>
      <td>4.995083e+06</td>
      <td>1.000000</td>
      <td>2021.000000</td>
      <td>0.988000</td>
      <td>1.000000</td>
      <td>11.000000</td>
      <td>3.744000</td>
      <td>1.000000</td>
      <td>0.969000</td>
      <td>0.996000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>243.507000</td>
      <td>5.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ol start="4" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.max.html">max()</a>/<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.min.html">min()</a>`: Returns the max/min values of numeric columns If the function is applied on non-numeric columns, it will return the maximum/minimum value based on the order of the alphabet.</li>
</ol>
<div class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The max() method applied on a Series</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>spotify_data[<span class="st">'artist_popularity'</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>100</code></pre>
</div>
</div>
<div class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The max() method applied on a DataFrame</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>spotify_data.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre><code>artist_followers                    78900234
genres                                  rock
artist_name                          高爾宣 OSN
artist_popularity                        100
track_name           행복했던 날들이었다 days gone by
track_popularity                          99
duration_ms                          4995083
explicit                                   1
release_year                            2021
danceability                           0.988
energy                                   1.0
key                                       11
loudness                               3.744
mode                                       1
speechiness                            0.969
acousticness                           0.996
instrumentalness                         1.0
liveness                                 1.0
valence                                  1.0
tempo                                243.507
time_signature                             5
dtype: object</code></pre>
</div>
</div>
<ol start="5" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mean.html">mean()</a>/<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.median.html">median()</a>`: Returns the mean/median values of numeric columns.</li>
</ol>
<div class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>spotify_data.median()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>artist_followers     535252.000000
artist_popularity        64.000000
track_popularity         36.000000
duration_ms          218867.000000
explicit                  0.000000
release_year           1994.000000
danceability              0.579000
energy                    0.591000
key                       5.000000
loudness                 -8.645000
mode                      1.000000
speechiness               0.043100
acousticness              0.325000
instrumentalness          0.000011
liveness                  0.141000
valence                   0.560000
tempo                   118.002000
time_signature            4.000000
dtype: float64</code></pre>
</div>
</div>
<ol start="6" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.std.html">std()</a>: Returns the standard deviation of numeric columns.</li>
</ol>
<div class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>spotify_data.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>artist_followers     5.028746e+06
artist_popularity    1.028918e+01
track_popularity     1.647684e+01
duration_ms          9.973214e+04
explicit             2.180260e-01
release_year         1.848146e+01
danceability         1.594436e-01
energy               2.366309e-01
key                  3.532546e+00
loudness             4.449731e+00
mode                 4.698771e-01
speechiness          1.980684e-01
acousticness         3.211417e-01
instrumentalness     2.095551e-01
liveness             1.980759e-01
valence              2.500172e-01
tempo                2.986422e+01
time_signature       4.580822e-01
dtype: float64</code></pre>
</div>
</div>
<ol start="7" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sample.html">sample(n)</a>: Returns <em>n</em> random observations from a Pandas DataFrame.</li>
</ol>
<div class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>spotify_data.sample(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>42809</th>
      <td>385756</td>
      <td>rock</td>
      <td>Saxon</td>
      <td>56</td>
      <td>Never Surrender - 2009 Remastered Version</td>
      <td>2</td>
      <td>195933</td>
      <td>0</td>
      <td>2012</td>
      <td>0.506</td>
      <td>...</td>
      <td>6</td>
      <td>-7.847</td>
      <td>1</td>
      <td>0.0633</td>
      <td>0.0535</td>
      <td>0.00001</td>
      <td>0.3330</td>
      <td>0.536</td>
      <td>90.989</td>
      <td>4</td>
    </tr>
    <tr>
      <th>25730</th>
      <td>810526</td>
      <td>hip hop</td>
      <td>Froid</td>
      <td>68</td>
      <td>Pseudosocial</td>
      <td>54</td>
      <td>135963</td>
      <td>0</td>
      <td>2016</td>
      <td>0.644</td>
      <td>...</td>
      <td>7</td>
      <td>-9.098</td>
      <td>0</td>
      <td>0.3280</td>
      <td>0.8270</td>
      <td>0.00001</td>
      <td>0.1630</td>
      <td>0.886</td>
      <td>117.170</td>
      <td>4</td>
    </tr>
    <tr>
      <th>147392</th>
      <td>479209</td>
      <td>jazz</td>
      <td>Sarah Vaughan</td>
      <td>59</td>
      <td>Love Dance</td>
      <td>14</td>
      <td>204400</td>
      <td>0</td>
      <td>1982</td>
      <td>0.386</td>
      <td>...</td>
      <td>0</td>
      <td>-23.819</td>
      <td>1</td>
      <td>0.0372</td>
      <td>0.8970</td>
      <td>0.00000</td>
      <td>0.0943</td>
      <td>0.102</td>
      <td>110.981</td>
      <td>3</td>
    </tr>
    <tr>
      <th>233189</th>
      <td>1201905</td>
      <td>rock</td>
      <td>Grateful Dead</td>
      <td>72</td>
      <td>Cold Rain and Snow - 2013 Remaster</td>
      <td>29</td>
      <td>151702</td>
      <td>0</td>
      <td>1967</td>
      <td>0.412</td>
      <td>...</td>
      <td>6</td>
      <td>-10.476</td>
      <td>0</td>
      <td>0.0487</td>
      <td>0.4090</td>
      <td>0.58300</td>
      <td>0.1630</td>
      <td>0.875</td>
      <td>168.803</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 21 columns</p>
</div>
</div>
</div>
<ol start="8" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dropna.html">dropna()</a>: Drops all observations with at least one missing value.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This code is not executed to avoid prining a large table</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>spotify_data.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="9" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html">apply()</a>: This method is used to apply a function over all columns or rows of a Pandas DataFrame. For example, let us find the range of values of <code>artist_followers</code>, <code>artist_popularity</code> and <code>release_year</code>.</li>
</ol>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining the function to compute range of values of a columns</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> range_of_values(x):</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x.<span class="bu">max</span>()<span class="op">-</span>x.<span class="bu">min</span>()</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Applying the function to three coluumns for which we wish to find the range of values</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>spotify_data[[<span class="st">'artist_followers'</span>,<span class="st">'artist_popularity'</span>,<span class="st">'release_year'</span>]].<span class="bu">apply</span>(range_of_values, axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<pre><code>artist_followers     78900211
artist_popularity          49
release_year               98
dtype: int64</code></pre>
</div>
</div>
<p>The <code>apply()</code> method is often used with the one line function known as <code>lambda</code> function in python. These functions do not require a name, and can be defined using the keyword <code>lambda</code>. The above block of code can be concisely written as:</p>
<div class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>spotify_data[[<span class="st">'artist_followers'</span>,<span class="st">'artist_popularity'</span>,<span class="st">'release_year'</span>]].<span class="bu">apply</span>(<span class="kw">lambda</span> x:x.<span class="bu">max</span>()<span class="op">-</span>x.<span class="bu">min</span>(), axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">
<pre><code>artist_followers     78900211
artist_popularity          49
release_year               98
dtype: int64</code></pre>
</div>
</div>
<ol start="10" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.map.html">map()</a>: The function is used to map distinct values of a Pandas Series to another set of corresponding values.</li>
</ol>
<p>For example, suppose we wish to create a new column in the spotify dataset which indicates the modality of the song - major (mode = 1) or minor (mode = 0). We’ll map the values of the <code>mode</code> column to the categories <em>major</em> and <em>minor</em>:</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a dictionary that maps the values 0 and 1 to minor and major respectively</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>map_mode <span class="op">=</span> {<span class="dv">0</span>:<span class="st">'minor'</span>, <span class="dv">1</span>:<span class="st">'major'</span>}</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co">#The map() function requires a dictionary object, and maps the 'values' of the 'keys' in the dictionary</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>spotify_data[<span class="st">'modality'</span>] <span class="op">=</span> spotify_data[<span class="st">'mode'</span>].<span class="bu">map</span>(map_mode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see the variable <code>modality</code> in the updated DataFrame.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>spotify_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>modality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>All Girls Are The Same</td>
      <td>0</td>
      <td>165820</td>
      <td>1</td>
      <td>2021</td>
      <td>0.673</td>
      <td>...</td>
      <td>-7.226</td>
      <td>1</td>
      <td>0.3060</td>
      <td>0.0769</td>
      <td>0.000338</td>
      <td>0.0856</td>
      <td>0.203</td>
      <td>161.991</td>
      <td>4</td>
      <td>major</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Lucid Dreams</td>
      <td>0</td>
      <td>239836</td>
      <td>1</td>
      <td>2021</td>
      <td>0.511</td>
      <td>...</td>
      <td>-7.230</td>
      <td>0</td>
      <td>0.2000</td>
      <td>0.3490</td>
      <td>0.000000</td>
      <td>0.3400</td>
      <td>0.218</td>
      <td>83.903</td>
      <td>4</td>
      <td>minor</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Hear Me Calling</td>
      <td>0</td>
      <td>189977</td>
      <td>1</td>
      <td>2021</td>
      <td>0.699</td>
      <td>...</td>
      <td>-3.997</td>
      <td>0</td>
      <td>0.1060</td>
      <td>0.3080</td>
      <td>0.000036</td>
      <td>0.1210</td>
      <td>0.499</td>
      <td>88.933</td>
      <td>4</td>
      <td>minor</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Robbery</td>
      <td>0</td>
      <td>240527</td>
      <td>1</td>
      <td>2021</td>
      <td>0.708</td>
      <td>...</td>
      <td>-5.181</td>
      <td>1</td>
      <td>0.0442</td>
      <td>0.3480</td>
      <td>0.000000</td>
      <td>0.2220</td>
      <td>0.543</td>
      <td>79.993</td>
      <td>4</td>
      <td>major</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5988689</td>
      <td>rap</td>
      <td>Roddy Ricch</td>
      <td>88</td>
      <td>Big Stepper</td>
      <td>0</td>
      <td>175170</td>
      <td>0</td>
      <td>2021</td>
      <td>0.753</td>
      <td>...</td>
      <td>-8.469</td>
      <td>1</td>
      <td>0.2920</td>
      <td>0.0477</td>
      <td>0.000000</td>
      <td>0.1970</td>
      <td>0.616</td>
      <td>76.997</td>
      <td>4</td>
      <td>major</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>
</div>
</div>
<ol start="11" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.drop.html">drop()</a>: This function is used to drop rows/columns from a DataFrame.</li>
</ol>
<p>For example, let us drop the columns <code>mode</code> from the spotify dataset:</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dropping the column 'mode'</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>spotify_data_new <span class="op">=</span> spotify_data.drop(<span class="st">'mode'</span>,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>spotify_data_new.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>modality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>All Girls Are The Same</td>
      <td>0</td>
      <td>165820</td>
      <td>1</td>
      <td>2021</td>
      <td>0.673</td>
      <td>...</td>
      <td>0</td>
      <td>-7.226</td>
      <td>0.3060</td>
      <td>0.0769</td>
      <td>0.000338</td>
      <td>0.0856</td>
      <td>0.203</td>
      <td>161.991</td>
      <td>4</td>
      <td>major</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Lucid Dreams</td>
      <td>0</td>
      <td>239836</td>
      <td>1</td>
      <td>2021</td>
      <td>0.511</td>
      <td>...</td>
      <td>6</td>
      <td>-7.230</td>
      <td>0.2000</td>
      <td>0.3490</td>
      <td>0.000000</td>
      <td>0.3400</td>
      <td>0.218</td>
      <td>83.903</td>
      <td>4</td>
      <td>minor</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Hear Me Calling</td>
      <td>0</td>
      <td>189977</td>
      <td>1</td>
      <td>2021</td>
      <td>0.699</td>
      <td>...</td>
      <td>7</td>
      <td>-3.997</td>
      <td>0.1060</td>
      <td>0.3080</td>
      <td>0.000036</td>
      <td>0.1210</td>
      <td>0.499</td>
      <td>88.933</td>
      <td>4</td>
      <td>minor</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Robbery</td>
      <td>0</td>
      <td>240527</td>
      <td>1</td>
      <td>2021</td>
      <td>0.708</td>
      <td>...</td>
      <td>2</td>
      <td>-5.181</td>
      <td>0.0442</td>
      <td>0.3480</td>
      <td>0.000000</td>
      <td>0.2220</td>
      <td>0.543</td>
      <td>79.993</td>
      <td>4</td>
      <td>major</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5988689</td>
      <td>rap</td>
      <td>Roddy Ricch</td>
      <td>88</td>
      <td>Big Stepper</td>
      <td>0</td>
      <td>175170</td>
      <td>0</td>
      <td>2021</td>
      <td>0.753</td>
      <td>...</td>
      <td>8</td>
      <td>-8.469</td>
      <td>0.2920</td>
      <td>0.0477</td>
      <td>0.000000</td>
      <td>0.1970</td>
      <td>0.616</td>
      <td>76.997</td>
      <td>4</td>
      <td>major</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<p>Note that if multiple columns or rows are to be dropped, they must be enclosed in box brackets.</p>
<ol start="12" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.unique.html">unique()</a>: This functions provides the unique values of a Series. For example, let us find the number of unique genres of songs in the spotify dataset:</li>
</ol>
<div class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>spotify_data.genres.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<pre><code>array(['rap', 'pop', 'miscellaneous', 'metal', 'hip hop', 'rock',
       'pop &amp; rock', 'hoerspiel', 'folk', 'electronic', 'jazz', 'country',
       'latin'], dtype=object)</code></pre>
</div>
</div>
<ol start="13" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.value_counts.html">value_counts()</a> This function provides the number of observations of each value of a Series. For example, let us find the number of songs of each genre in the spotify dataset:</li>
</ol>
<div class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>spotify_data.genres.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<pre><code>pop              70441
rock             49785
pop &amp; rock       43437
miscellaneous    35848
jazz             13363
hoerspiel        12514
hip hop           7373
folk              2821
latin             2125
rap               1798
metal             1659
country           1236
electronic         790
Name: genres, dtype: int64</code></pre>
</div>
</div>
<p>More than half the songs in the dataset are <em>pop, rock</em> or <em>pop &amp; rock</em>.</p>
<ol start="14" type="1">
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isin.html">isin()</a>: This function provides a boolean Series indicating the position of certain values in a Series. The function is helpful in sub-setting data. For example, let us subset the songs that are either <em>latin, rap,</em> or <em>metal</em>:</li>
</ol>
<div class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>latin_rap_metal_songs <span class="op">=</span> spotify_data.loc[spotify_data.genres.isin([<span class="st">'latin'</span>,<span class="st">'rap'</span>,<span class="st">'metal'</span>]),:]</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>latin_rap_metal_songs.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="155">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>All Girls Are The Same</td>
      <td>0</td>
      <td>165820</td>
      <td>1</td>
      <td>2021</td>
      <td>0.673</td>
      <td>...</td>
      <td>0</td>
      <td>-7.226</td>
      <td>1</td>
      <td>0.3060</td>
      <td>0.0769</td>
      <td>0.000338</td>
      <td>0.0856</td>
      <td>0.203</td>
      <td>161.991</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Lucid Dreams</td>
      <td>0</td>
      <td>239836</td>
      <td>1</td>
      <td>2021</td>
      <td>0.511</td>
      <td>...</td>
      <td>6</td>
      <td>-7.230</td>
      <td>0</td>
      <td>0.2000</td>
      <td>0.3490</td>
      <td>0.000000</td>
      <td>0.3400</td>
      <td>0.218</td>
      <td>83.903</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Hear Me Calling</td>
      <td>0</td>
      <td>189977</td>
      <td>1</td>
      <td>2021</td>
      <td>0.699</td>
      <td>...</td>
      <td>7</td>
      <td>-3.997</td>
      <td>0</td>
      <td>0.1060</td>
      <td>0.3080</td>
      <td>0.000036</td>
      <td>0.1210</td>
      <td>0.499</td>
      <td>88.933</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Robbery</td>
      <td>0</td>
      <td>240527</td>
      <td>1</td>
      <td>2021</td>
      <td>0.708</td>
      <td>...</td>
      <td>2</td>
      <td>-5.181</td>
      <td>1</td>
      <td>0.0442</td>
      <td>0.3480</td>
      <td>0.000000</td>
      <td>0.2220</td>
      <td>0.543</td>
      <td>79.993</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5988689</td>
      <td>rap</td>
      <td>Roddy Ricch</td>
      <td>88</td>
      <td>Big Stepper</td>
      <td>0</td>
      <td>175170</td>
      <td>0</td>
      <td>2021</td>
      <td>0.753</td>
      <td>...</td>
      <td>8</td>
      <td>-8.469</td>
      <td>1</td>
      <td>0.2920</td>
      <td>0.0477</td>
      <td>0.000000</td>
      <td>0.1970</td>
      <td>0.616</td>
      <td>76.997</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="data-manipulations-with-pandas" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="data-manipulations-with-pandas"><span class="header-section-number">5.5</span> Data manipulations with Pandas</h2>
<section id="sub-setting-data" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="sub-setting-data"><span class="header-section-number">5.5.1</span> Sub-setting data</h3>
<section id="loc-and-iloc-with-the-original-row-column-index" class="level4" data-number="5.5.1.1">
<h4 data-number="5.5.1.1" class="anchored" data-anchor-id="loc-and-iloc-with-the-original-row-column-index"><span class="header-section-number">5.5.1.1</span> <code>loc</code> and <code>iloc</code> with the original row / column index</h4>
<p><strong>Subsetting observations:</strong> In the chapter on reading data, we learned about operators <code>loc</code> and <code>iloc</code> that can be used to subset data based on axis labels and position of rows/columns respectively. However, usually we are not aware of the relevant row indices, and we may want to subset data based on some condition(s). For example, suppose we wish to analyze only those songs whose track popularity is higher than 50.</p>
<p><strong>Q:</strong> Do we need to subset rows or columns in this case?<br>
<strong>A:</strong> Rows, as songs correspond to rows, while features of songs correspond to columns.</p>
<p>As we need to subset rows, the filter must be applied at the starting index, i.e., the index before the <code>,</code>. As we don’t need to subset any specific features of the songs, there is no subsetting to be done on the columns. A <code>:</code> at the ending index means that all columns need to selected.</p>
<div class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting spotify songs that have track popularity score of more than 50</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>popular_songs <span class="op">=</span> spotify_data.loc[spotify_data.track_popularity<span class="op">&gt;=</span><span class="dv">50</span>,:]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>popular_songs.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>181</th>
      <td>1277325</td>
      <td>hip hop</td>
      <td>Dave</td>
      <td>77</td>
      <td>Titanium</td>
      <td>69</td>
      <td>127750</td>
      <td>1</td>
      <td>2021</td>
      <td>0.959</td>
      <td>...</td>
      <td>0</td>
      <td>-8.687</td>
      <td>0</td>
      <td>0.4370</td>
      <td>0.152000</td>
      <td>0.000001</td>
      <td>0.1050</td>
      <td>0.510</td>
      <td>121.008</td>
      <td>4</td>
    </tr>
    <tr>
      <th>191</th>
      <td>1123869</td>
      <td>rap</td>
      <td>Jay Wheeler</td>
      <td>85</td>
      <td>Viendo el Techo</td>
      <td>64</td>
      <td>188955</td>
      <td>0</td>
      <td>2021</td>
      <td>0.741</td>
      <td>...</td>
      <td>11</td>
      <td>-6.029</td>
      <td>0</td>
      <td>0.2290</td>
      <td>0.306000</td>
      <td>0.000327</td>
      <td>0.1000</td>
      <td>0.265</td>
      <td>179.972</td>
      <td>4</td>
    </tr>
    <tr>
      <th>208</th>
      <td>3657199</td>
      <td>rap</td>
      <td>Polo G</td>
      <td>91</td>
      <td>RAPSTAR</td>
      <td>89</td>
      <td>165926</td>
      <td>1</td>
      <td>2021</td>
      <td>0.789</td>
      <td>...</td>
      <td>6</td>
      <td>-6.862</td>
      <td>1</td>
      <td>0.2420</td>
      <td>0.410000</td>
      <td>0.000000</td>
      <td>0.1290</td>
      <td>0.437</td>
      <td>81.039</td>
      <td>4</td>
    </tr>
    <tr>
      <th>263</th>
      <td>1461700</td>
      <td>pop &amp; rock</td>
      <td>Teoman</td>
      <td>67</td>
      <td>Gecenin Sonuna Yolculuk</td>
      <td>52</td>
      <td>280600</td>
      <td>0</td>
      <td>2021</td>
      <td>0.686</td>
      <td>...</td>
      <td>11</td>
      <td>-7.457</td>
      <td>0</td>
      <td>0.0268</td>
      <td>0.119000</td>
      <td>0.000386</td>
      <td>0.1080</td>
      <td>0.560</td>
      <td>100.932</td>
      <td>4</td>
    </tr>
    <tr>
      <th>293</th>
      <td>299746</td>
      <td>pop &amp; rock</td>
      <td>Lars Winnerbäck</td>
      <td>62</td>
      <td>Själ och hjärta</td>
      <td>55</td>
      <td>271675</td>
      <td>0</td>
      <td>2021</td>
      <td>0.492</td>
      <td>...</td>
      <td>2</td>
      <td>-6.005</td>
      <td>0</td>
      <td>0.0349</td>
      <td>0.000735</td>
      <td>0.000207</td>
      <td>0.0953</td>
      <td>0.603</td>
      <td>142.042</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<p><strong>Subsetting columns:</strong> Suppose we wish to analyze only <em>track_name, release year</em> and <em>track_popularity</em> of songs. Then, we can subset the revelant columns:</p>
<div class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>relevant_columns <span class="op">=</span> spotify_data.loc[:,[<span class="st">'track_name'</span>,<span class="st">'release_year'</span>,<span class="st">'track_popularity'</span>]]</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>relevant_columns.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>track_name</th>
      <th>release_year</th>
      <th>track_popularity</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>All Girls Are The Same</td>
      <td>2021</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lucid Dreams</td>
      <td>2021</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hear Me Calling</td>
      <td>2021</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robbery</td>
      <td>2021</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Big Stepper</td>
      <td>2021</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that one multiple columns are subset with <code>loc</code> they are enclosed in a box bracket, unlike the case with a single column. Similarly if multiple observations are selected using the row labels, the row labels must be enclosed in box brackets.</p>
</section>
<section id="re-indexing-rows-followed-by-loc-iloc" class="level4" data-number="5.5.1.2">
<h4 data-number="5.5.1.2" class="anchored" data-anchor-id="re-indexing-rows-followed-by-loc-iloc"><span class="header-section-number">5.5.1.2</span> Re-indexing rows followed by <code>loc</code> / <code>iloc</code></h4>
<p>Suppose we wish to subset data based on the <code>genres</code>. If we want to subset <em>hiphop</em> songs, we may subset as:</p>
<div class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting hiphop songs</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>hiphop_songs <span class="op">=</span> spotify_data.loc[spotify_data[<span class="st">'genres'</span>]<span class="op">==</span><span class="st">'hip hop'</span>,:]</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>hiphop_songs.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>6485079</td>
      <td>hip hop</td>
      <td>DaBaby</td>
      <td>93</td>
      <td>FIND MY WAY</td>
      <td>0</td>
      <td>139890</td>
      <td>1</td>
      <td>2021</td>
      <td>0.836</td>
      <td>...</td>
      <td>4</td>
      <td>-6.750</td>
      <td>0</td>
      <td>0.1840</td>
      <td>0.1870</td>
      <td>0.00000</td>
      <td>0.1380</td>
      <td>0.7000</td>
      <td>103.000</td>
      <td>4</td>
    </tr>
    <tr>
      <th>80</th>
      <td>22831280</td>
      <td>hip hop</td>
      <td>Daddy Yankee</td>
      <td>91</td>
      <td>Hula Hoop</td>
      <td>0</td>
      <td>236493</td>
      <td>0</td>
      <td>2021</td>
      <td>0.799</td>
      <td>...</td>
      <td>6</td>
      <td>-4.628</td>
      <td>1</td>
      <td>0.0801</td>
      <td>0.1130</td>
      <td>0.00315</td>
      <td>0.0942</td>
      <td>0.9510</td>
      <td>175.998</td>
      <td>4</td>
    </tr>
    <tr>
      <th>81</th>
      <td>22831280</td>
      <td>hip hop</td>
      <td>Daddy Yankee</td>
      <td>91</td>
      <td>Gasolina - Live</td>
      <td>0</td>
      <td>306720</td>
      <td>0</td>
      <td>2021</td>
      <td>0.669</td>
      <td>...</td>
      <td>1</td>
      <td>-4.251</td>
      <td>1</td>
      <td>0.2700</td>
      <td>0.1530</td>
      <td>0.00000</td>
      <td>0.1540</td>
      <td>0.0814</td>
      <td>96.007</td>
      <td>4</td>
    </tr>
    <tr>
      <th>87</th>
      <td>22831280</td>
      <td>hip hop</td>
      <td>Daddy Yankee</td>
      <td>91</td>
      <td>La Nueva Y La Ex</td>
      <td>0</td>
      <td>197053</td>
      <td>0</td>
      <td>2021</td>
      <td>0.639</td>
      <td>...</td>
      <td>5</td>
      <td>-3.542</td>
      <td>1</td>
      <td>0.1360</td>
      <td>0.0462</td>
      <td>0.00000</td>
      <td>0.1410</td>
      <td>0.6390</td>
      <td>198.051</td>
      <td>4</td>
    </tr>
    <tr>
      <th>88</th>
      <td>22831280</td>
      <td>hip hop</td>
      <td>Daddy Yankee</td>
      <td>91</td>
      <td>Que Tire Pa Lante</td>
      <td>0</td>
      <td>210520</td>
      <td>0</td>
      <td>2021</td>
      <td>0.659</td>
      <td>...</td>
      <td>7</td>
      <td>-2.814</td>
      <td>1</td>
      <td>0.0358</td>
      <td>0.0478</td>
      <td>0.00000</td>
      <td>0.1480</td>
      <td>0.7040</td>
      <td>93.979</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<p>However, if we need to subset data by <code>genres</code> frequently in our analysis, and we don’t need the current row labels, we may replace the row labels as <code>genres</code> to shorten the code for filtering the observations based on <code>genres</code>.</p>
<p>We use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.set_index.html">set_index()</a> function to re-index the rows based on existing column(s) of the DataFrame.</p>
<div class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining row labels as the values of the column `genres`</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>spotify_data_reindexed <span class="op">=</span> spotify_data.set_index(keys<span class="op">=</span>spotify_data[<span class="st">'genres'</span>])</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>spotify_data_reindexed.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
    <tr>
      <th>genres</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>rap</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>All Girls Are The Same</td>
      <td>0</td>
      <td>165820</td>
      <td>1</td>
      <td>2021</td>
      <td>0.673</td>
      <td>...</td>
      <td>0</td>
      <td>-7.226</td>
      <td>1</td>
      <td>0.3060</td>
      <td>0.0769</td>
      <td>0.000338</td>
      <td>0.0856</td>
      <td>0.203</td>
      <td>161.991</td>
      <td>4</td>
    </tr>
    <tr>
      <th>rap</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Lucid Dreams</td>
      <td>0</td>
      <td>239836</td>
      <td>1</td>
      <td>2021</td>
      <td>0.511</td>
      <td>...</td>
      <td>6</td>
      <td>-7.230</td>
      <td>0</td>
      <td>0.2000</td>
      <td>0.3490</td>
      <td>0.000000</td>
      <td>0.3400</td>
      <td>0.218</td>
      <td>83.903</td>
      <td>4</td>
    </tr>
    <tr>
      <th>rap</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Hear Me Calling</td>
      <td>0</td>
      <td>189977</td>
      <td>1</td>
      <td>2021</td>
      <td>0.699</td>
      <td>...</td>
      <td>7</td>
      <td>-3.997</td>
      <td>0</td>
      <td>0.1060</td>
      <td>0.3080</td>
      <td>0.000036</td>
      <td>0.1210</td>
      <td>0.499</td>
      <td>88.933</td>
      <td>4</td>
    </tr>
    <tr>
      <th>rap</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Robbery</td>
      <td>0</td>
      <td>240527</td>
      <td>1</td>
      <td>2021</td>
      <td>0.708</td>
      <td>...</td>
      <td>2</td>
      <td>-5.181</td>
      <td>1</td>
      <td>0.0442</td>
      <td>0.3480</td>
      <td>0.000000</td>
      <td>0.2220</td>
      <td>0.543</td>
      <td>79.993</td>
      <td>4</td>
    </tr>
    <tr>
      <th>rap</th>
      <td>5988689</td>
      <td>rap</td>
      <td>Roddy Ricch</td>
      <td>88</td>
      <td>Big Stepper</td>
      <td>0</td>
      <td>175170</td>
      <td>0</td>
      <td>2021</td>
      <td>0.753</td>
      <td>...</td>
      <td>8</td>
      <td>-8.469</td>
      <td>1</td>
      <td>0.2920</td>
      <td>0.0477</td>
      <td>0.000000</td>
      <td>0.1970</td>
      <td>0.616</td>
      <td>76.997</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<p>Now, we can subset <em>hiphop</em> songs using the row label of the data:</p>
<div class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting hiphop songs using row labels</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>hiphop_songs <span class="op">=</span> spotify_data_reindexed.loc[<span class="st">'hip hop'</span>,:]</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>hiphop_songs.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
    <tr>
      <th>genres</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>hip hop</th>
      <td>6485079</td>
      <td>hip hop</td>
      <td>DaBaby</td>
      <td>93</td>
      <td>FIND MY WAY</td>
      <td>0</td>
      <td>139890</td>
      <td>1</td>
      <td>2021</td>
      <td>0.836</td>
      <td>...</td>
      <td>4</td>
      <td>-6.750</td>
      <td>0</td>
      <td>0.1840</td>
      <td>0.1870</td>
      <td>0.00000</td>
      <td>0.1380</td>
      <td>0.7000</td>
      <td>103.000</td>
      <td>4</td>
    </tr>
    <tr>
      <th>hip hop</th>
      <td>22831280</td>
      <td>hip hop</td>
      <td>Daddy Yankee</td>
      <td>91</td>
      <td>Hula Hoop</td>
      <td>0</td>
      <td>236493</td>
      <td>0</td>
      <td>2021</td>
      <td>0.799</td>
      <td>...</td>
      <td>6</td>
      <td>-4.628</td>
      <td>1</td>
      <td>0.0801</td>
      <td>0.1130</td>
      <td>0.00315</td>
      <td>0.0942</td>
      <td>0.9510</td>
      <td>175.998</td>
      <td>4</td>
    </tr>
    <tr>
      <th>hip hop</th>
      <td>22831280</td>
      <td>hip hop</td>
      <td>Daddy Yankee</td>
      <td>91</td>
      <td>Gasolina - Live</td>
      <td>0</td>
      <td>306720</td>
      <td>0</td>
      <td>2021</td>
      <td>0.669</td>
      <td>...</td>
      <td>1</td>
      <td>-4.251</td>
      <td>1</td>
      <td>0.2700</td>
      <td>0.1530</td>
      <td>0.00000</td>
      <td>0.1540</td>
      <td>0.0814</td>
      <td>96.007</td>
      <td>4</td>
    </tr>
    <tr>
      <th>hip hop</th>
      <td>22831280</td>
      <td>hip hop</td>
      <td>Daddy Yankee</td>
      <td>91</td>
      <td>La Nueva Y La Ex</td>
      <td>0</td>
      <td>197053</td>
      <td>0</td>
      <td>2021</td>
      <td>0.639</td>
      <td>...</td>
      <td>5</td>
      <td>-3.542</td>
      <td>1</td>
      <td>0.1360</td>
      <td>0.0462</td>
      <td>0.00000</td>
      <td>0.1410</td>
      <td>0.6390</td>
      <td>198.051</td>
      <td>4</td>
    </tr>
    <tr>
      <th>hip hop</th>
      <td>22831280</td>
      <td>hip hop</td>
      <td>Daddy Yankee</td>
      <td>91</td>
      <td>Que Tire Pa Lante</td>
      <td>0</td>
      <td>210520</td>
      <td>0</td>
      <td>2021</td>
      <td>0.659</td>
      <td>...</td>
      <td>7</td>
      <td>-2.814</td>
      <td>1</td>
      <td>0.0358</td>
      <td>0.0478</td>
      <td>0.00000</td>
      <td>0.1480</td>
      <td>0.7040</td>
      <td>93.979</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="sorting-data" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="sorting-data"><span class="header-section-number">5.5.2</span> Sorting data</h3>
<p>Sorting dataset is a very common operation. The <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html">sort_values()</a> function of Pandas can be used to sort a Pandas DataFrame or Series. Let us sort the spotify data in decreasing order of <em>track_popularity</em>:</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>spotify_sorted <span class="op">=</span> spotify_data.sort_values(by <span class="op">=</span> <span class="st">'track_popularity'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>spotify_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>modality</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2398</th>
      <td>1444702</td>
      <td>pop</td>
      <td>Olivia Rodrigo</td>
      <td>88</td>
      <td>drivers license</td>
      <td>99</td>
      <td>242014</td>
      <td>1</td>
      <td>2021</td>
      <td>0.585</td>
      <td>...</td>
      <td>-8.761</td>
      <td>1</td>
      <td>0.0601</td>
      <td>0.72100</td>
      <td>0.000013</td>
      <td>0.1050</td>
      <td>0.132</td>
      <td>143.874</td>
      <td>4</td>
      <td>major</td>
    </tr>
    <tr>
      <th>2442</th>
      <td>177401</td>
      <td>hip hop</td>
      <td>Masked Wolf</td>
      <td>85</td>
      <td>Astronaut In The Ocean</td>
      <td>98</td>
      <td>132780</td>
      <td>0</td>
      <td>2021</td>
      <td>0.778</td>
      <td>...</td>
      <td>-6.865</td>
      <td>0</td>
      <td>0.0913</td>
      <td>0.17500</td>
      <td>0.000000</td>
      <td>0.1500</td>
      <td>0.472</td>
      <td>149.996</td>
      <td>4</td>
      <td>minor</td>
    </tr>
    <tr>
      <th>3133</th>
      <td>1698014</td>
      <td>pop</td>
      <td>Kali Uchis</td>
      <td>88</td>
      <td>telepatía</td>
      <td>97</td>
      <td>160191</td>
      <td>0</td>
      <td>2020</td>
      <td>0.653</td>
      <td>...</td>
      <td>-9.016</td>
      <td>0</td>
      <td>0.0502</td>
      <td>0.11200</td>
      <td>0.000000</td>
      <td>0.2030</td>
      <td>0.553</td>
      <td>83.970</td>
      <td>4</td>
      <td>minor</td>
    </tr>
    <tr>
      <th>6702</th>
      <td>31308207</td>
      <td>pop</td>
      <td>The Weeknd</td>
      <td>96</td>
      <td>Save Your Tears</td>
      <td>97</td>
      <td>215627</td>
      <td>1</td>
      <td>2020</td>
      <td>0.680</td>
      <td>...</td>
      <td>-5.487</td>
      <td>1</td>
      <td>0.0309</td>
      <td>0.02120</td>
      <td>0.000012</td>
      <td>0.5430</td>
      <td>0.644</td>
      <td>118.051</td>
      <td>4</td>
      <td>major</td>
    </tr>
    <tr>
      <th>6703</th>
      <td>31308207</td>
      <td>pop</td>
      <td>The Weeknd</td>
      <td>96</td>
      <td>Blinding Lights</td>
      <td>96</td>
      <td>200040</td>
      <td>0</td>
      <td>2020</td>
      <td>0.514</td>
      <td>...</td>
      <td>-5.934</td>
      <td>1</td>
      <td>0.0598</td>
      <td>0.00146</td>
      <td>0.000095</td>
      <td>0.0897</td>
      <td>0.334</td>
      <td>171.005</td>
      <td>4</td>
      <td>major</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>
</div>
</div>
<p>Drivers license is the most popular song!</p>
<div class="cell" data-execution_count="148">
<div class="cell-output cell-output-stdout">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-display">
<div id="IIttxITiVYyQ" data-shufflequestions="False" data-shuffleanswers="True" data-preserveresponses="false" data-numquestions="1000000"> <style>:root {
    --medium-slate-blue: #6f78ffff;
    --orange-pantone: #f75c03ff;
    --russian-violet: #392061ff;
    --maximum-yellow-red: #ffc857ff;
    --viridian-green: #119da4ff;
    --incorrect-red: #c80202;
    --correct-green: #009113;
}

.Quiz {
    max-width: 600px;
    margin-top: 15px;
    margin-left: auto;
    margin-right: auto;
    margin-bottom: 15px;
    padding-bottom: 4px;
    padding-top: 4px;
    line-height: 1.1;
    font-size: 16pt;
}

.QuizCode {
    font-size: 14pt;
    margin-top: 10px;
    margin-left: 20px;
    margin-right: 20px;
}

.QuizCode>pre {
    padding: 4px;
}

.Answer {
    margin: 10px 0;
    display: grid;
    grid-template-columns: auto auto;
    grid-gap: 10px;
}

.Feedback {
    font-size: 16pt;
    text-align: center;
    min-height: 2em;
}

.Input {
    align: left;
    font-size: 20pt;
}

.Input-text {
    display: block;
    margin: 10px;
    color: inherit;
    width: 140px;
    background-color: #c0c0c0;
    color: #fff;
    padding: 5px;
    padding-left: 10px;
    font-family: inherit;
    font-size: 20px;
    font-weight: inherit;
    line-height: 20pt;
    border: none;
    border-radius: 0.2rem;
    transition: box-shadow 0.1s);
}

.Input-text:focus {
    outline: none;
    background-color: #c0c0c0;
    box-shadow: 0.6rem 0.8rem 1.4rem -0.5rem #999999;
}

.MCButton {
    background: #fafafa;
    border: 1px solid #eee;
    border-radius: 10px;
    padding: 10px;
    font-size: 16px;
    cursor: pointer;
    text-align: center;
}

.MCButton p {
    color: inherit;
}

.MultipleChoiceQn {
    padding: 10px;
    background: var(--medium-slate-blue);
    color: #fafafa;
    border-radius: 10px;
}

.ManyChoiceQn {
    padding: 10px;
    background: var(--orange-pantone);
    color: #fafafa;
    border-radius: 10px;
}

.NumericQn {
    padding: 10px;
    background: var(--russian-violet);
    color: #fafafa;
    border-radius: 10px;
}

.NumericQn p {
    color: inherit;
}

.InpLabel {
    line-height: 34px;
    float: left;
    margin-right: 10px;
    color: #101010;
    font-size: 15pt;
}

.incorrect {
    color: var(--incorrect-red);
}

.correct {
    color: var(--correct-green);
}

.correctButton {
    /*
    background: var(--correct-green);
   */
    animation: correct-anim 0.6s ease;
    animation-fill-mode: forwards;
    color: #fafafa;
    box-shadow: inset 0px 0px 5px #555555;
    outline: none;
}

.incorrectButton {
    animation: incorrect-anim 0.8s ease;
    animation-fill-mode: forwards;
    color: #fafafa;
    box-shadow: inset 0px 0px 5px #555555;
    outline: none;
}

@keyframes incorrect-anim {
    100% {
        background-color: var(--incorrect-red);
    }
}

@keyframes correct-anim {
    100% {
        background-color: var(--correct-green);
    }
}</style><script type="text/Javascript">var questionsIIttxITiVYyQ=[{"question": "Which is the most popular latin song, i.e., the song with the highest 'track_popularity' in the 'latin' genre?", "type": "multiple_choice", "answers": [{"answer": "Agua de Jamaica", "correct": false, "feedback": "Incorrect!"}, {"answer": "Solo Se Quiere Una Vez", "correct": false, "feedback": "Incorrect!"}, {"answer": "Tarde Gris", "correct": false, "feedback": "Incorrect!"}, {"answer": "Hawai", "correct": true, "feedback": "Correct!"}]}];
    // Make a random ID
function makeid(length) {
    var result = [];
    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
    var charactersLength = characters.length;
    for (var i = 0; i < length; i++) {
        result.push(characters.charAt(Math.floor(Math.random() * charactersLength)));
    }
    return result.join('');
}

// Choose a random subset of an array. Can also be used to shuffle the array
function getRandomSubarray(arr, size) {
    var shuffled = arr.slice(0), i = arr.length, temp, index;
    while (i--) {
        index = Math.floor((i + 1) * Math.random());
        temp = shuffled[index];
        shuffled[index] = shuffled[i];
        shuffled[i] = temp;
    }
    return shuffled.slice(0, size);
}

function printResponses(responsesContainer) {
    var responses=JSON.parse(responsesContainer.dataset.responses);
    var stringResponses='<B>IMPORTANT!</B>To preserve this answer sequence for submission, when you have finalized your answers: <ol> <li> Copy the text in this cell below "Answer String"</li> <li> Double click on the cell directly below the Answer String, labeled "Replace Me"</li> <li> Select the whole "Replace Me" text</li> <li> Paste in your answer string and press shift-Enter.</li><li>Save the notebook using the save icon or File->Save Notebook menu item</li></ul><br><br><br><b>Answer String:</b><br> ';
    console.log(responses);
    responses.forEach((response, index) => {
        if (response) {
            console.log(index + ': ' + response);
            stringResponses+= index + ': ' + response +"<BR>";
        }
    });
    responsesContainer.innerHTML=stringResponses;
}
function check_mc() {
    var id = this.id.split('-')[0];
    //var response = this.id.split('-')[1];
    //console.log(response);
    //console.log("In check_mc(), id="+id);
    //console.log(event.srcElement.id)           
    //console.log(event.srcElement.dataset.correct)   
    //console.log(event.srcElement.dataset.feedback)

    var label = event.srcElement;
    //console.log(label, label.nodeName);
    var depth = 0;
    while ((label.nodeName != "LABEL") && (depth < 20)) {
        label = label.parentElement;
        console.log(depth, label);
        depth++;
    }



    var answers = label.parentElement.children;

    //console.log(answers);


    // Split behavior based on multiple choice vs many choice:
    var fb = document.getElementById("fb" + id);




    if (fb.dataset.numcorrect == 1) {
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            responses[qnum]= response;
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses
        
        for (var i = 0; i < answers.length; i++) {
            var child = answers[i];
            //console.log(child);
            child.className = "MCButton";
        }



        if (label.dataset.correct == "true") {
            // console.log("Correct action");
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Correct!";
            }
            label.classList.add("correctButton");

            fb.className = "Feedback";
            fb.classList.add("correct");

        } else {
            if ("feedback" in label.dataset) {
                fb.textContent = jaxify(label.dataset.feedback);
            } else {
                fb.textContent = "Incorrect -- try again.";
            }
            //console.log("Error action");
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
    }
    else {
        var reset = false;
        var feedback;
         if (label.dataset.correct == "true") {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Correct!";
            }
            if (label.dataset.answered <= 0) {
                if (fb.dataset.answeredcorrect < 0) {
                    fb.dataset.answeredcorrect = 1;
                    reset = true;
                } else {
                    fb.dataset.answeredcorrect++;
                }
                if (reset) {
                    for (var i = 0; i < answers.length; i++) {
                        var child = answers[i];
                        child.className = "MCButton";
                        child.dataset.answered = 0;
                    }
                }
                label.classList.add("correctButton");
                label.dataset.answered = 1;
                fb.className = "Feedback";
                fb.classList.add("correct");

            }
        } else {
            if ("feedback" in label.dataset) {
                feedback = jaxify(label.dataset.feedback);
            } else {
                feedback = "Incorrect -- try again.";
            }
            if (fb.dataset.answeredcorrect > 0) {
                fb.dataset.answeredcorrect = -1;
                reset = true;
            } else {
                fb.dataset.answeredcorrect--;
            }

            if (reset) {
                for (var i = 0; i < answers.length; i++) {
                    var child = answers[i];
                    child.className = "MCButton";
                    child.dataset.answered = 0;
                }
            }
            label.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }
        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            //console.log(responsesContainer);
            var response = label.firstChild.innerText;
            if (label.querySelector(".QuizCode")){
                response+= label.querySelector(".QuizCode").firstChild.innerText;
            }
            console.log(response);
            //console.log(document.getElementById("quizWrap"+id));
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            if (label.dataset.correct == "true") {
                if (typeof(responses[qnum]) == "object"){
                    if (!responses[qnum].includes(response))
                        responses[qnum].push(response);
                } else{
                    responses[qnum]= [ response ];
                }
            } else {
                responses[qnum]= response;
            }
            console.log(responses);
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End save responses stuff



        var numcorrect = fb.dataset.numcorrect;
        var answeredcorrect = fb.dataset.answeredcorrect;
        if (answeredcorrect >= 0) {
            fb.textContent = feedback + " [" + answeredcorrect + "/" + numcorrect + "]";
        } else {
            fb.textContent = feedback + " [" + 0 + "/" + numcorrect + "]";
        }


    }

    if (typeof MathJax != 'undefined') {
        var version = MathJax.version;
        console.log('MathJax version', version);
        if (version[0] == "2") {
            MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
        } else if (version[0] == "3") {
            MathJax.typeset([fb]);
        }
    } else {
        console.log('MathJax not detected');
    }

}

function make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id) {
    var shuffled;
    if (shuffle_answers == "True") {
        //console.log(shuffle_answers+" read as true");
        shuffled = getRandomSubarray(qa.answers, qa.answers.length);
    } else {
        //console.log(shuffle_answers+" read as false");
        shuffled = qa.answers;
    }


    var num_correct = 0;



    shuffled.forEach((item, index, ans_array) => {
        //console.log(answer);

        // Make input element
        var inp = document.createElement("input");
        inp.type = "radio";
        inp.id = "quizo" + id + index;
        inp.style = "display:none;";
        aDiv.append(inp);

        //Make label for input element
        var lab = document.createElement("label");
        lab.className = "MCButton";
        lab.id = id + '-' + index;
        lab.onclick = check_mc;
        var aSpan = document.createElement('span');
        aSpan.classsName = "";
        //qDiv.id="quizQn"+id+index;
        if ("answer" in item) {
            aSpan.innerHTML = jaxify(item.answer);
            //aSpan.innerHTML=item.answer;
        }
        lab.append(aSpan);

        // Create div for code inside question
        var codeSpan;
        if ("code" in item) {
            codeSpan = document.createElement('span');
            codeSpan.id = "code" + id + index;
            codeSpan.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeSpan.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = item.code;
            lab.append(codeSpan);
            //console.log(codeSpan);
        }

        //lab.textContent=item.answer;

        // Set the data attributes for the answer
        lab.setAttribute('data-correct', item.correct);
        if (item.correct) {
            num_correct++;
        }
        if ("feedback" in item) {
            lab.setAttribute('data-feedback', item.feedback);
        }
        lab.setAttribute('data-answered', 0);

        aDiv.append(lab);

    });

    if (num_correct > 1) {
        outerqDiv.className = "ManyChoiceQn";
    } else {
        outerqDiv.className = "MultipleChoiceQn";
    }

    return num_correct;

}
function check_numeric(ths, event) {

    if (event.keyCode === 13) {
        ths.blur();

        var id = ths.id.split('-')[0];

        var submission = ths.value;
        if (submission.indexOf('/') != -1) {
            sub_parts = submission.split('/');
            //console.log(sub_parts);
            submission = sub_parts[0] / sub_parts[1];
        }
        //console.log("Reader entered", submission);

        if ("precision" in ths.dataset) {
            precision = ths.dataset.precision;
            // console.log("1:", submission)
            submission = Math.round((1 * submission + Number.EPSILON) * 10 ** precision) / 10 ** precision;
            // console.log("Rounded to ", submission, " precision=", precision  );
        }


        //console.log("In check_numeric(), id="+id);
        //console.log(event.srcElement.id)           
        //console.log(event.srcElement.dataset.feedback)

        var fb = document.getElementById("fb" + id);
        fb.style.display = "none";
        fb.textContent = "Incorrect -- try again.";

        answers = JSON.parse(ths.dataset.answers);
        //console.log(answers);

        var defaultFB = "";
        var correct;
        var done = false;
        answers.every(answer => {
            //console.log(answer.type);

            correct = false;
            // if (answer.type=="value"){
            if ('value' in answer) {
                if (submission == answer.value) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
                // } else if (answer.type=="range") {
            } else if ('range' in answer) {
                //console.log(answer.range);
                if ((submission >= answer.range[0]) && (submission < answer.range[1])) {
                    fb.textContent = jaxify(answer.feedback);
                    correct = answer.correct;
                    //console.log(answer.correct);
                    done = true;
                }
            } else if (answer.type == "default") {
                defaultFB = answer.feedback;
            }
            if (done) {
                return false; // Break out of loop if this has been marked correct
            } else {
                return true; // Keep looking for case that includes this as a correct answer
            }
        });

        if ((!done) && (defaultFB != "")) {
            fb.innerHTML = jaxify(defaultFB);
            //console.log("Default feedback", defaultFB);
        }

        fb.style.display = "block";
        if (correct) {
            ths.className = "Input-text";
            ths.classList.add("correctButton");
            fb.className = "Feedback";
            fb.classList.add("correct");
        } else {
            ths.className = "Input-text";
            ths.classList.add("incorrectButton");
            fb.className = "Feedback";
            fb.classList.add("incorrect");
        }

        // What follows is for the saved responses stuff
        var outerContainer = fb.parentElement.parentElement;
        var responsesContainer = document.getElementById("responses" + outerContainer.id);
        if (responsesContainer) {
            console.log(submission);
            var qnum = document.getElementById("quizWrap"+id).dataset.qnum;
            //console.log("Question " + qnum);
            //console.log(id, ", got numcorrect=",fb.dataset.numcorrect);
            var responses=JSON.parse(responsesContainer.dataset.responses);
            console.log(responses);
            if (submission == ths.value){
                responses[qnum]= submission;
            } else {
                responses[qnum]= ths.value + "(" + submission +")";
            }
            responsesContainer.setAttribute('data-responses', JSON.stringify(responses));
            printResponses(responsesContainer);
        }
        // End code to preserve responses

        if (typeof MathJax != 'undefined') {
            var version = MathJax.version;
            console.log('MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([fb]);
            }
        } else {
            console.log('MathJax not detected');
        }
        return false;
    }

}

function isValid(el, charC) {
    //console.log("Input char: ", charC);
    if (charC == 46) {
        if (el.value.indexOf('.') === -1) {
            return true;
        } else if (el.value.indexOf('/') != -1) {
            parts = el.value.split('/');
            if (parts[1].indexOf('.') === -1) {
                return true;
            }
        }
        else {
            return false;
        }
    } else if (charC == 47) {
        if (el.value.indexOf('/') === -1) {
            if ((el.value != "") && (el.value != ".")) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else if (charC == 45) {
        edex = el.value.indexOf('e');
        if (edex == -1) {
            edex = el.value.indexOf('E');
        }

        if (el.value == "") {
            return true;
        } else if (edex == (el.value.length - 1)) { // If just after e or E
            return true;
        } else {
            return false;
        }
    } else if (charC == 101) { // "e"
        if ((el.value.indexOf('e') === -1) && (el.value.indexOf('E') === -1) && (el.value.indexOf('/') == -1)) {
            // Prev symbol must be digit or decimal point:
            if (el.value.slice(-1).search(/\d/) >= 0) {
                return true;
            } else if (el.value.slice(-1).search(/\./) >= 0) {
                return true;
            } else {
                return false;
            }
        } else {
            return false;
        }
    } else {
        if (charC > 31 && (charC < 48 || charC > 57))
            return false;
    }
    return true;
}

function numeric_keypress(evnt) {
    var charC = (evnt.which) ? evnt.which : evnt.keyCode;

    if (charC == 13) {
        check_numeric(this, evnt);
    } else {
        return isValid(this, charC);
    }
}





function make_numeric(qa, outerqDiv, qDiv, aDiv, id) {



    //console.log(answer);


    outerqDiv.className = "NumericQn";
    aDiv.style.display = 'block';

    var lab = document.createElement("label");
    lab.className = "InpLabel";
    lab.textContent = "Type numeric answer here:";
    aDiv.append(lab);

    var inp = document.createElement("input");
    inp.type = "text";
    //inp.id="input-"+id;
    inp.id = id + "-0";
    inp.className = "Input-text";
    inp.setAttribute('data-answers', JSON.stringify(qa.answers));
    if ("precision" in qa) {
        inp.setAttribute('data-precision', qa.precision);
    }
    aDiv.append(inp);
    //console.log(inp);

    //inp.addEventListener("keypress", check_numeric);
    //inp.addEventListener("keypress", numeric_keypress);
    /*
    inp.addEventListener("keypress", function(event) {
        return numeric_keypress(this, event);
    }
                        );
                        */
    //inp.onkeypress="return numeric_keypress(this, event)";
    inp.onkeypress = numeric_keypress;
    inp.onpaste = event => false;

    inp.addEventListener("focus", function (event) {
        this.value = "";
        return false;
    }
    );


}
function jaxify(string) {
    var mystring = string;

    count = 0;
    var loc = mystring.search(/([^\\]|^)(\$)/);

    count2 = 0;
    var loc2 = mystring.search(/([^\\]|^)(\$\$)/);

    //console.log(loc);

    while ((loc >= 0) || (loc2 >= 0)) {

        /* Have to replace all the double $$ first with current implementation */
        if (loc2 >= 0) {
            if (count2 % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\[");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$\$)/, "$1\\]");
            }
            count2++;
        } else {
            if (count % 2 == 0) {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\(");
            } else {
                mystring = mystring.replace(/([^\\]|^)(\$)/, "$1\\)");
            }
            count++;
        }
        loc = mystring.search(/([^\\]|^)(\$)/);
        loc2 = mystring.search(/([^\\]|^)(\$\$)/);
        //console.log(mystring,", loc:",loc,", loc2:",loc2);
    }

    //console.log(mystring);
    return mystring;
}


function show_questions(json, mydiv) {
    console.log('show_questions');
    //var mydiv=document.getElementById(myid);
    var shuffle_questions = mydiv.dataset.shufflequestions;
    var num_questions = mydiv.dataset.numquestions;
    var shuffle_answers = mydiv.dataset.shuffleanswers;

    if (num_questions > json.length) {
        num_questions = json.length;
    }

    var questions;
    if ((num_questions < json.length) || (shuffle_questions == "True")) {
        //console.log(num_questions+","+json.length);
        questions = getRandomSubarray(json, num_questions);
    } else {
        questions = json;
    }

    //console.log("SQ: "+shuffle_questions+", NQ: " + num_questions + ", SA: ", shuffle_answers);

    // Iterate over questions
    questions.forEach((qa, index, array) => {
        //console.log(qa.question); 

        var id = makeid(8);
        //console.log(id);


        // Create Div to contain question and answers
        var iDiv = document.createElement('div');
        //iDiv.id = 'quizWrap' + id + index;
        iDiv.id = 'quizWrap' + id;
        iDiv.className = 'Quiz';
        iDiv.setAttribute('data-qnum', index);
        mydiv.appendChild(iDiv);
        // iDiv.innerHTML=qa.question;

        var outerqDiv = document.createElement('div');
        outerqDiv.id = "OuterquizQn" + id + index;

        iDiv.append(outerqDiv);

        // Create div to contain question part
        var qDiv = document.createElement('div');
        qDiv.id = "quizQn" + id + index;
        //qDiv.textContent=qa.question;
        qDiv.innerHTML = jaxify(qa.question);

        outerqDiv.append(qDiv);

        // Create div for code inside question
        var codeDiv;
        if ("code" in qa) {
            codeDiv = document.createElement('div');
            codeDiv.id = "code" + id + index;
            codeDiv.className = "QuizCode";
            var codePre = document.createElement('pre');
            codeDiv.append(codePre);
            var codeCode = document.createElement('code');
            codePre.append(codeCode);
            codeCode.innerHTML = qa.code;
            outerqDiv.append(codeDiv);
            //console.log(codeDiv);
        }


        // Create div to contain answer part
        var aDiv = document.createElement('div');
        aDiv.id = "quizAns" + id + index;
        aDiv.className = 'Answer';
        iDiv.append(aDiv);

        //console.log(qa.type);

        var num_correct;
        if (qa.type == "multiple_choice") {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
        } else if (qa.type == "many_choice") {
            num_correct = make_mc(qa, shuffle_answers, outerqDiv, qDiv, aDiv, id);
        } else if (qa.type == "numeric") {
            //console.log("numeric");
            make_numeric(qa, outerqDiv, qDiv, aDiv, id);
        }


        //Make div for feedback
        var fb = document.createElement("div");
        fb.id = "fb" + id;
        //fb.style="font-size: 20px;text-align:center;";
        fb.className = "Feedback";
        fb.setAttribute("data-answeredcorrect", 0);
        fb.setAttribute("data-numcorrect", num_correct);
        iDiv.append(fb);


    });
    var preserveResponses = mydiv.dataset.preserveresponses;
    console.log(preserveResponses);
    console.log(preserveResponses == "true");
    if (preserveResponses == "true") {
        console.log(preserveResponses);
        // Create Div to contain record of answers
        var iDiv = document.createElement('div');
        iDiv.id = 'responses' + mydiv.id;
        iDiv.className = 'JCResponses';
        // Create a place to store responses as an empty array
        iDiv.setAttribute('data-responses', '[]');

        // Dummy Text
        iDiv.innerHTML="<b>Select your answers and then follow the directions that will appear here.</b>"
        //iDiv.className = 'Quiz';
        mydiv.appendChild(iDiv);
    }
//console.log("At end of show_questions");
    if (typeof MathJax != 'undefined') {
        console.log("MathJax version", MathJax.version);
        var version = MathJax.version;
        setTimeout(function(){
            var version = MathJax.version;
            console.log('After sleep, MathJax version', version);
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            }
        }, 500);
if (typeof version == 'undefined') {
        } else
        {
            if (version[0] == "2") {
                MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
            } else if (version[0] == "3") {
                MathJax.typeset([mydiv]);
            } else {
                console.log("MathJax not found");
            }
        }
    }
    return false;
}

        {
        show_questions(questionsIIttxITiVYyQ,  IIttxITiVYyQ);
        }
        </script>
        
</div>
</div>
</div></section>
<section id="ranking-data" class="level3" data-number="5.5.3">
<h3 data-number="5.5.3" class="anchored" data-anchor-id="ranking-data"><span class="header-section-number">5.5.3</span> Ranking data</h3>
<p>With the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rank.html">rank()</a> function, we can rank the observations.</p>
<p>For example, let us add a new column to the spotify data that provides the rank of the <code>track_poularity</code> column:</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>spotify_ranked <span class="op">=</span> spotify_data.copy()</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>spotify_ranked[<span class="st">'track_poularity_rank'</span>]<span class="op">=</span>spotify_sorted[<span class="st">'track_popularity'</span>].rank()</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>spotify_ranked.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
      <th>modality</th>
      <th>track_poularity_rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>All Girls Are The Same</td>
      <td>0</td>
      <td>165820</td>
      <td>1</td>
      <td>2021</td>
      <td>0.673</td>
      <td>...</td>
      <td>1</td>
      <td>0.3060</td>
      <td>0.0769</td>
      <td>0.000338</td>
      <td>0.0856</td>
      <td>0.203</td>
      <td>161.991</td>
      <td>4</td>
      <td>major</td>
      <td>963.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Lucid Dreams</td>
      <td>0</td>
      <td>239836</td>
      <td>1</td>
      <td>2021</td>
      <td>0.511</td>
      <td>...</td>
      <td>0</td>
      <td>0.2000</td>
      <td>0.3490</td>
      <td>0.000000</td>
      <td>0.3400</td>
      <td>0.218</td>
      <td>83.903</td>
      <td>4</td>
      <td>minor</td>
      <td>963.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Hear Me Calling</td>
      <td>0</td>
      <td>189977</td>
      <td>1</td>
      <td>2021</td>
      <td>0.699</td>
      <td>...</td>
      <td>0</td>
      <td>0.1060</td>
      <td>0.3080</td>
      <td>0.000036</td>
      <td>0.1210</td>
      <td>0.499</td>
      <td>88.933</td>
      <td>4</td>
      <td>minor</td>
      <td>963.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>16996777</td>
      <td>rap</td>
      <td>Juice WRLD</td>
      <td>96</td>
      <td>Robbery</td>
      <td>0</td>
      <td>240527</td>
      <td>1</td>
      <td>2021</td>
      <td>0.708</td>
      <td>...</td>
      <td>1</td>
      <td>0.0442</td>
      <td>0.3480</td>
      <td>0.000000</td>
      <td>0.2220</td>
      <td>0.543</td>
      <td>79.993</td>
      <td>4</td>
      <td>major</td>
      <td>963.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5988689</td>
      <td>rap</td>
      <td>Roddy Ricch</td>
      <td>88</td>
      <td>Big Stepper</td>
      <td>0</td>
      <td>175170</td>
      <td>0</td>
      <td>2021</td>
      <td>0.753</td>
      <td>...</td>
      <td>1</td>
      <td>0.2920</td>
      <td>0.0477</td>
      <td>0.000000</td>
      <td>0.1970</td>
      <td>0.616</td>
      <td>76.997</td>
      <td>4</td>
      <td>major</td>
      <td>963.5</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div>
</div>
</div>
<p>Note the column <code>track_popularity_rank</code>. Why does it contain floating point numbers? Check the <code>rank()</code> documentation to find out!</p>
</section>
<section id="practice-exercise-1" class="level3" data-number="5.5.4">
<h3 data-number="5.5.4" class="anchored" data-anchor-id="practice-exercise-1"><span class="header-section-number">5.5.4</span> Practice exercise 1</h3>
<section id="section" class="level4" data-number="5.5.4.1">
<h4 data-number="5.5.4.1" class="anchored" data-anchor-id="section"><span class="header-section-number">5.5.4.1</span> </h4>
<p>Read the file <em>STAT303-1 survey for data analysis.csv</em>.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>survey_data <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/STAT303-1 survey for data analysis.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-1" class="level4" data-number="5.5.4.2">
<h4 data-number="5.5.4.2" class="anchored" data-anchor-id="section-1"><span class="header-section-number">5.5.4.2</span> </h4>
<p>How many observations and variables are there in the data?</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The data has "</span>,survey_data.shape[<span class="dv">0</span>],<span class="st">"observations, and"</span>, survey_data.shape[<span class="dv">1</span>], <span class="st">"columns"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The data has  192 observations, and 51 columns</code></pre>
</div>
</div>
</section>
<section id="section-2" class="level4" data-number="5.5.4.3">
<h4 data-number="5.5.4.3" class="anchored" data-anchor-id="section-2"><span class="header-section-number">5.5.4.3</span> </h4>
<p>Rename all the columns of the data, except the first two columns, with the shorter names in the list <code>new_col_names</code> given below. The order of column names in the list is the same as the order in which the columns are to be renamed starting with the third column from the left.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>new_col_names <span class="op">=</span> [<span class="st">'parties_per_month'</span>, <span class="st">'do_you_smoke'</span>, <span class="st">'weed'</span>, <span class="st">'are_you_an_introvert_or_extrovert'</span>, <span class="st">'love_first_sight'</span>, <span class="st">'learning_style'</span>, <span class="st">'left_right_brained'</span>, <span class="st">'personality_type'</span>, <span class="st">'social_media'</span>, <span class="st">'num_insta_followers'</span>, <span class="st">'streaming_platforms'</span>, <span class="st">'expected_marriage_age'</span>, <span class="st">'expected_starting_salary'</span>, <span class="st">'fav_sport'</span>, <span class="st">'minutes_ex_per_week'</span>, <span class="st">'sleep_hours_per_day'</span>, <span class="st">'how_happy'</span>, <span class="st">'farthest_distance_travelled'</span>, <span class="st">'fav_number'</span>, <span class="st">'fav_letter'</span>, <span class="st">'internet_hours_per_day'</span>, <span class="st">'only_child'</span>, <span class="st">'birthdate_odd_even'</span>, <span class="st">'birth_month'</span>, <span class="st">'fav_season'</span>, <span class="st">'living_location_on_campus'</span>, <span class="st">'major'</span>, <span class="st">'num_majors_minors'</span>, <span class="st">'high_school_GPA'</span>, <span class="st">'NU_GPA'</span>, <span class="st">'age'</span>, <span class="st">'height'</span>, <span class="st">'height_father'</span>, <span class="st">'height_mother'</span>, <span class="st">'school_year'</span>, <span class="st">'procrastinator'</span>, <span class="st">'num_clubs'</span>, <span class="st">'student_athlete'</span>, <span class="st">'AP_stats'</span>, <span class="st">'used_python_before'</span>, <span class="st">'dominant_hand'</span>, <span class="st">'childhood_in_US'</span>, <span class="st">'gender'</span>, <span class="st">'region_of_residence'</span>, <span class="st">'political_affliation'</span>, <span class="st">'cant_change_math_ability'</span>, <span class="st">'can_change_math_ability'</span>, <span class="st">'math_is_genetic'</span>, <span class="st">'much_effort_is_lack_of_talent'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>survey_data.columns <span class="op">=</span> <span class="bu">list</span>(survey_data.columns[<span class="dv">0</span>:<span class="dv">2</span>])<span class="op">+</span>new_col_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-3" class="level4" data-number="5.5.4.4">
<h4 data-number="5.5.4.4" class="anchored" data-anchor-id="section-3"><span class="header-section-number">5.5.4.4</span> </h4>
<p>Rename the following columns again:</p>
<ol type="1">
<li><p>Rename <code>do_you_smoke</code> to <code>smoke</code>.</p></li>
<li><p>Rename <code>are_you_an_introvert_or_extrovert</code> to <code>introvert_extrovert</code>.</p></li>
</ol>
<p><strong>Hint:</strong> Use the function <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rename.html">rename()</a></p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>survey_data.rename(columns<span class="op">=</span>{<span class="st">'do_you_smoke'</span>:<span class="st">'smoke'</span>,<span class="st">'are_you_an_introvert_or_extrovert'</span>:<span class="st">'introvert_extrovert'</span>},inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-4" class="level4" data-number="5.5.4.5">
<h4 data-number="5.5.4.5" class="anchored" data-anchor-id="section-4"><span class="header-section-number">5.5.4.5</span> </h4>
<p>Find the proportion of people going to more than 4 parties per month. Use the variable <code>parties_per_month</code>.</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>survey_data[<span class="st">'parties_per_month'</span>]<span class="op">=</span>pd.to_numeric(survey_data.parties_per_month,errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>survey_data.loc[survey_data[<span class="st">'parties_per_month'</span>]<span class="op">&gt;</span><span class="dv">4</span>,:].shape[<span class="dv">0</span>]<span class="op">/</span>survey_data.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>0.3385416666666667</code></pre>
</div>
</div>
</section>
<section id="section-5" class="level4" data-number="5.5.4.6">
<h4 data-number="5.5.4.6" class="anchored" data-anchor-id="section-5"><span class="header-section-number">5.5.4.6</span> </h4>
<p>Among the people who go to more than 4 parties a month, what proportion of them are introverts?</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>survey_data.loc[((survey_data[<span class="st">'parties_per_month'</span>]<span class="op">&gt;</span><span class="dv">4</span>) <span class="op">&amp;</span> (survey_data.introvert_extrovert<span class="op">==</span><span class="st">'Introvert'</span>)),:].shape[<span class="dv">0</span>]<span class="op">/</span>survey_data.loc[survey_data[<span class="st">'parties_per_month'</span>]<span class="op">&gt;</span><span class="dv">4</span>,:].shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>0.5076923076923077</code></pre>
</div>
</div>
</section>
<section id="section-6" class="level4" data-number="5.5.4.7">
<h4 data-number="5.5.4.7" class="anchored" data-anchor-id="section-6"><span class="header-section-number">5.5.4.7</span> </h4>
<p>Find the proportion of people in each category of the variable <code>how_happy</code>.</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>survey_data.how_happy.value_counts()<span class="op">/</span>survey_data.shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>Pretty happy     0.703125
Very happy       0.151042
Not too happy    0.088542
Don't know       0.057292
Name: how_happy, dtype: float64</code></pre>
</div>
</div>
</section>
<section id="section-7" class="level4" data-number="5.5.4.8">
<h4 data-number="5.5.4.8" class="anchored" data-anchor-id="section-7"><span class="header-section-number">5.5.4.8</span> </h4>
<p>Among the people who go to more than 4 parties a month, what proportion of them are either <code>Pretty happy</code> or <code>Very happy</code>?</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>survey_data.loc[((survey_data[<span class="st">'parties_per_month'</span>]<span class="op">&gt;</span><span class="dv">4</span>) <span class="op">&amp;</span> (survey_data.how_happy.isin([<span class="st">'Pretty happy'</span>,<span class="st">'Very happy'</span>])))].shape[<span class="dv">0</span>]<span class="op">/</span>survey_data.loc[survey_data[<span class="st">'parties_per_month'</span>]<span class="op">&gt;</span><span class="dv">4</span>,:].shape[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>0.9076923076923077</code></pre>
</div>
</div>
</section>
<section id="section-8" class="level4" data-number="5.5.4.9">
<h4 data-number="5.5.4.9" class="anchored" data-anchor-id="section-8"><span class="header-section-number">5.5.4.9</span> </h4>
<p>Examine the column <code>num_insta_followers</code>. Some numbers in the column contain a comma(<code>,</code>) or a tilde(<code>~</code>). Remove both these characters from the numbers in the column.</p>
<p><strong>Hint:</strong> You may use the function <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.replace.html">str.replace()</a> of the Pandas Series class.</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>survey_data_insta <span class="op">=</span> survey_data.copy()</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>survey_data_insta[<span class="st">'num_insta_followers'</span>]<span class="op">=</span>survey_data_insta[<span class="st">'num_insta_followers'</span>].<span class="bu">str</span>.replace(<span class="st">','</span>,<span class="st">''</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>survey_data_insta[<span class="st">'num_insta_followers'</span>]<span class="op">=</span>survey_data_insta[<span class="st">'num_insta_followers'</span>].<span class="bu">str</span>.replace(<span class="st">'~'</span>,<span class="st">''</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-9" class="level4" data-number="5.5.4.10">
<h4 data-number="5.5.4.10" class="anchored" data-anchor-id="section-9"><span class="header-section-number">5.5.4.10</span> </h4>
<p>Convert the column <code>num_insta_followers</code> to numeric. Coerce the errors.</p>
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>survey_data_insta.num_insta_followers <span class="op">=</span> pd.to_numeric(survey_data_insta.num_insta_followers,errors<span class="op">=</span><span class="st">'coerce'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="section-10" class="level4" data-number="5.5.4.11">
<h4 data-number="5.5.4.11" class="anchored" data-anchor-id="section-10"><span class="header-section-number">5.5.4.11</span> </h4>
<p>Drop the observations consisting of missing values for <code>num_insta_followers</code>. Report the number of observations dropped.</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>survey_data.num_insta_followers.isna().<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>3</code></pre>
</div>
</div>
</section>
<section id="section-11" class="level4" data-number="5.5.4.12">
<h4 data-number="5.5.4.12" class="anchored" data-anchor-id="section-11"><span class="header-section-number">5.5.4.12</span> </h4>
<p>What is the mean <code>internet_hours_per_day</code> for the top 45 people with the most instagram followers?</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>survey_data_insta.sort_values(by <span class="op">=</span> <span class="st">'num_insta_followers'</span>,ascending<span class="op">=</span><span class="va">False</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>top_insta <span class="op">=</span> survey_data_insta.iloc[:<span class="dv">46</span>,:]</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>top_insta.internet_hours_per_day <span class="op">=</span> pd.to_numeric(top_insta.internet_hours_per_day,errors <span class="op">=</span> <span class="st">'coerce'</span>)</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>top_insta.internet_hours_per_day.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>5.088888888888889</code></pre>
</div>
</div>
</section>
<section id="section-12" class="level4" data-number="5.5.4.13">
<h4 data-number="5.5.4.13" class="anchored" data-anchor-id="section-12"><span class="header-section-number">5.5.4.13</span> </h4>
<p>What is the mean <code>internet_hours_per_day</code> for the remaining people?</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>low_insta <span class="op">=</span> survey_data_insta.iloc[<span class="dv">46</span>:,:]</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>low_insta.internet_hours_per_day <span class="op">=</span> pd.to_numeric(low_insta.internet_hours_per_day,errors <span class="op">=</span> <span class="st">'coerce'</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>low_insta.internet_hours_per_day.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>13.118881118881118</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="operations-between-dataframe-and-series" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="operations-between-dataframe-and-series"><span class="header-section-number">5.6</span> Operations between DataFrame and Series</h2>
<p>Let us learn arithematic operations between DataFrame and Series with the help of an example.</p>
<p><strong>Example:</strong> Spotify recommends songs based on songs listened by the user. Suppose you have listened to the song <em>drivers license</em>. Spotify intends to recommend you 5 songs that are <em>similar</em> to <em>drivers license</em>. Which songs should it recommend?</p>
<p>Let us see what information do we have about songs that can help us identify songs similar to drivers license. The <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.columns.html">columns</a> attribute of DataFrame will display all the columns names. The description of some of the column names relating to audio features is <a href="https://developer.spotify.com/documentation/web-api/reference/#/operations/get-audio-features">here</a>.</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>spotify_data.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>Index(['artist_followers', 'genres', 'artist_name', 'artist_popularity',
       'track_name', 'track_popularity', 'duration_ms', 'explicit',
       'release_year', 'danceability', 'energy', 'key', 'loudness', 'mode',
       'speechiness', 'acousticness', 'instrumentalness', 'liveness',
       'valence', 'tempo', 'time_signature'],
      dtype='object')</code></pre>
</div>
</div>
<p><strong>Solution approach:</strong> We have several features of a song. Let us find songs similar to <em>drivers license</em> in terms of <em>danceability, energy, key, loudness, mode, speechiness, acousticness, instrumentalness, liveness, valence, time_signature</em> and <em>tempo</em>. Note that we are considering only audio features for simplicity.</p>
<p>To find the songs most similar to <em>drivers license</em>, we need to define a measure that quantifies the similarity. Let us define similarity of a song with <em>drivers license</em> as the Euclidean distance of the song from <em>drivers license</em>, where the coordinates of a song are: (danceability, energy, key, loudness, mode, speechiness, acousticness, instrumentalness, liveness, valence, time_signature, tempo). Thus, similarity can be formulated as:</p>
<p><span class="math display">\[Similarity_{DL-S} = \sqrt{(danceability_{DL}-danceability_{S})^2+(energy_{DL}-energy_{S})^2 +...+ (tempo_{DL}-tempo_{S})^2)},\]</span></p>
<p>where the subscript <em>DL</em> stands for <em>drivers license</em> and <em>S</em> stands for any song. The top 5 songs with the least value of <span class="math inline">\(Similarity_{DL-S}\)</span> will be the most similar to <em>drivers lincense</em> and should be recommended.</p>
<p>Let us subset the columns that we need to use to compute the Euclidean distance.</p>
<div class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>audio_features <span class="op">=</span> spotify_data[[<span class="st">'danceability'</span>, <span class="st">'energy'</span>, <span class="st">'key'</span>, <span class="st">'loudness'</span>,<span class="st">'mode'</span>,<span class="st">'speechiness'</span>,</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'acousticness'</span>, <span class="st">'instrumentalness'</span>, <span class="st">'liveness'</span>,<span class="st">'valence'</span>, <span class="st">'tempo'</span>, <span class="st">'time_signature'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>audio_features.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>danceability</th>
      <th>energy</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.673</td>
      <td>0.529</td>
      <td>0</td>
      <td>-7.226</td>
      <td>1</td>
      <td>0.3060</td>
      <td>0.0769</td>
      <td>0.000338</td>
      <td>0.0856</td>
      <td>0.203</td>
      <td>161.991</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.511</td>
      <td>0.566</td>
      <td>6</td>
      <td>-7.230</td>
      <td>0</td>
      <td>0.2000</td>
      <td>0.3490</td>
      <td>0.000000</td>
      <td>0.3400</td>
      <td>0.218</td>
      <td>83.903</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.699</td>
      <td>0.687</td>
      <td>7</td>
      <td>-3.997</td>
      <td>0</td>
      <td>0.1060</td>
      <td>0.3080</td>
      <td>0.000036</td>
      <td>0.1210</td>
      <td>0.499</td>
      <td>88.933</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.708</td>
      <td>0.690</td>
      <td>2</td>
      <td>-5.181</td>
      <td>1</td>
      <td>0.0442</td>
      <td>0.3480</td>
      <td>0.000000</td>
      <td>0.2220</td>
      <td>0.543</td>
      <td>79.993</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.753</td>
      <td>0.597</td>
      <td>8</td>
      <td>-8.469</td>
      <td>1</td>
      <td>0.2920</td>
      <td>0.0477</td>
      <td>0.000000</td>
      <td>0.1970</td>
      <td>0.616</td>
      <td>76.997</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Distribution of values of audio_features</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>audio_features.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>danceability</th>
      <th>energy</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.568357</td>
      <td>0.580633</td>
      <td>5.240326</td>
      <td>-9.432548</td>
      <td>0.670928</td>
      <td>0.111984</td>
      <td>0.383938</td>
      <td>0.071169</td>
      <td>0.223756</td>
      <td>0.552302</td>
      <td>119.335060</td>
      <td>3.884177</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.159444</td>
      <td>0.236631</td>
      <td>3.532546</td>
      <td>4.449731</td>
      <td>0.469877</td>
      <td>0.198068</td>
      <td>0.321142</td>
      <td>0.209555</td>
      <td>0.198076</td>
      <td>0.250017</td>
      <td>29.864219</td>
      <td>0.458082</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-60.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.462000</td>
      <td>0.405000</td>
      <td>2.000000</td>
      <td>-11.990000</td>
      <td>0.000000</td>
      <td>0.033200</td>
      <td>0.070000</td>
      <td>0.000000</td>
      <td>0.098100</td>
      <td>0.353000</td>
      <td>96.099250</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.579000</td>
      <td>0.591000</td>
      <td>5.000000</td>
      <td>-8.645000</td>
      <td>1.000000</td>
      <td>0.043100</td>
      <td>0.325000</td>
      <td>0.000011</td>
      <td>0.141000</td>
      <td>0.560000</td>
      <td>118.002000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.685000</td>
      <td>0.776000</td>
      <td>8.000000</td>
      <td>-6.131000</td>
      <td>1.000000</td>
      <td>0.075300</td>
      <td>0.671000</td>
      <td>0.002220</td>
      <td>0.292000</td>
      <td>0.760000</td>
      <td>137.929000</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.988000</td>
      <td>1.000000</td>
      <td>11.000000</td>
      <td>3.744000</td>
      <td>1.000000</td>
      <td>0.969000</td>
      <td>0.996000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>243.507000</td>
      <td>5.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that the audio features differ in terms of scale. Some features like <em>key</em> have a wide range of [0,11], while others like <em>danceability</em> have a very narrow range of [0,0.988]. If we use them directly, features like <em>danceability</em> will have a much higher influence on <span class="math inline">\(Similarity_{DL-S}\)</span> as compared to features like <em>key</em>. Assuming we wish all the features to have equal weight in quantifying a song’s similarity to <em>drivers license</em>, we should scale the features, so that their values are comparable.</p>
<p>Let us scale the value of each column to a standard uniform distribution: <span class="math inline">\(U[0,1]\)</span>.</p>
<p>For scaling the values of a column to <span class="math inline">\(U[0,1]\)</span>, we need to subtract the minimum value of the column from each value, and divide by the range of values of the column. For example, <em>danceability</em> can be standardized as follows:</p>
<div class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Scaling danceability to U[0,1]</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>danceability_value_range <span class="op">=</span> audio_features.danceability.<span class="bu">max</span>()<span class="op">-</span>audio_features.danceability.<span class="bu">min</span>()</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>danceability_std <span class="op">=</span> (audio_features.danceability<span class="op">-</span>audio_features.danceability.<span class="bu">min</span>())<span class="op">/</span>danceability_value_range</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>danceability_std</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>0         0.681174
1         0.517206
2         0.707490
3         0.716599
4         0.762146
            ...   
243185    0.621457
243186    0.797571
243187    0.533401
243188    0.565789
243189    0.750000
Name: danceability, Length: 243190, dtype: float64</code></pre>
</div>
</div>
<p>However, it will be cumbersome to repeat the above code for each audio feature. We can instead write a function that scales values of a column to <span class="math inline">\(U[0,1]\)</span>, and apply the function on all the audio features.</p>
<div class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Function to scale a column to U[0,1]</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scale_uniform(x):</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x<span class="op">-</span>x.<span class="bu">min</span>())<span class="op">/</span>(x.<span class="bu">max</span>()<span class="op">-</span>x.<span class="bu">min</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use the Pandas function <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html">apply()</a> to apply the above function to the DataFrame <code>audio_features</code>.</p>
<div class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Scaling all audio features to U[0,1]</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>audio_features_scaled <span class="op">=</span> audio_features.<span class="bu">apply</span>(scale_uniform)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>lambda function:</strong> Note that one line functions can be conveniently written as lambda functions in Python. These functions do not require a name, and can be defined using the keyword <code>lambda</code>. The above two blocks of code can be concisely written as:</p>
<div class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>audio_features_scaled <span class="op">=</span> audio_features.<span class="bu">apply</span>(<span class="kw">lambda</span> x: (x<span class="op">-</span>x.<span class="bu">min</span>())<span class="op">/</span>(x.<span class="bu">max</span>()<span class="op">-</span>x.<span class="bu">min</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">#All the audio features are scaled to U[0,1]</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>audio_features_scaled.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>danceability</th>
      <th>energy</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
      <td>243190.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.575260</td>
      <td>0.580633</td>
      <td>0.476393</td>
      <td>0.793290</td>
      <td>0.670928</td>
      <td>0.115566</td>
      <td>0.385480</td>
      <td>0.071169</td>
      <td>0.223756</td>
      <td>0.552302</td>
      <td>0.490068</td>
      <td>0.776835</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.161380</td>
      <td>0.236631</td>
      <td>0.321141</td>
      <td>0.069806</td>
      <td>0.469877</td>
      <td>0.204405</td>
      <td>0.322431</td>
      <td>0.209555</td>
      <td>0.198076</td>
      <td>0.250017</td>
      <td>0.122642</td>
      <td>0.091616</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.467611</td>
      <td>0.405000</td>
      <td>0.181818</td>
      <td>0.753169</td>
      <td>0.000000</td>
      <td>0.034262</td>
      <td>0.070281</td>
      <td>0.000000</td>
      <td>0.098100</td>
      <td>0.353000</td>
      <td>0.394647</td>
      <td>0.800000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.586032</td>
      <td>0.591000</td>
      <td>0.454545</td>
      <td>0.805644</td>
      <td>1.000000</td>
      <td>0.044479</td>
      <td>0.326305</td>
      <td>0.000011</td>
      <td>0.141000</td>
      <td>0.560000</td>
      <td>0.484594</td>
      <td>0.800000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.693320</td>
      <td>0.776000</td>
      <td>0.727273</td>
      <td>0.845083</td>
      <td>1.000000</td>
      <td>0.077709</td>
      <td>0.673695</td>
      <td>0.002220</td>
      <td>0.292000</td>
      <td>0.760000</td>
      <td>0.566427</td>
      <td>0.800000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Since we need to find the Euclidean distance from the song <em>drivers license</em>, let us find the index of the row containing features of *drivers license.</p>
<div class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>drivers_license_index <span class="op">=</span> spotify_data[spotify_data.track_name<span class="op">==</span><span class="st">'drivers license'</span>].index[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we’ll subtract the audio features of <em>drivers license</em> from all other songs:</p>
<div class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>songs_minus_DL <span class="op">=</span> audio_features_scaled<span class="op">-</span>audio_features_scaled.loc[drivers_license_index,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let us square the difference computed above. We’ll use the in-built python function <code>pow()</code> to square the difference:</p>
<div class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>songs_minus_DL_sq <span class="op">=</span> songs_minus_DL.<span class="bu">pow</span>(<span class="dv">2</span>)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>songs_minus_DL_sq.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>danceability</th>
      <th>energy</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.007933</td>
      <td>0.008649</td>
      <td>0.826446</td>
      <td>0.000580</td>
      <td>0.0</td>
      <td>0.064398</td>
      <td>0.418204</td>
      <td>1.055600e-07</td>
      <td>0.000376</td>
      <td>0.005041</td>
      <td>0.005535</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.005610</td>
      <td>0.016900</td>
      <td>0.132231</td>
      <td>0.000577</td>
      <td>1.0</td>
      <td>0.020844</td>
      <td>0.139498</td>
      <td>1.716100e-10</td>
      <td>0.055225</td>
      <td>0.007396</td>
      <td>0.060654</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.013314</td>
      <td>0.063001</td>
      <td>0.074380</td>
      <td>0.005586</td>
      <td>1.0</td>
      <td>0.002244</td>
      <td>0.171942</td>
      <td>5.382400e-10</td>
      <td>0.000256</td>
      <td>0.134689</td>
      <td>0.050906</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.015499</td>
      <td>0.064516</td>
      <td>0.528926</td>
      <td>0.003154</td>
      <td>0.0</td>
      <td>0.000269</td>
      <td>0.140249</td>
      <td>1.716100e-10</td>
      <td>0.013689</td>
      <td>0.168921</td>
      <td>0.068821</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.028914</td>
      <td>0.025921</td>
      <td>0.033058</td>
      <td>0.000021</td>
      <td>0.0</td>
      <td>0.057274</td>
      <td>0.456981</td>
      <td>1.716100e-10</td>
      <td>0.008464</td>
      <td>0.234256</td>
      <td>0.075428</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now, we’ll sum the squares of differences from all audio features to compute the similarity of all songs to <em>drivers license</em>.</p>
<div class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>distance_squared <span class="op">=</span> songs_minus_DL_sq.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>distance_squared.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<pre><code>0    1.337163
1    1.438935
2    1.516317
3    1.004043
4    0.920316
dtype: float64</code></pre>
</div>
</div>
<p>Now, we’ll sort these distances to find the top 5 songs closest to drivers’s license.</p>
<div class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>distances_sorted <span class="op">=</span> distance_squared.sort_values()</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>distances_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>2398      0.000000
81844     0.008633
4397      0.011160
130789    0.015018
143744    0.015058
dtype: float64</code></pre>
</div>
</div>
<p>Using the indices of the top 5 distances, we will identify the top 5 songs most similar to <em>drivers license</em>:</p>
<div class="cell" data-scrolled="true" data-execution_count="122">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>spotify_data.loc[distances_sorted.index[<span class="dv">0</span>:<span class="dv">6</span>],:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>genres</th>
      <th>artist_name</th>
      <th>artist_popularity</th>
      <th>track_name</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>...</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2398</th>
      <td>1444702</td>
      <td>pop</td>
      <td>Olivia Rodrigo</td>
      <td>88</td>
      <td>drivers license</td>
      <td>99</td>
      <td>242014</td>
      <td>1</td>
      <td>2021</td>
      <td>0.585</td>
      <td>...</td>
      <td>10</td>
      <td>-8.761</td>
      <td>1</td>
      <td>0.0601</td>
      <td>0.721</td>
      <td>0.000013</td>
      <td>0.105</td>
      <td>0.132</td>
      <td>143.874</td>
      <td>4</td>
    </tr>
    <tr>
      <th>81844</th>
      <td>2264501</td>
      <td>pop</td>
      <td>Jay Chou</td>
      <td>74</td>
      <td>安靜</td>
      <td>49</td>
      <td>334240</td>
      <td>0</td>
      <td>2001</td>
      <td>0.513</td>
      <td>...</td>
      <td>10</td>
      <td>-7.853</td>
      <td>1</td>
      <td>0.0281</td>
      <td>0.688</td>
      <td>0.000008</td>
      <td>0.116</td>
      <td>0.123</td>
      <td>143.924</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4397</th>
      <td>25457</td>
      <td>pop</td>
      <td>Terence Lam</td>
      <td>60</td>
      <td>拼命無恙 in Bb major</td>
      <td>52</td>
      <td>241062</td>
      <td>0</td>
      <td>2020</td>
      <td>0.532</td>
      <td>...</td>
      <td>10</td>
      <td>-9.690</td>
      <td>1</td>
      <td>0.0269</td>
      <td>0.674</td>
      <td>0.000000</td>
      <td>0.117</td>
      <td>0.190</td>
      <td>151.996</td>
      <td>4</td>
    </tr>
    <tr>
      <th>130789</th>
      <td>176266</td>
      <td>pop</td>
      <td>Alan Tam</td>
      <td>54</td>
      <td>從後趕上</td>
      <td>8</td>
      <td>258427</td>
      <td>0</td>
      <td>1988</td>
      <td>0.584</td>
      <td>...</td>
      <td>10</td>
      <td>-11.889</td>
      <td>1</td>
      <td>0.0282</td>
      <td>0.707</td>
      <td>0.000002</td>
      <td>0.107</td>
      <td>0.124</td>
      <td>140.147</td>
      <td>4</td>
    </tr>
    <tr>
      <th>143744</th>
      <td>396326</td>
      <td>pop &amp; rock</td>
      <td>Laura Branigan</td>
      <td>64</td>
      <td>How Am I Supposed to Live Without You</td>
      <td>40</td>
      <td>263320</td>
      <td>0</td>
      <td>1983</td>
      <td>0.559</td>
      <td>...</td>
      <td>10</td>
      <td>-8.260</td>
      <td>1</td>
      <td>0.0355</td>
      <td>0.813</td>
      <td>0.000083</td>
      <td>0.134</td>
      <td>0.185</td>
      <td>139.079</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35627</th>
      <td>1600562</td>
      <td>pop</td>
      <td>Tiziano Ferro</td>
      <td>68</td>
      <td>Non Me Lo So Spiegare</td>
      <td>44</td>
      <td>240040</td>
      <td>0</td>
      <td>2014</td>
      <td>0.609</td>
      <td>...</td>
      <td>11</td>
      <td>-7.087</td>
      <td>1</td>
      <td>0.0352</td>
      <td>0.706</td>
      <td>0.000000</td>
      <td>0.130</td>
      <td>0.207</td>
      <td>146.078</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
<p>6 rows × 21 columns</p>
</div>
</div>
</div>
<p>We can see the top 5 songs most similar to <em>drivers license</em> in the <em>track_name</em> column above. Interestingly, three of the five songs are Asian! These songs indeed sound similart to <em>drivers license</em>!</p>
</section>
<section id="correlation" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="correlation"><span class="header-section-number">5.7</span> Correlation</h2>
<p>Correlation may refer to any kind of association between two random variables. However, in this book, we will always consider correlation as the linear association between two random variables, or the Pearson’s correlation coefficient. Note that correlation does not imply causalty and vice-versa.</p>
<p>The Pandas function <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.corr.html">corr()</a> provides the pairwise correlation between all columns of a DataFrame, or between two Series. The function <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.corrwith.html#pandas.DataFrame.corrwith">corrwith()</a> provides the pairwise correlation of a DataFrame with another DataFrame or Series.</p>
<div class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pairwise correlation amongst all columns</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>spotify_data.corr()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>artist_followers</th>
      <th>artist_popularity</th>
      <th>track_popularity</th>
      <th>duration_ms</th>
      <th>explicit</th>
      <th>release_year</th>
      <th>danceability</th>
      <th>energy</th>
      <th>key</th>
      <th>loudness</th>
      <th>mode</th>
      <th>speechiness</th>
      <th>acousticness</th>
      <th>instrumentalness</th>
      <th>liveness</th>
      <th>valence</th>
      <th>tempo</th>
      <th>time_signature</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>artist_followers</th>
      <td>1.000000</td>
      <td>0.577861</td>
      <td>0.197426</td>
      <td>0.040435</td>
      <td>0.082857</td>
      <td>0.098589</td>
      <td>-0.010120</td>
      <td>0.080085</td>
      <td>-0.000119</td>
      <td>0.123771</td>
      <td>0.004313</td>
      <td>-0.059933</td>
      <td>-0.107475</td>
      <td>-0.033986</td>
      <td>0.002425</td>
      <td>-0.053317</td>
      <td>0.016524</td>
      <td>0.030826</td>
    </tr>
    <tr>
      <th>artist_popularity</th>
      <td>0.577861</td>
      <td>1.000000</td>
      <td>0.285565</td>
      <td>-0.097996</td>
      <td>0.092147</td>
      <td>0.062007</td>
      <td>0.038784</td>
      <td>0.039583</td>
      <td>-0.011005</td>
      <td>0.045165</td>
      <td>0.018758</td>
      <td>0.236942</td>
      <td>-0.075715</td>
      <td>-0.066679</td>
      <td>0.099678</td>
      <td>-0.034501</td>
      <td>-0.032036</td>
      <td>-0.033423</td>
    </tr>
    <tr>
      <th>track_popularity</th>
      <td>0.197426</td>
      <td>0.285565</td>
      <td>1.000000</td>
      <td>0.060474</td>
      <td>0.193685</td>
      <td>0.568329</td>
      <td>0.158507</td>
      <td>0.217342</td>
      <td>0.013369</td>
      <td>0.296350</td>
      <td>-0.022486</td>
      <td>-0.056537</td>
      <td>-0.284433</td>
      <td>-0.124283</td>
      <td>-0.090479</td>
      <td>-0.038859</td>
      <td>0.058408</td>
      <td>0.071741</td>
    </tr>
    <tr>
      <th>duration_ms</th>
      <td>0.040435</td>
      <td>-0.097996</td>
      <td>0.060474</td>
      <td>1.000000</td>
      <td>-0.024226</td>
      <td>0.067665</td>
      <td>-0.145779</td>
      <td>0.075990</td>
      <td>0.007710</td>
      <td>0.078586</td>
      <td>-0.034818</td>
      <td>-0.332585</td>
      <td>-0.133960</td>
      <td>0.067055</td>
      <td>-0.034631</td>
      <td>-0.155354</td>
      <td>0.051046</td>
      <td>0.085015</td>
    </tr>
    <tr>
      <th>explicit</th>
      <td>0.082857</td>
      <td>0.092147</td>
      <td>0.193685</td>
      <td>-0.024226</td>
      <td>1.000000</td>
      <td>0.215656</td>
      <td>0.138522</td>
      <td>0.104734</td>
      <td>0.011818</td>
      <td>0.124410</td>
      <td>-0.060350</td>
      <td>0.077268</td>
      <td>-0.129363</td>
      <td>-0.039472</td>
      <td>-0.024283</td>
      <td>-0.032549</td>
      <td>0.006585</td>
      <td>0.043538</td>
    </tr>
    <tr>
      <th>release_year</th>
      <td>0.098589</td>
      <td>0.062007</td>
      <td>0.568329</td>
      <td>0.067665</td>
      <td>0.215656</td>
      <td>1.000000</td>
      <td>0.204743</td>
      <td>0.338096</td>
      <td>0.021497</td>
      <td>0.430054</td>
      <td>-0.071338</td>
      <td>-0.032968</td>
      <td>-0.369038</td>
      <td>-0.149644</td>
      <td>-0.045160</td>
      <td>-0.070025</td>
      <td>0.079382</td>
      <td>0.089485</td>
    </tr>
    <tr>
      <th>danceability</th>
      <td>-0.010120</td>
      <td>0.038784</td>
      <td>0.158507</td>
      <td>-0.145779</td>
      <td>0.138522</td>
      <td>0.204743</td>
      <td>1.000000</td>
      <td>0.137615</td>
      <td>0.020128</td>
      <td>0.142239</td>
      <td>-0.051130</td>
      <td>0.198509</td>
      <td>-0.143936</td>
      <td>-0.179213</td>
      <td>-0.114999</td>
      <td>0.505350</td>
      <td>-0.125061</td>
      <td>0.111015</td>
    </tr>
    <tr>
      <th>energy</th>
      <td>0.080085</td>
      <td>0.039583</td>
      <td>0.217342</td>
      <td>0.075990</td>
      <td>0.104734</td>
      <td>0.338096</td>
      <td>0.137615</td>
      <td>1.000000</td>
      <td>0.030824</td>
      <td>0.747829</td>
      <td>-0.053374</td>
      <td>-0.043377</td>
      <td>-0.678745</td>
      <td>-0.131269</td>
      <td>0.126050</td>
      <td>0.348158</td>
      <td>0.205960</td>
      <td>0.170854</td>
    </tr>
    <tr>
      <th>key</th>
      <td>-0.000119</td>
      <td>-0.011005</td>
      <td>0.013369</td>
      <td>0.007710</td>
      <td>0.011818</td>
      <td>0.021497</td>
      <td>0.020128</td>
      <td>0.030824</td>
      <td>1.000000</td>
      <td>0.024674</td>
      <td>-0.139688</td>
      <td>-0.003533</td>
      <td>-0.023179</td>
      <td>-0.006600</td>
      <td>-0.011566</td>
      <td>0.024206</td>
      <td>0.008336</td>
      <td>0.007738</td>
    </tr>
    <tr>
      <th>loudness</th>
      <td>0.123771</td>
      <td>0.045165</td>
      <td>0.296350</td>
      <td>0.078586</td>
      <td>0.124410</td>
      <td>0.430054</td>
      <td>0.142239</td>
      <td>0.747829</td>
      <td>0.024674</td>
      <td>1.000000</td>
      <td>-0.028151</td>
      <td>-0.173444</td>
      <td>-0.493020</td>
      <td>-0.269008</td>
      <td>0.002959</td>
      <td>0.209588</td>
      <td>0.171926</td>
      <td>0.146030</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>0.004313</td>
      <td>0.018758</td>
      <td>-0.022486</td>
      <td>-0.034818</td>
      <td>-0.060350</td>
      <td>-0.071338</td>
      <td>-0.051130</td>
      <td>-0.053374</td>
      <td>-0.139688</td>
      <td>-0.028151</td>
      <td>1.000000</td>
      <td>-0.037237</td>
      <td>0.043773</td>
      <td>-0.024695</td>
      <td>0.005657</td>
      <td>0.010305</td>
      <td>0.015399</td>
      <td>-0.015225</td>
    </tr>
    <tr>
      <th>speechiness</th>
      <td>-0.059933</td>
      <td>0.236942</td>
      <td>-0.056537</td>
      <td>-0.332585</td>
      <td>0.077268</td>
      <td>-0.032968</td>
      <td>0.198509</td>
      <td>-0.043377</td>
      <td>-0.003533</td>
      <td>-0.173444</td>
      <td>-0.037237</td>
      <td>1.000000</td>
      <td>0.112061</td>
      <td>-0.094796</td>
      <td>0.263630</td>
      <td>0.052171</td>
      <td>-0.127945</td>
      <td>-0.150350</td>
    </tr>
    <tr>
      <th>acousticness</th>
      <td>-0.107475</td>
      <td>-0.075715</td>
      <td>-0.284433</td>
      <td>-0.133960</td>
      <td>-0.129363</td>
      <td>-0.369038</td>
      <td>-0.143936</td>
      <td>-0.678745</td>
      <td>-0.023179</td>
      <td>-0.493020</td>
      <td>0.043773</td>
      <td>0.112061</td>
      <td>1.000000</td>
      <td>0.112107</td>
      <td>0.007415</td>
      <td>-0.175674</td>
      <td>-0.173152</td>
      <td>-0.163243</td>
    </tr>
    <tr>
      <th>instrumentalness</th>
      <td>-0.033986</td>
      <td>-0.066679</td>
      <td>-0.124283</td>
      <td>0.067055</td>
      <td>-0.039472</td>
      <td>-0.149644</td>
      <td>-0.179213</td>
      <td>-0.131269</td>
      <td>-0.006600</td>
      <td>-0.269008</td>
      <td>-0.024695</td>
      <td>-0.094796</td>
      <td>0.112107</td>
      <td>1.000000</td>
      <td>-0.031301</td>
      <td>-0.150172</td>
      <td>-0.027369</td>
      <td>-0.022034</td>
    </tr>
    <tr>
      <th>liveness</th>
      <td>0.002425</td>
      <td>0.099678</td>
      <td>-0.090479</td>
      <td>-0.034631</td>
      <td>-0.024283</td>
      <td>-0.045160</td>
      <td>-0.114999</td>
      <td>0.126050</td>
      <td>-0.011566</td>
      <td>0.002959</td>
      <td>0.005657</td>
      <td>0.263630</td>
      <td>0.007415</td>
      <td>-0.031301</td>
      <td>1.000000</td>
      <td>-0.011137</td>
      <td>-0.027716</td>
      <td>-0.040789</td>
    </tr>
    <tr>
      <th>valence</th>
      <td>-0.053317</td>
      <td>-0.034501</td>
      <td>-0.038859</td>
      <td>-0.155354</td>
      <td>-0.032549</td>
      <td>-0.070025</td>
      <td>0.505350</td>
      <td>0.348158</td>
      <td>0.024206</td>
      <td>0.209588</td>
      <td>0.010305</td>
      <td>0.052171</td>
      <td>-0.175674</td>
      <td>-0.150172</td>
      <td>-0.011137</td>
      <td>1.000000</td>
      <td>0.100947</td>
      <td>0.084783</td>
    </tr>
    <tr>
      <th>tempo</th>
      <td>0.016524</td>
      <td>-0.032036</td>
      <td>0.058408</td>
      <td>0.051046</td>
      <td>0.006585</td>
      <td>0.079382</td>
      <td>-0.125061</td>
      <td>0.205960</td>
      <td>0.008336</td>
      <td>0.171926</td>
      <td>0.015399</td>
      <td>-0.127945</td>
      <td>-0.173152</td>
      <td>-0.027369</td>
      <td>-0.027716</td>
      <td>0.100947</td>
      <td>1.000000</td>
      <td>0.017423</td>
    </tr>
    <tr>
      <th>time_signature</th>
      <td>0.030826</td>
      <td>-0.033423</td>
      <td>0.071741</td>
      <td>0.085015</td>
      <td>0.043538</td>
      <td>0.089485</td>
      <td>0.111015</td>
      <td>0.170854</td>
      <td>0.007738</td>
      <td>0.146030</td>
      <td>-0.015225</td>
      <td>-0.150350</td>
      <td>-0.163243</td>
      <td>-0.022034</td>
      <td>-0.040789</td>
      <td>0.084783</td>
      <td>0.017423</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><strong>Q:</strong> Which audio feature is the most correlated with <em>track_popularity</em>?</p>
<div class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>spotify_data.corrwith(spotify_data.track_popularity).sort_values(ascending <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="168">
<pre><code>track_popularity     1.000000
release_year         0.568329
loudness             0.296350
artist_popularity    0.285565
energy               0.217342
artist_followers     0.197426
explicit             0.193685
danceability         0.158507
time_signature       0.071741
duration_ms          0.060474
tempo                0.058408
key                  0.013369
mode                -0.022486
valence             -0.038859
speechiness         -0.056537
liveness            -0.090479
instrumentalness    -0.124283
acousticness        -0.284433
dtype: float64</code></pre>
</div>
</div>
<p>Loudness is the audio feature having the highest correlation with <em>track_popularity</em>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./NumPy.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Data visualization.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>