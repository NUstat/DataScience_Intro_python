<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Science with Python - 8&nbsp; Data wrangling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Data aggregation.html" rel="next">
<link href="./Data cleaning and preparation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data wrangling</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./NU_Stat_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science with Python</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Quick overview: Python programming</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to Python and Jupyter Notebooks.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Python and Jupyter Notebooks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_structures.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data structures</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Exploratory data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reading data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pandas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data visualization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data cleaning and preparation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data cleaning and preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data wrangling.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data aggregation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data aggregation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./student_solutions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Alternative solutions by students</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Assignments</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 1 (Reading data).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Assignment 1 (Reading data)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 2 (NumPy).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Assignment 2 (NumPy)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 3 (Pandas).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Assignment 3 (Pandas)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 4 (Data Visualization).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Assignment 4 (Data Visualization)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 5 (Data cleaning and preparation).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Assignment 5 (Data cleaning &amp; preparation)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Datasets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#hierarchical-indexing" id="toc-hierarchical-indexing" class="nav-link active" data-scroll-target="#hierarchical-indexing"><span class="toc-section-number">8.1</span>  Hierarchical indexing</a>
  <ul>
  <li><a href="#hierarchical-indexing-in-pandas-series" id="toc-hierarchical-indexing-in-pandas-series" class="nav-link" data-scroll-target="#hierarchical-indexing-in-pandas-series"><span class="toc-section-number">8.1.1</span>  Hierarchical indexing in Pandas Series</a></li>
  <li><a href="#hierarchical-indexing-in-pandas-dataframe" id="toc-hierarchical-indexing-in-pandas-dataframe" class="nav-link" data-scroll-target="#hierarchical-indexing-in-pandas-dataframe"><span class="toc-section-number">8.1.2</span>  Hierarchical indexing in Pandas DataFrame</a>
  <ul class="collapse">
  <li><a href="#get_level_values" id="toc-get_level_values" class="nav-link" data-scroll-target="#get_level_values"><span class="toc-section-number">8.1.2.1</span>  <code>get_level_values()</code></a></li>
  </ul></li>
  <li><a href="#subsetting-data" id="toc-subsetting-data" class="nav-link" data-scroll-target="#subsetting-data"><span class="toc-section-number">8.1.3</span>  Subsetting data</a></li>
  <li><a href="#practice-exercise-1" id="toc-practice-exercise-1" class="nav-link" data-scroll-target="#practice-exercise-1"><span class="toc-section-number">8.1.4</span>  Practice exercise 1</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="toc-section-number">8.1.4.1</span>  </a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="toc-section-number">8.1.4.2</span>  </a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"><span class="toc-section-number">8.1.4.3</span>  </a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"><span class="toc-section-number">8.1.4.4</span>  </a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"><span class="toc-section-number">8.1.4.5</span>  </a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"><span class="toc-section-number">8.1.4.6</span>  </a></li>
  </ul></li>
  <li><a href="#practice-exercise-2" id="toc-practice-exercise-2" class="nav-link" data-scroll-target="#practice-exercise-2"><span class="toc-section-number">8.1.5</span>  Practice exercise 2</a>
  <ul class="collapse">
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"><span class="toc-section-number">8.1.5.1</span>  </a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7"><span class="toc-section-number">8.1.5.2</span>  </a></li>
  </ul></li>
  <li><a href="#practice-exercise-3" id="toc-practice-exercise-3" class="nav-link" data-scroll-target="#practice-exercise-3"><span class="toc-section-number">8.1.6</span>  Practice exercise 3</a></li>
  <li><a href="#reshaping-data" id="toc-reshaping-data" class="nav-link" data-scroll-target="#reshaping-data"><span class="toc-section-number">8.1.7</span>  Reshaping data</a>
  <ul class="collapse">
  <li><a href="#unstack-pandas-series-method" id="toc-unstack-pandas-series-method" class="nav-link" data-scroll-target="#unstack-pandas-series-method"><span class="toc-section-number">8.1.7.1</span>  <code>unstack()</code> (Pandas Series method)</a></li>
  <li><a href="#unstack-pandas-dataframe-method" id="toc-unstack-pandas-dataframe-method" class="nav-link" data-scroll-target="#unstack-pandas-dataframe-method"><span class="toc-section-number">8.1.7.2</span>  <code>unstack()</code> (Pandas DataFrame method)</a></li>
  <li><a href="#stack" id="toc-stack" class="nav-link" data-scroll-target="#stack"><span class="toc-section-number">8.1.7.3</span>  <code>stack()</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#merging-data" id="toc-merging-data" class="nav-link" data-scroll-target="#merging-data"><span class="toc-section-number">8.2</span>  Merging data</a>
  <ul>
  <li><a href="#join-types" id="toc-join-types" class="nav-link" data-scroll-target="#join-types"><span class="toc-section-number">8.2.1</span>  Join types</a>
  <ul class="collapse">
  <li><a href="#one-to-one-join" id="toc-one-to-one-join" class="nav-link" data-scroll-target="#one-to-one-join"><span class="toc-section-number">8.2.1.1</span>  One-to-one join</a></li>
  <li><a href="#many-to-one-join" id="toc-many-to-one-join" class="nav-link" data-scroll-target="#many-to-one-join"><span class="toc-section-number">8.2.1.2</span>  Many-to-one join</a></li>
  <li><a href="#one-to-many-join" id="toc-one-to-many-join" class="nav-link" data-scroll-target="#one-to-many-join"><span class="toc-section-number">8.2.1.3</span>  One-to-many join</a></li>
  <li><a href="#many-to-many-join" id="toc-many-to-many-join" class="nav-link" data-scroll-target="#many-to-many-join"><span class="toc-section-number">8.2.1.4</span>  Many-to-many join</a></li>
  </ul></li>
  <li><a href="#join-types-with-how-argument" id="toc-join-types-with-how-argument" class="nav-link" data-scroll-target="#join-types-with-how-argument"><span class="toc-section-number">8.2.2</span>  Join types with <code>how</code> argument</a>
  <ul class="collapse">
  <li><a href="#inner-join" id="toc-inner-join" class="nav-link" data-scroll-target="#inner-join"><span class="toc-section-number">8.2.2.1</span>  inner join</a></li>
  <li><a href="#left-join" id="toc-left-join" class="nav-link" data-scroll-target="#left-join"><span class="toc-section-number">8.2.2.2</span>  left join</a></li>
  <li><a href="#right-join" id="toc-right-join" class="nav-link" data-scroll-target="#right-join"><span class="toc-section-number">8.2.2.3</span>  right join</a></li>
  <li><a href="#outer-join" id="toc-outer-join" class="nav-link" data-scroll-target="#outer-join"><span class="toc-section-number">8.2.2.4</span>  outer join</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#concatenating-datasets" id="toc-concatenating-datasets" class="nav-link" data-scroll-target="#concatenating-datasets"><span class="toc-section-number">8.3</span>  Concatenating datasets</a>
  <ul>
  <li><a href="#practice-exercise-4" id="toc-practice-exercise-4" class="nav-link" data-scroll-target="#practice-exercise-4"><span class="toc-section-number">8.3.1</span>  Practice exercise 4</a></li>
  </ul></li>
  <li><a href="#reshaping-data-1" id="toc-reshaping-data-1" class="nav-link" data-scroll-target="#reshaping-data-1"><span class="toc-section-number">8.4</span>  Reshaping data</a>
  <ul>
  <li><a href="#pivoting-long-to-wide-format" id="toc-pivoting-long-to-wide-format" class="nav-link" data-scroll-target="#pivoting-long-to-wide-format"><span class="toc-section-number">8.4.1</span>  Pivoting “long” to “wide” format</a></li>
  <li><a href="#pivoting-wide-to-long-format" id="toc-pivoting-wide-to-long-format" class="nav-link" data-scroll-target="#pivoting-wide-to-long-format"><span class="toc-section-number">8.4.2</span>  Pivoting “wide” to “long” format</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data wrangling</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Data wrangling refers to combining, transforming, and re-arranging data to make it suitable for further analysis. We’ll use Pandas for all data wrangling operations.</p>
<div class="cell" data-execution_count="374">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="hierarchical-indexing" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="hierarchical-indexing"><span class="header-section-number">8.1</span> Hierarchical indexing</h2>
<p>Until now we have seen only a single level of indexing in the rows and columns of a Pandas DataFrame. Hierarchical indexing refers to having multiple index levels on an axis (row / column) of a Pandas DataFrame. It helps us to work with a higher dimensional data in a lower dimensional form.</p>
<section id="hierarchical-indexing-in-pandas-series" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="hierarchical-indexing-in-pandas-series"><span class="header-section-number">8.1.1</span> Hierarchical indexing in Pandas Series</h3>
<p>Let use define Pandas Series as we defined in Chapter 5:</p>
<div class="cell" data-execution_count="375">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining a Pandas Series</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>series_example <span class="op">=</span> pd.Series([<span class="st">'these'</span>,<span class="st">'are'</span>,<span class="st">'english'</span>,<span class="st">'words'</span>,<span class="st">'estas'</span>,<span class="st">'son'</span>,<span class="st">'palabras'</span>,<span class="st">'en'</span>,<span class="st">'español'</span>,</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">'ce'</span>,<span class="st">'sont'</span>,<span class="st">'des'</span>,<span class="st">'françai'</span>,<span class="st">'mots'</span>])</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>series_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="375">
<pre><code>0        these
1          are
2      english
3        words
4        estas
5          son
6     palabras
7           en
8      español
9           ce
10        sont
11         des
12     françai
13        mots
dtype: object</code></pre>
</div>
</div>
<p>Let us use the attribute <code>nlevels</code> to find the number of levels of the row indices of this Series:</p>
<div class="cell" data-execution_count="376">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>series_example.index.nlevels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="376">
<pre><code>1</code></pre>
</div>
</div>
<p>The Series <code>series_example</code> has only one level of row indices.</p>
<p>Let us introduce another level of row indices while defining the Series:</p>
<div class="cell" data-execution_count="377">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining a Pandas Series with multiple levels of row indices</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>series_example <span class="op">=</span> pd.Series([<span class="st">'these'</span>,<span class="st">'are'</span>,<span class="st">'english'</span>,<span class="st">'words'</span>,<span class="st">'estas'</span>,<span class="st">'son'</span>,<span class="st">'palabras'</span>,<span class="st">'en'</span>,<span class="st">'español'</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                           <span class="st">'ce'</span>,<span class="st">'sont'</span>,<span class="st">'des'</span>,<span class="st">'françai'</span>,<span class="st">'mots'</span>], </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                          index<span class="op">=</span>[[<span class="st">'English'</span>]<span class="op">*</span><span class="dv">4</span><span class="op">+</span>[<span class="st">'Spanish'</span>]<span class="op">*</span><span class="dv">5</span><span class="op">+</span>[<span class="st">'French'</span>]<span class="op">*</span><span class="dv">5</span>,<span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">5</span>))<span class="op">+</span><span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">6</span>))<span class="op">*</span><span class="dv">2</span>])</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>series_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="377">
<pre><code>English  1       these
         2         are
         3     english
         4       words
Spanish  1       estas
         2         son
         3    palabras
         4          en
         5     español
French   1          ce
         2        sont
         3         des
         4     françai
         5        mots
dtype: object</code></pre>
</div>
</div>
<p>In the above Series, there are two levels of row indices:</p>
<div class="cell" data-execution_count="378">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>series_example.index.nlevels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="378">
<pre><code>2</code></pre>
</div>
</div>
</section>
<section id="hierarchical-indexing-in-pandas-dataframe" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="hierarchical-indexing-in-pandas-dataframe"><span class="header-section-number">8.1.2</span> Hierarchical indexing in Pandas DataFrame</h3>
<p>In a Pandas DataFrame, both the row and the columns can have hierarchical indexing. For example, consider the DataFrame below:</p>
<div class="cell" data-execution_count="379">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span>np.array([[<span class="dv">771517</span>,<span class="dv">2697000</span>,<span class="dv">815201</span>,<span class="dv">3849000</span>],[<span class="fl">4.2</span>,<span class="fl">5.6</span>,<span class="fl">2.8</span>,<span class="fl">4.6</span>],</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>             [<span class="fl">7.8</span>,<span class="fl">234.5</span>,<span class="fl">46.9</span>,<span class="dv">502</span>],[<span class="dv">6749</span>, <span class="dv">597</span>, <span class="dv">52</span>, <span class="dv">305</span>]])</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df_example <span class="op">=</span> pd.DataFrame(data,index <span class="op">=</span> [[<span class="st">'Demographics'</span>]<span class="op">*</span><span class="dv">2</span><span class="op">+</span>[<span class="st">'Geography'</span>]<span class="op">*</span><span class="dv">2</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                                      [<span class="st">'Population'</span>,<span class="st">'Unemployement (%)'</span>,<span class="st">'Area (mile-sq)'</span>,<span class="st">'Elevation (feet)'</span>]],</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>                    columns <span class="op">=</span> [[<span class="st">'Illinois'</span>]<span class="op">*</span><span class="dv">2</span><span class="op">+</span>[<span class="st">'California'</span>]<span class="op">*</span><span class="dv">2</span>,[<span class="st">'Evanston'</span>,<span class="st">'Chicago'</span>,<span class="st">'San Francisco'</span>,<span class="st">'Los Angeles'</span>]])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>df_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="379">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="2" halign="left">Illinois</th>
      <th colspan="2" halign="left">California</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>Evanston</th>
      <th>Chicago</th>
      <th>San Francisco</th>
      <th>Los Angeles</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Demographics</th>
      <th>Population</th>
      <td>771517.0</td>
      <td>2697000.0</td>
      <td>815201.0</td>
      <td>3849000.0</td>
    </tr>
    <tr>
      <th>Unemployement (%)</th>
      <td>4.2</td>
      <td>5.6</td>
      <td>2.8</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Geography</th>
      <th>Area (mile-sq)</th>
      <td>7.8</td>
      <td>234.5</td>
      <td>46.9</td>
      <td>502.0</td>
    </tr>
    <tr>
      <th>Elevation (feet)</th>
      <td>6749.0</td>
      <td>597.0</td>
      <td>52.0</td>
      <td>305.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>In the above DataFrame, both the rows and columns have 2 levels of indexing. The number of levels of column indices can be found using the attribute <code>nlevels</code>:</p>
<div class="cell" data-execution_count="380">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_example.columns.nlevels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="380">
<pre><code>2</code></pre>
</div>
</div>
<p>The <code>columns</code> attribute will now have a <em>MultiIndex</em> datatype in contrast to the <em>Index</em> datatype with single level of indexing. The same holds for row indices.</p>
<div class="cell" data-execution_count="381">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(df_example.columns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="381">
<pre><code>pandas.core.indexes.multi.MultiIndex</code></pre>
</div>
</div>
<div class="cell" data-execution_count="382">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df_example.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="382">
<pre><code>MultiIndex([(  'Illinois',      'Evanston'),
            (  'Illinois',       'Chicago'),
            ('California', 'San Francisco'),
            ('California',   'Los Angeles')],
           )</code></pre>
</div>
</div>
<p>The hierarchical levels can have names. Let us assign names to the each level of the row and column labels:</p>
<div class="cell" data-execution_count="383">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Naming the row indices levels</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_example.index.names<span class="op">=</span>[<span class="st">'Information type'</span>, <span class="st">'Statistic'</span>]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Naming the column indices levels</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>df_example.columns.names<span class="op">=</span>[<span class="st">'State'</span>, <span class="st">'City'</span>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Viewing the DataFrame</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>df_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="383">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State</th>
      <th colspan="2" halign="left">Illinois</th>
      <th colspan="2" halign="left">California</th>
    </tr>
    <tr>
      <th></th>
      <th>City</th>
      <th>Evanston</th>
      <th>Chicago</th>
      <th>San Francisco</th>
      <th>Los Angeles</th>
    </tr>
    <tr>
      <th>Information type</th>
      <th>Statistic</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Demographics</th>
      <th>Population</th>
      <td>771517.0</td>
      <td>2697000.0</td>
      <td>815201.0</td>
      <td>3849000.0</td>
    </tr>
    <tr>
      <th>Unemployement (%)</th>
      <td>4.2</td>
      <td>5.6</td>
      <td>2.8</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Geography</th>
      <th>Area (mile-sq)</th>
      <td>7.8</td>
      <td>234.5</td>
      <td>46.9</td>
      <td>502.0</td>
    </tr>
    <tr>
      <th>Elevation (feet)</th>
      <td>6749.0</td>
      <td>597.0</td>
      <td>52.0</td>
      <td>305.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Observe that the names of the row and column labels appear when we view the DataFrame.</p>
<section id="get_level_values" class="level4" data-number="8.1.2.1">
<h4 data-number="8.1.2.1" class="anchored" data-anchor-id="get_level_values"><span class="header-section-number">8.1.2.1</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.Index.get_level_values.html"><code>get_level_values()</code></a></h4>
<p>The names of the column levels can be obained using the function <code>get_level_values()</code>. The outer-most level corresponds to the <em>level = 0</em>, and it increses as we go to the inner levels.</p>
<div class="cell" data-execution_count="384">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Column levels at level 0 (the outer level)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df_example.columns.get_level_values(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="384">
<pre><code>Index(['Illinois', 'Illinois', 'California', 'California'], dtype='object', name='State')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="385">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Column levels at level 1 (the inner level)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df_example.columns.get_level_values(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="385">
<pre><code>Index(['Evanston', 'Chicago', 'San Francisco', 'Los Angeles'], dtype='object', name='City')</code></pre>
</div>
</div>
</section>
</section>
<section id="subsetting-data" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="subsetting-data"><span class="header-section-number">8.1.3</span> Subsetting data</h3>
<p>We can use the indices at the outer levels to concisely subset a Series / DataFrame.</p>
<p>The first four observations of the Series <code>series_example</code> correspond to the outer row index <code>English</code>, while the last 5 rows correspond to the outer row index <code>Spanish</code>. Let us subset all the observation corresponding to the outer row index <code>English</code>:</p>
<div class="cell" data-execution_count="386">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting data by row-index</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>series_example[<span class="st">'English'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="386">
<pre><code>1      these
2        are
3    english
4      words
dtype: object</code></pre>
</div>
</div>
<p>Just like in the case of single level indices, if we wish to subset corresponding to multiple outer-level indices, we put the indices within an additional box bracket <code>[]</code>. For example, let us subset all the observations corresponding to the row-indices <code>English</code> and <code>French</code>:</p>
<div class="cell" data-execution_count="387">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting data by multiple row-indices</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>series_example[[<span class="st">'English'</span>,<span class="st">'French'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="387">
<pre><code>English  1      these
         2        are
         3    english
         4      words
French   1         ce
         2       sont
         3        des
         4    françai
         5       mots
dtype: object</code></pre>
</div>
</div>
<p>We can also subset data using the inner row index. However, we will need to put a <code>:</code> sign to indicate that the row label at the inner level is being used.</p>
<div class="cell" data-execution_count="392">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting data by row-index</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>series_example[:,<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="392">
<pre><code>English     are
Spanish     son
French     sont
dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="404">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting data by multiple row-indices</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>series_example.loc[:,[<span class="dv">1</span>,<span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="404">
<pre><code>English  1    these
Spanish  1    estas
French   1       ce
English  2      are
Spanish  2      son
French   2     sont
dtype: object</code></pre>
</div>
</div>
<p>As in Series, we can concisely subset rows / columns in a DataFrame based on the index at the outer levels.</p>
<div class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df_example[<span class="st">'Illinois'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>Evanston</th>
      <th>Chicago</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Demographics</th>
      <th>Population</th>
      <td>771517.0</td>
      <td>2697000.0</td>
    </tr>
    <tr>
      <th>Unemployement (%)</th>
      <td>4.2</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Geography</th>
      <th>Area (mile-sq)</th>
      <td>7.8</td>
      <td>234.5</td>
    </tr>
    <tr>
      <th>Elevation (feet)</th>
      <td>6749.0</td>
      <td>597.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that the dataype of each column name is a tuple. For example, let us find the datatype of the <span class="math inline">\(1^{st}\)</span> column name:</p>
<div class="cell" data-execution_count="223">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First column name</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df_example.columns[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="223">
<pre><code>('Illinois', 'Evanston')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="220">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Datatype of first column name</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(df_example.columns[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="220">
<pre><code>tuple</code></pre>
</div>
</div>
<p>Thus columns at the inner levels can be accessed by specifying the name as a tuple. For example, let us subset the column <code>Evanston</code>:</p>
<div class="cell" data-execution_count="225">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting the column 'Evanston'</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df_example[(<span class="st">'Illinois'</span>,<span class="st">'Evanston'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="225">
<pre><code>Information type  Statistic        
Demographics      Population           771517.0
                  Unemployement (%)         4.2
Geography         Area (mile-sq)            7.8
                  Elevation (feet)       6749.0
Name: (Illinois, Evanston), dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="254">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting the columns 'Evanston' and 'Chicago' of the outer column level 'Illinois'</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df_example.loc[:,(<span class="st">'Illinois'</span>,[<span class="st">'Evanston'</span>,<span class="st">'Chicago'</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="254">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>State</th>
      <th colspan="2" halign="left">Illinois</th>
    </tr>
    <tr>
      <th></th>
      <th>City</th>
      <th>Evanston</th>
      <th>Chicago</th>
    </tr>
    <tr>
      <th>Information type</th>
      <th>Statistic</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Demographics</th>
      <th>Population</th>
      <td>771517.0</td>
      <td>2697000.0</td>
    </tr>
    <tr>
      <th>Unemployement (%)</th>
      <td>4.2</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Geography</th>
      <th>Area (mile-sq)</th>
      <td>7.8</td>
      <td>234.5</td>
    </tr>
    <tr>
      <th>Elevation (feet)</th>
      <td>6749.0</td>
      <td>597.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="practice-exercise-1" class="level3" data-number="8.1.4">
<h3 data-number="8.1.4" class="anchored" data-anchor-id="practice-exercise-1"><span class="header-section-number">8.1.4</span> Practice exercise 1</h3>
<p>Read the table consisting of GDP per capita of countries from the webpage: https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)_per_capita .</p>
<p>To only read the relevant table, read the tables that contain the word <em>‘Country’</em>.</p>
<section id="section" class="level4" data-number="8.1.4.1">
<h4 data-number="8.1.4.1" class="anchored" data-anchor-id="section"><span class="header-section-number">8.1.4.1</span> </h4>
<p>How many levels of indexing are there in the rows and columns?</p>
</section>
<section id="section-1" class="level4" data-number="8.1.4.2">
<h4 data-number="8.1.4.2" class="anchored" data-anchor-id="section-1"><span class="header-section-number">8.1.4.2</span> </h4>
<p>Subset a DataFrame that select the country, and the United Nations estimates of GDP per capita with the corresponding year.</p>
</section>
<section id="section-2" class="level4" data-number="8.1.4.3">
<h4 data-number="8.1.4.3" class="anchored" data-anchor-id="section-2"><span class="header-section-number">8.1.4.3</span> </h4>
<p>Subset a DataFrame that select only the World Bank and United Nations estimates of GDP per capita without the corresponding year or country.</p>
</section>
<section id="section-3" class="level4" data-number="8.1.4.4">
<h4 data-number="8.1.4.4" class="anchored" data-anchor-id="section-3"><span class="header-section-number">8.1.4.4</span> </h4>
<p>Subset a DataFrame that select the country and only the World Bank and United Nations estimates of GDP per capita without the corresponding year or country.</p>
</section>
<section id="section-4" class="level4" data-number="8.1.4.5">
<h4 data-number="8.1.4.5" class="anchored" data-anchor-id="section-4"><span class="header-section-number">8.1.4.5</span> </h4>
<p>Drop all columns consisting of years. Use the <code>level</code> argument of the <code>drop()</code> method.</p>
</section>
<section id="section-5" class="level4" data-number="8.1.4.6">
<h4 data-number="8.1.4.6" class="anchored" data-anchor-id="section-5"><span class="header-section-number">8.1.4.6</span> </h4>
<p>In the dataset obtained above, drop the outer level of the column labels. Use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.droplevel.html"><code>droplevel()</code></a> method.</p>
</section>
</section>
<section id="practice-exercise-2" class="level3" data-number="8.1.5">
<h3 data-number="8.1.5" class="anchored" data-anchor-id="practice-exercise-2"><span class="header-section-number">8.1.5</span> Practice exercise 2</h3>
<p>Recall problem <a href="https://nustat.github.io/DataScience_Intro_python/Assignment%203%20(Pandas).html#e-1">2(e)</a> from assignment 3 on Pandas, where we needed to find the African country that is the closest to country <span class="math inline">\(G\)</span> (Luxembourg) with regard to social indicators.</p>
<p>We will solve the question with the regular way in which we use single level of indexing (as you probably did during this assignment), and see if it is easier to do with hierarchical indexing.</p>
<p>Execute the code below that we used to pre-process data to make it suitable for answering this question.</p>
<div class="cell" data-execution_count="346">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pre-processing data - execute this code</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>social_indicator <span class="op">=</span> pd.read_csv(<span class="st">"./Datasets/social_indicator.txt"</span>,sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>,index_col <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>social_indicator.geographic_location <span class="op">=</span> social_indicator.geographic_location.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">'Asia'</span> <span class="cf">if</span> <span class="st">'Asia'</span> <span class="kw">in</span> x <span class="cf">else</span> <span class="st">'Europe'</span> <span class="cf">if</span> <span class="st">'Europe'</span> <span class="kw">in</span> x <span class="cf">else</span> <span class="st">'Africa'</span> <span class="cf">if</span> <span class="st">'Africa'</span> <span class="kw">in</span> x <span class="cf">else</span> x)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>social_indicator.rename(columns<span class="op">=</span>{<span class="st">'geographic_location'</span>:<span class="st">'continent'</span>},inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>social_indicator <span class="op">=</span> social_indicator.sort_index(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>social_indicator.drop(columns<span class="op">=</span>[<span class="st">'region'</span>,<span class="st">'contraception'</span>],inplace<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Below is the code to find the African country that is the closest to country <span class="math inline">\(G\)</span> (Luxembourg) using single level of indexing. Your code in the assignment is probably similar to the one below:</p>
<div class="cell" data-execution_count="344">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the index of the country G (Luxembourg) that has the maximum GDP per capita</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>country_max_gdp_position <span class="op">=</span> social_indicator.gdpPerCapita.argmax()</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Scaling the social indicator dataset</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>social_indicator_scaled <span class="op">=</span> social_indicator.iloc[:,<span class="dv">2</span>:].<span class="bu">apply</span>(<span class="kw">lambda</span> x: (x<span class="op">-</span>x.mean())<span class="op">/</span>(x.std()))</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Computing the manhattan distances of all countries from country G (Luxembourg)</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>manhattan_distances <span class="op">=</span> (social_indicator_scaled<span class="op">-</span>social_indicator_scaled.iloc[country_max_gdp_position,:]).<span class="bu">abs</span>().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the indices of African countries</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>african_countries_indices <span class="op">=</span> social_indicator.loc[social_indicator.continent<span class="op">==</span><span class="st">'Africa'</span>,:].index</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering the manhattan distances of African countries from country G (Luxembourg)</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>manhattan_distances_African <span class="op">=</span> manhattan_distances[african_countries_indices]</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the country among African countries that has the least Manhattan distance to country G (Luxembourg)</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>social_indicator.loc[manhattan_distances_African.idxmin(),<span class="st">'country'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="344">
<pre><code>'Reunion'</code></pre>
</div>
</div>
<section id="section-6" class="level4" data-number="8.1.5.1">
<h4 data-number="8.1.5.1" class="anchored" data-anchor-id="section-6"><span class="header-section-number">8.1.5.1</span> </h4>
<p>Use the method <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.set_index.html"><code>set_index()</code></a> to set <code>continent</code> and <code>country</code> as hierarchical indices of rows. Find the African country that is the closest to country <span class="math inline">\(G\)</span> (Luxembourg) using this hierarchically indexed data. How many lines will be eliminated from the code above? Which lines will be eliminated?</p>
<p><strong>Hint:</strong> Since <code>continent</code> and <code>country</code> are row indices, you don’t need to explicitly find:</p>
<ol type="1">
<li><p>The row index of country <span class="math inline">\(G\)</span> (Luxembourg),</p></li>
<li><p>The row indices of African countries.</p></li>
<li><p>The Manhattan distances for African countries.</p></li>
</ol>
</section>
<section id="section-7" class="level4" data-number="8.1.5.2">
<h4 data-number="8.1.5.2" class="anchored" data-anchor-id="section-7"><span class="header-section-number">8.1.5.2</span> </h4>
<p>Use the Pandas DataFrame method <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mean.html"><code>mean()</code></a> with the <em>level</em> argument to find the mean value of all social indicators for each continent.</p>
<div class="cell" data-execution_count="350">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>social_indicator.mean(level<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="350">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>economicActivityFemale</th>
      <th>economicActivityMale</th>
      <th>gdpPerCapita</th>
      <th>illiteracyFemale</th>
      <th>illiteracyMale</th>
      <th>infantMortality</th>
      <th>lifeFemale</th>
      <th>lifeMale</th>
      <th>totalfertilityrate</th>
    </tr>
    <tr>
      <th>continent</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Asia</th>
      <td>41.592683</td>
      <td>79.282927</td>
      <td>27796.390244</td>
      <td>23.635951</td>
      <td>13.780878</td>
      <td>39.853659</td>
      <td>70.724390</td>
      <td>66.575610</td>
      <td>3.482927</td>
    </tr>
    <tr>
      <th>Africa</th>
      <td>46.732258</td>
      <td>79.445161</td>
      <td>7127.483871</td>
      <td>52.907226</td>
      <td>33.673548</td>
      <td>77.967742</td>
      <td>56.841935</td>
      <td>53.367742</td>
      <td>4.889677</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>51.280000</td>
      <td>77.953333</td>
      <td>14525.666667</td>
      <td>9.666667</td>
      <td>6.585200</td>
      <td>23.666667</td>
      <td>72.406667</td>
      <td>67.813333</td>
      <td>3.509333</td>
    </tr>
    <tr>
      <th>North America</th>
      <td>45.238095</td>
      <td>77.166667</td>
      <td>18609.047619</td>
      <td>17.390286</td>
      <td>14.609905</td>
      <td>22.904762</td>
      <td>75.457143</td>
      <td>70.161905</td>
      <td>2.804286</td>
    </tr>
    <tr>
      <th>South America</th>
      <td>42.008333</td>
      <td>75.575000</td>
      <td>15925.916667</td>
      <td>9.991667</td>
      <td>6.750000</td>
      <td>34.750000</td>
      <td>72.691667</td>
      <td>66.975000</td>
      <td>2.872500</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>52.060000</td>
      <td>70.291429</td>
      <td>45438.200000</td>
      <td>2.308343</td>
      <td>1.413543</td>
      <td>10.571429</td>
      <td>77.757143</td>
      <td>70.374286</td>
      <td>1.581714</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
<section id="practice-exercise-3" class="level3" data-number="8.1.6">
<h3 data-number="8.1.6" class="anchored" data-anchor-id="practice-exercise-3"><span class="header-section-number">8.1.6</span> Practice exercise 3</h3>
<p>Let us try to find the areas where NU students lack in diversity. Read <em>survey_data_clean.csv</em>. Use hierarchical indexing to classify the columns as follows:</p>
<p>Classify the following variables as <em>lifestyle</em>:</p>
<div class="cell" data-execution_count="213">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>lifestyle <span class="op">=</span> [<span class="st">'fav_alcohol'</span>, <span class="st">'parties_per_month'</span>, <span class="st">'smoke'</span>, <span class="st">'weed'</span>,<span class="st">'streaming_platforms'</span>, <span class="st">'minutes_ex_per_week'</span>,</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'sleep_hours_per_day'</span>, <span class="st">'internet_hours_per_day'</span>, <span class="st">'procrastinator'</span>, <span class="st">'num_clubs'</span>,<span class="st">'student_athlete'</span>,<span class="st">'social_media'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Classify the following variables as <em>personality</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>personality <span class="op">=</span> [<span class="st">'introvert_extrovert'</span>, <span class="st">'left_right_brained'</span>, <span class="st">'personality_type'</span>, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'num_insta_followers'</span>, <span class="st">'fav_sport'</span>,<span class="st">'learning_style'</span>,<span class="st">'dominant_hand'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Classify the following variables as <em>opinion</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>opinion <span class="op">=</span> [<span class="st">'love_first_sight'</span>, <span class="st">'expected_marriage_age'</span>,  <span class="st">'expected_starting_salary'</span>, <span class="st">'how_happy'</span>, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'fav_number'</span>, <span class="st">'fav_letter'</span>, <span class="st">'fav_season'</span>,   <span class="st">'political_affliation'</span>, <span class="st">'cant_change_math_ability'</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'can_change_math_ability'</span>, <span class="st">'math_is_genetic'</span>, <span class="st">'much_effort_is_lack_of_talent'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Classify the following variables as <em>academic information</em>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>academic_info <span class="op">=</span> [<span class="st">'major'</span>, <span class="st">'num_majors_minors'</span>,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'high_school_GPA'</span>, <span class="st">'NU_GPA'</span>, <span class="st">'school_year'</span>,<span class="st">'AP_stats'</span>, <span class="st">'used_python_before'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Classify the following variables as <em>demographics</em>:</p>
<div class="cell" data-execution_count="214">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>demographics <span class="op">=</span> [ <span class="st">'only_child'</span>,<span class="st">'birth_month'</span>, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>       <span class="st">'living_location_on_campus'</span>, <span class="st">'age'</span>, <span class="st">'height'</span>, <span class="st">'height_father'</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>       <span class="st">'height_mother'</span>,  <span class="st">'childhood_in_US'</span>, <span class="st">'gender'</span>, <span class="st">'region_of_residence'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Write a function that finds the number of variables having outliers in a dataset. Apply the function on each of the 5 categories of variables in the dataset. Our hypothesis is that the category that has the maximum number of variables with outliers has the least amount of diversity.</p>
</section>
<section id="reshaping-data" class="level3" data-number="8.1.7">
<h3 data-number="8.1.7" class="anchored" data-anchor-id="reshaping-data"><span class="header-section-number">8.1.7</span> Reshaping data</h3>
<p>Apart from ease in subsetting data, hierarchical indexing also plays a role in reshaping data.</p>
<section id="unstack-pandas-series-method" class="level4" data-number="8.1.7.1">
<h4 data-number="8.1.7.1" class="anchored" data-anchor-id="unstack-pandas-series-method"><span class="header-section-number">8.1.7.1</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.unstack.html"><code>unstack()</code></a> (Pandas Series method)</h4>
<p>The Pandas Series method <code>unstack()</code> pivots the desired level of row indices to columns, thereby creating a DataFrame. By default, the inner-most level of the row labels is pivoed.</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pivoting the inner-most Series row index to column labels</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>series_example_unstack <span class="op">=</span> series_example.unstack()</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>series_example_unstack</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>English</th>
      <td>these</td>
      <td>are</td>
      <td>english</td>
      <td>words</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>French</th>
      <td>ce</td>
      <td>sont</td>
      <td>des</td>
      <td>françai</td>
      <td>mots</td>
    </tr>
    <tr>
      <th>Spanish</th>
      <td>estas</td>
      <td>son</td>
      <td>palabras</td>
      <td>en</td>
      <td>español</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We can pivot the outer level of the row labels by specifying it in the <code>level</code> argument:</p>
<div class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pivoting the outer row indices to column labels</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>series_example_unstack <span class="op">=</span> series_example.unstack(level<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>series_example_unstack</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="192">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>English</th>
      <th>French</th>
      <th>Spanish</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>these</td>
      <td>ce</td>
      <td>estas</td>
    </tr>
    <tr>
      <th>2</th>
      <td>are</td>
      <td>sont</td>
      <td>son</td>
    </tr>
    <tr>
      <th>3</th>
      <td>english</td>
      <td>des</td>
      <td>palabras</td>
    </tr>
    <tr>
      <th>4</th>
      <td>words</td>
      <td>françai</td>
      <td>en</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>mots</td>
      <td>español</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="unstack-pandas-dataframe-method" class="level4" data-number="8.1.7.2">
<h4 data-number="8.1.7.2" class="anchored" data-anchor-id="unstack-pandas-dataframe-method"><span class="header-section-number">8.1.7.2</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.unstack.html"><code>unstack()</code></a> (Pandas DataFrame method)</h4>
<p>The Pandas DataFrame method <code>unstack()</code> pivots the specifid level of row indices to the new innemost level of column labels. By-default, the inner-most level of the row labels is pivoted.</p>
<div class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pivoting the inner level of row labels to the inner-most level of column labels</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>df_example.unstack()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="181">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>State</th>
      <th colspan="8" halign="left">Illinois</th>
      <th colspan="8" halign="left">California</th>
    </tr>
    <tr>
      <th>City</th>
      <th colspan="4" halign="left">Evanston</th>
      <th colspan="4" halign="left">Chicago</th>
      <th colspan="4" halign="left">San Francisco</th>
      <th colspan="4" halign="left">Los Angeles</th>
    </tr>
    <tr>
      <th>Statistic</th>
      <th>Area (mile-sq)</th>
      <th>Elevation (feet)</th>
      <th>Population</th>
      <th>Unemployement (%)</th>
      <th>Area (mile-sq)</th>
      <th>Elevation (feet)</th>
      <th>Population</th>
      <th>Unemployement (%)</th>
      <th>Area (mile-sq)</th>
      <th>Elevation (feet)</th>
      <th>Population</th>
      <th>Unemployement (%)</th>
      <th>Area (mile-sq)</th>
      <th>Elevation (feet)</th>
      <th>Population</th>
      <th>Unemployement (%)</th>
    </tr>
    <tr>
      <th>Information type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Demographics</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>771517.0</td>
      <td>4.2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2697000.0</td>
      <td>5.6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>815201.0</td>
      <td>2.8</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3849000.0</td>
      <td>4.6</td>
    </tr>
    <tr>
      <th>Geography</th>
      <td>7.8</td>
      <td>6749.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>234.5</td>
      <td>597.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>46.9</td>
      <td>52.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>502.0</td>
      <td>305.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>As with Series, we can pivot the outer level of the row labels by specifying it in the <code>level</code> argument:</p>
<div class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Pivoting the outer level (level = 0) of row labels to the inner-most level of column labels</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df_example.unstack(level<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="188">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>State</th>
      <th colspan="4" halign="left">Illinois</th>
      <th colspan="4" halign="left">California</th>
    </tr>
    <tr>
      <th>City</th>
      <th colspan="2" halign="left">Evanston</th>
      <th colspan="2" halign="left">Chicago</th>
      <th colspan="2" halign="left">San Francisco</th>
      <th colspan="2" halign="left">Los Angeles</th>
    </tr>
    <tr>
      <th>Information type</th>
      <th>Demographics</th>
      <th>Geography</th>
      <th>Demographics</th>
      <th>Geography</th>
      <th>Demographics</th>
      <th>Geography</th>
      <th>Demographics</th>
      <th>Geography</th>
    </tr>
    <tr>
      <th>Statistic</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Area (mile-sq)</th>
      <td>NaN</td>
      <td>7.8</td>
      <td>NaN</td>
      <td>234.5</td>
      <td>NaN</td>
      <td>46.9</td>
      <td>NaN</td>
      <td>502.0</td>
    </tr>
    <tr>
      <th>Elevation (feet)</th>
      <td>NaN</td>
      <td>6749.0</td>
      <td>NaN</td>
      <td>597.0</td>
      <td>NaN</td>
      <td>52.0</td>
      <td>NaN</td>
      <td>305.0</td>
    </tr>
    <tr>
      <th>Population</th>
      <td>771517.0</td>
      <td>NaN</td>
      <td>2697000.0</td>
      <td>NaN</td>
      <td>815201.0</td>
      <td>NaN</td>
      <td>3849000.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>Unemployement (%)</th>
      <td>4.2</td>
      <td>NaN</td>
      <td>5.6</td>
      <td>NaN</td>
      <td>2.8</td>
      <td>NaN</td>
      <td>4.6</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="stack" class="level4" data-number="8.1.7.3">
<h4 data-number="8.1.7.3" class="anchored" data-anchor-id="stack"><span class="header-section-number">8.1.7.3</span> <code>stack()</code></h4>
<p>The inverse of <code>unstack()</code> is the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.stack.html"><code>stack()</code></a> method, which creates the inner-most level of row indices by pivoting the column labels of the prescribed level.</p>
<p>Note that if the column labels have only one level, so we don’t need to specify a level.</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Stacking the columns of a DataFrame</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>series_example_unstack.stack()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>English  1       these
         2         are
         3     english
         4       words
French   1          ce
         2        sont
         3         des
         4     françai
         5        mots
Spanish  1       estas
         2         son
         3    palabras
         4          en
         5     español
dtype: object</code></pre>
</div>
</div>
<p>However, if the columns have multiple levels, we can specify the level to stack as the inner-most row level. By default, inner-most column level is stacked.</p>
<div class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Stacking the inner-most column labels inner-most row indices</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>df_example.stack()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="195">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>State</th>
      <th>California</th>
      <th>Illinois</th>
    </tr>
    <tr>
      <th>Information type</th>
      <th>Statistic</th>
      <th>City</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">Demographics</th>
      <th rowspan="4" valign="top">Population</th>
      <th>Chicago</th>
      <td>NaN</td>
      <td>2697000.0</td>
    </tr>
    <tr>
      <th>Evanston</th>
      <td>NaN</td>
      <td>771517.0</td>
    </tr>
    <tr>
      <th>Los Angeles</th>
      <td>3849000.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>San Francisco</th>
      <td>815201.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Unemployement (%)</th>
      <th>Chicago</th>
      <td>NaN</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>Evanston</th>
      <td>NaN</td>
      <td>4.2</td>
    </tr>
    <tr>
      <th>Los Angeles</th>
      <td>4.6</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>San Francisco</th>
      <td>2.8</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">Geography</th>
      <th rowspan="4" valign="top">Area (mile-sq)</th>
      <th>Chicago</th>
      <td>NaN</td>
      <td>234.5</td>
    </tr>
    <tr>
      <th>Evanston</th>
      <td>NaN</td>
      <td>7.8</td>
    </tr>
    <tr>
      <th>Los Angeles</th>
      <td>502.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>San Francisco</th>
      <td>46.9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Elevation (feet)</th>
      <th>Chicago</th>
      <td>NaN</td>
      <td>597.0</td>
    </tr>
    <tr>
      <th>Evanston</th>
      <td>NaN</td>
      <td>6749.0</td>
    </tr>
    <tr>
      <th>Los Angeles</th>
      <td>305.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>San Francisco</th>
      <td>52.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Stacking the outer column labels inner-most row indices</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df_example.stack(level<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="196">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>City</th>
      <th>Chicago</th>
      <th>Evanston</th>
      <th>Los Angeles</th>
      <th>San Francisco</th>
    </tr>
    <tr>
      <th>Information type</th>
      <th>Statistic</th>
      <th>State</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">Demographics</th>
      <th rowspan="2" valign="top">Population</th>
      <th>California</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>3849000.0</td>
      <td>815201.0</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>2697000.0</td>
      <td>771517.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Unemployement (%)</th>
      <th>California</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.6</td>
      <td>2.8</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>5.6</td>
      <td>4.2</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Geography</th>
      <th rowspan="2" valign="top">Area (mile-sq)</th>
      <th>California</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>502.0</td>
      <td>46.9</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>234.5</td>
      <td>7.8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Elevation (feet)</th>
      <th>California</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>305.0</td>
      <td>52.0</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>597.0</td>
      <td>6749.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="merging-data" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="merging-data"><span class="header-section-number">8.2</span> Merging data</h2>
<p>The Pandas DataFrame method <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.merge.html">merge()</a> uses columns defined as <em>key</em> column(s) to merge two datasets. In case the <em>key</em> column(s) are not defined, the overlapping column(s) are considered as the <em>key</em> columns.</p>
<section id="join-types" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="join-types"><span class="header-section-number">8.2.1</span> Join types</h3>
<ol type="i">
<li>One-to-one, (ii) Many-to-one, (iii) One-to-Many, and (iv) Many-to-many</li>
</ol>
<div class="cell" data-execution_count="351">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/student_one.csv'</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/skills_one.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="one-to-one-join" class="level4" data-number="8.2.1.1">
<h4 data-number="8.2.1.1" class="anchored" data-anchor-id="one-to-one-join"><span class="header-section-number">8.2.1.1</span> One-to-one join</h4>
<p>Each row in one table is linked (or related) to a single row in another table using the key column(s).</p>
<div class="cell" data-execution_count="352">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>data1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="352">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jax</td>
      <td>Computer Science</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sonya</td>
      <td>Material Science</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Johnny</td>
      <td>Music</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="353">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>data2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="353">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Material Science</td>
      <td>Structure prediction</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Music</td>
      <td>Opera</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="354">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>pd.merge(data1,data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="354">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sonya</td>
      <td>Material Science</td>
      <td>Structure prediction</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Johnny</td>
      <td>Music</td>
      <td>Opera</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="many-to-one-join" class="level4" data-number="8.2.1.2">
<h4 data-number="8.2.1.2" class="anchored" data-anchor-id="many-to-one-join"><span class="header-section-number">8.2.1.2</span> Many-to-one join</h4>
<p>One or more rows in one table is linked (or related) to a single row in another table using the key column(s).</p>
<div class="cell" data-execution_count="380">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> pd.read_csv(<span class="st">'student_many.csv'</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> pd.read_csv(<span class="st">'skills_one.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="381">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>data1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="381">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kitana</td>
      <td>Computer Science</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jax</td>
      <td>Computer Science</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sonya</td>
      <td>Material Science</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Johnny</td>
      <td>Music</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Johnny</td>
      <td>Statistics</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="382">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>data2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="382">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Material Science</td>
      <td>Structure prediction</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Music</td>
      <td>Opera</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="383">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>pd.merge(data1,data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="383">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Johnny</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kitana</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sonya</td>
      <td>Material Science</td>
      <td>Structure prediction</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Johnny</td>
      <td>Music</td>
      <td>Opera</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="one-to-many-join" class="level4" data-number="8.2.1.3">
<h4 data-number="8.2.1.3" class="anchored" data-anchor-id="one-to-many-join"><span class="header-section-number">8.2.1.3</span> One-to-many join</h4>
<p>Each row in one table is linked (or related) to one, or more, rows in another table using the key column(s).</p>
<div class="cell" data-execution_count="384">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> pd.read_csv(<span class="st">'student_one.csv'</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> pd.read_csv(<span class="st">'skills_many.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="385">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>data1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="385">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jax</td>
      <td>Computer Science</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sonya</td>
      <td>Material Science</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Johnny</td>
      <td>Music</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="386">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>data2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="386">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Statistics</td>
      <td>Modeling</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Computer Science</td>
      <td>Computing</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Material Science</td>
      <td>Structure prediction</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Music</td>
      <td>Opera</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Music</td>
      <td>Pop</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Music</td>
      <td>Classical</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="387">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>pd.merge(data1,data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="387">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Modeling</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Computing</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sonya</td>
      <td>Material Science</td>
      <td>Structure prediction</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Johnny</td>
      <td>Music</td>
      <td>Opera</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Johnny</td>
      <td>Music</td>
      <td>Pop</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Johnny</td>
      <td>Music</td>
      <td>Classical</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="many-to-many-join" class="level4" data-number="8.2.1.4">
<h4 data-number="8.2.1.4" class="anchored" data-anchor-id="many-to-many-join"><span class="header-section-number">8.2.1.4</span> Many-to-many join</h4>
<p>One, or more, rows in one table is linked (or related) to one, or more, rows in another table using the key column(s).</p>
<div class="cell" data-execution_count="388">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> pd.read_csv(<span class="st">'student_many.csv'</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> pd.read_csv(<span class="st">'skills_many.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="389">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>data1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="389">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kitana</td>
      <td>Computer Science</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jax</td>
      <td>Computer Science</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sonya</td>
      <td>Material Science</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Johnny</td>
      <td>Music</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Johnny</td>
      <td>Statistics</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-scrolled="true" data-execution_count="390">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>data2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="390">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Statistics</td>
      <td>Modeling</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Computer Science</td>
      <td>Computing</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Material Science</td>
      <td>Structure prediction</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Music</td>
      <td>Opera</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Music</td>
      <td>Pop</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Music</td>
      <td>Classical</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="391">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>pd.merge(data1,data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="391">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Modeling</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Johnny</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Johnny</td>
      <td>Statistics</td>
      <td>Modeling</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kitana</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Kitana</td>
      <td>Computer Science</td>
      <td>Computing</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Computing</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Sonya</td>
      <td>Material Science</td>
      <td>Structure prediction</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Johnny</td>
      <td>Music</td>
      <td>Opera</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Johnny</td>
      <td>Music</td>
      <td>Pop</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Johnny</td>
      <td>Music</td>
      <td>Classical</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Note that there are two ‘Statistics’ rows in data1, and two ‘Statistics’ rows in data2, resulting in 2x2 = 4 ‘Statistics’ rows in the merged data</p>
</section>
</section>
<section id="join-types-with-how-argument" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="join-types-with-how-argument"><span class="header-section-number">8.2.2</span> Join types with <code>how</code> argument</h3>
<ol type="i">
<li>inner, (ii) left, (iii) right, (iv) ’outer</li>
</ol>
<section id="inner-join" class="level4" data-number="8.2.2.1">
<h4 data-number="8.2.2.1" class="anchored" data-anchor-id="inner-join"><span class="header-section-number">8.2.2.1</span> inner join</h4>
<p>Use only the key combinations observed in both tables.</p>
<div class="cell" data-execution_count="392">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>data1 <span class="op">=</span> pd.read_csv(<span class="st">'student_how.csv'</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>data2 <span class="op">=</span> pd.read_csv(<span class="st">'skills_how.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="393">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>data1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="393">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jax</td>
      <td>Computer Science</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sonya</td>
      <td>Material Science</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="394">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>data2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="394">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Music</td>
      <td>Opera</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="395">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>pd.merge(data1,data2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="395">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><strong>When you may use inner join?</strong> You should use inner join when you cannot carry out the analysis unless the observation corresponding to the <em>key column(s)</em> is present in both the tables.</p>
<p><strong>Example:</strong> Suppose you wish to analyze the association between vaccinations and covid infection rate based on country-level data. In one of the datasets, you have the infection rate for each country, while in the other one you have the number of vaccinations in each country. The countries which have either the vaccination or the infection rate missing, cannot help analyze the association. In such as case you may be interested only in countries that have values for both the variables. Thus, you will use inner join to discard the countries with either value missing.</p>
</section>
<section id="left-join" class="level4" data-number="8.2.2.2">
<h4 data-number="8.2.2.2" class="anchored" data-anchor-id="left-join"><span class="header-section-number">8.2.2.2</span> left join</h4>
<p>Use all the key combinations observed in the left table.</p>
<div class="cell" data-scrolled="true" data-execution_count="85">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>pd.merge(data1,data2,how<span class="op">=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sonya</td>
      <td>Material Science</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><strong>When you may use left join?</strong> You should use left join when the primary variable(s) of interest are present in the one of the datasets, and whose missing values cannot be imputed. The variable(s) in the other dataset may not be as important or it may be possible to reasonably impute their values, if missing corresponding to the observation in the primary dataset.</p>
<p><strong>Examples:</strong></p>
<ol type="1">
<li><p>Suppose you wish to analyze the association between the covid infection rate and the government effectiveness score (a metric used to determine the effectiveness of the government in implementing policies, upholding law and order etc.) based on the data of all countries. Let us say that one of the datasets contains the covid infection rate, while the other one contains the government effectiveness score for each country. If the infection rate for a country is missing, it might be hard to impute. However, the government effectiveness score may be easier to impute based on GDP per capita, crime rate etc. - information that is easily available online. In such a case, you may wish to use a left join where you keep all the countries for which the infection rate is known.</p></li>
<li><p>Suppose you wish to analyze the association between demographics such as age, income etc. and the amount of credit card spend. Let us say one of the datasets contains the demographic information of each customer, while the other one contains the credit card spend for the customers who made at least one purchase. In such as case, you may want to do a left join as customers not making any purchase might be absent in the card spend data. Their spend can be imputed as zero after merging the datasets.</p></li>
</ol>
</section>
<section id="right-join" class="level4" data-number="8.2.2.3">
<h4 data-number="8.2.2.3" class="anchored" data-anchor-id="right-join"><span class="header-section-number">8.2.2.3</span> right join</h4>
<p>Use all the key combinations observed in the right table.</p>
<div class="cell" data-scrolled="true" data-execution_count="86">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>pd.merge(data1,data2,how<span class="op">=</span><span class="st">'right'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>Music</td>
      <td>Opera</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><strong>When you may use right join?</strong> You can always use a left join instead of a right join. Their purpose is the same.</p>
</section>
<section id="outer-join" class="level4" data-number="8.2.2.4">
<h4 data-number="8.2.2.4" class="anchored" data-anchor-id="outer-join"><span class="header-section-number">8.2.2.4</span> outer join</h4>
<p>Use all key combinations observed in both the tables together.</p>
<div class="cell" data-execution_count="335">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pd.merge(data1,data2,how<span class="op">=</span><span class="st">'outer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="335">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Student</th>
      <th>Major</th>
      <th>Skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Kitana</td>
      <td>Statistics</td>
      <td>Inference</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jax</td>
      <td>Computer Science</td>
      <td>Machine learning</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Sonya</td>
      <td>Material Science</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>Music</td>
      <td>Opera</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p><strong>When you may use outer join?</strong> You should use an outer join when you cannot afford to lose data present in either of the tables. All the other joins may result in loss of data.</p>
<p><strong>Example:</strong> Suppose I took two course surveys for this course. If I need to analyze student sentiment during the course, I will take an outer join of both the surveys. Assume that each survey is a dataset, where each row corresponds to a unique student. Even if a student has answered one of the two surverys, it will be indicative of the sentiment, and will be useful to keep in the merged dataset.</p>
</section>
</section>
</section>
<section id="concatenating-datasets" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="concatenating-datasets"><span class="header-section-number">8.3</span> Concatenating datasets</h2>
<p>The Pandas DataFrame method <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html"><code>concat()</code></a> is used to stack datasets along an axis. The method is similar to NumPy’s <code>concatenate()</code> method.</p>
<p><strong>Example</strong>: You are given the life expectancy data of each continent as a separate *.csv file. Visualize the change of life expectancy over time for different continents.</p>
<div class="cell" data-execution_count="355">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>data_asia <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/gdp_lifeExpec_Asia.csv'</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>data_europe <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/gdp_lifeExpec_Europe.csv'</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>data_africa <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/gdp_lifeExpec_Africa.csv'</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>data_oceania <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/gdp_lifeExpec_Oceania.csv'</span>)</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>data_americas <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/gdp_lifeExpec_Americas.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="365">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Appending all the data files, i.e., stacking them on top of each other</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>data_all_continents <span class="op">=</span> pd.concat([data_asia,data_europe,data_africa,data_oceania,data_americas],keys <span class="op">=</span> [<span class="st">'Asia'</span>,<span class="st">'Europe'</span>,<span class="st">'Africa'</span>,<span class="st">'Oceania'</span>,<span class="st">'Americas'</span>])</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>data_all_continents</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="365">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Asia</th>
      <th>0</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>28.801</td>
      <td>8425333</td>
      <td>779.445314</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>30.332</td>
      <td>9240934</td>
      <td>820.853030</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>1962</td>
      <td>31.997</td>
      <td>10267083</td>
      <td>853.100710</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>1967</td>
      <td>34.020</td>
      <td>11537966</td>
      <td>836.197138</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>1972</td>
      <td>36.088</td>
      <td>13079460</td>
      <td>739.981106</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">Americas</th>
      <th>295</th>
      <td>Venezuela</td>
      <td>1987</td>
      <td>70.190</td>
      <td>17910182</td>
      <td>9883.584648</td>
    </tr>
    <tr>
      <th>296</th>
      <td>Venezuela</td>
      <td>1992</td>
      <td>71.150</td>
      <td>20265563</td>
      <td>10733.926310</td>
    </tr>
    <tr>
      <th>297</th>
      <td>Venezuela</td>
      <td>1997</td>
      <td>72.146</td>
      <td>22374398</td>
      <td>10165.495180</td>
    </tr>
    <tr>
      <th>298</th>
      <td>Venezuela</td>
      <td>2002</td>
      <td>72.766</td>
      <td>24287670</td>
      <td>8605.047831</td>
    </tr>
    <tr>
      <th>299</th>
      <td>Venezuela</td>
      <td>2007</td>
      <td>73.747</td>
      <td>26084662</td>
      <td>11415.805690</td>
    </tr>
  </tbody>
</table>
<p>1704 rows × 5 columns</p>
</div>
</div>
</div>
<p>Let’s have the continent as a column as we need to use that in the visualization.</p>
<div class="cell" data-execution_count="366">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>data_all_continents.reset_index(inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="368">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>data_all_continents.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="368">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>level_0</th>
      <th>level_1</th>
      <th>country</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Asia</td>
      <td>0</td>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>28.801</td>
      <td>8425333</td>
      <td>779.445314</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Asia</td>
      <td>1</td>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>30.332</td>
      <td>9240934</td>
      <td>820.853030</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Asia</td>
      <td>2</td>
      <td>Afghanistan</td>
      <td>1962</td>
      <td>31.997</td>
      <td>10267083</td>
      <td>853.100710</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Asia</td>
      <td>3</td>
      <td>Afghanistan</td>
      <td>1967</td>
      <td>34.020</td>
      <td>11537966</td>
      <td>836.197138</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Asia</td>
      <td>4</td>
      <td>Afghanistan</td>
      <td>1972</td>
      <td>36.088</td>
      <td>13079460</td>
      <td>739.981106</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="369">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>data_all_continents.drop(columns <span class="op">=</span> <span class="st">'level_1'</span>,inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>data_all_continents.rename(columns <span class="op">=</span> {<span class="st">'level_0'</span>:<span class="st">'continent'</span>},inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>data_all_continents.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="369">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>continent</th>
      <th>country</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Asia</td>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>28.801</td>
      <td>8425333</td>
      <td>779.445314</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Asia</td>
      <td>Afghanistan</td>
      <td>1957</td>
      <td>30.332</td>
      <td>9240934</td>
      <td>820.853030</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Asia</td>
      <td>Afghanistan</td>
      <td>1962</td>
      <td>31.997</td>
      <td>10267083</td>
      <td>853.100710</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Asia</td>
      <td>Afghanistan</td>
      <td>1967</td>
      <td>34.020</td>
      <td>11537966</td>
      <td>836.197138</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Asia</td>
      <td>Afghanistan</td>
      <td>1972</td>
      <td>36.088</td>
      <td>13079460</td>
      <td>739.981106</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="373">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">#change of life expectancy over time for different continents</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> sns.FacetGrid(data_all_continents,col <span class="op">=</span> <span class="st">'continent'</span>,col_wrap <span class="op">=</span> <span class="dv">3</span>,height <span class="op">=</span> <span class="fl">4.5</span>,aspect <span class="op">=</span> <span class="dv">1</span>)<span class="co">#height = 3,aspect = 0.8)</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">map</span>(sns.lineplot,<span class="st">'year'</span>,<span class="st">'gdpPercap'</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>a.add_legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="373">
<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x2348dab5430&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Data%20wrangling_files/figure-html/cell-73-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>In the above example, datasets were appended (or stacked on top of each other).</p>
<p>Datasets can also be concatenated side-by-side (by providing the argument <em>axis = 1</em> with the <em>concat()</em> function) as we saw with the <em>merge</em> function.</p>
<section id="practice-exercise-4" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="practice-exercise-4"><span class="header-section-number">8.3.1</span> Practice exercise 4</h3>
<p>Read the documentations of the Pandas DataFrame methods <code>merge()</code> and <code>concat()</code>, and identify the differences. Mention examples when you can use (i) either, (ii) only <code>concat()</code>, (iii) only <code>merge()</code></p>
</section>
</section>
<section id="reshaping-data-1" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="reshaping-data-1"><span class="header-section-number">8.4</span> Reshaping data</h2>
<section id="pivoting-long-to-wide-format" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="pivoting-long-to-wide-format"><span class="header-section-number">8.4.1</span> Pivoting “long” to “wide” format</h3>
<p><em>pivot()</em></p>
</section>
<section id="pivoting-wide-to-long-format" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="pivoting-wide-to-long-format"><span class="header-section-number">8.4.2</span> Pivoting “wide” to “long” format</h3>
<p><em>melt()</em></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Data cleaning and preparation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data cleaning and preparation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Data aggregation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data aggregation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>