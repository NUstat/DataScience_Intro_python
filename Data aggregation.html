<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to Data Science with Python - 9&nbsp; Data aggregation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./student_solutions.html" rel="next">
<link href="./Data wrangling.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data aggregation</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./NU_Stat_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Data Science with Python</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Quick overview: Python programming</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to Python and Jupyter Notebooks.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Python and Jupyter Notebooks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_structures.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data structures</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Exploratory data analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Reading data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pandas.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data visualization.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data cleaning and preparation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Data cleaning and preparation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data wrangling.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data aggregation.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data aggregation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./student_solutions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Alternative solutions by students</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Assignments</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 1 (Reading data).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Assignment 1 (Reading data)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 2 (NumPy).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Assignment 2 (NumPy)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 3 (Pandas).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Assignment 3 (Pandas)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 4 (Data Visualization).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Assignment 4 (Data Visualization)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment 5 (Data cleaning and preparation).html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Assignment 5 (Data cleaning &amp; preparation)</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Datasets.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-groupby-object" id="toc-the-groupby-object" class="nav-link active" data-scroll-target="#the-groupby-object"><span class="toc-section-number">9.1</span>  The GroupBy object</a>
  <ul>
  <li><a href="#creating-a-groupby-object-groupby" id="toc-creating-a-groupby-object-groupby" class="nav-link" data-scroll-target="#creating-a-groupby-object-groupby"><span class="toc-section-number">9.1.1</span>  Creating a GroupBy object: <code>groupby</code></a></li>
  <li><a href="#attributes-and-methods-of-the-groupby-object" id="toc-attributes-and-methods-of-the-groupby-object" class="nav-link" data-scroll-target="#attributes-and-methods-of-the-groupby-object"><span class="toc-section-number">9.1.2</span>  Attributes and methods of the <em>GroupBy</em> object</a>
  <ul class="collapse">
  <li><a href="#keys" id="toc-keys" class="nav-link" data-scroll-target="#keys"><span class="toc-section-number">9.1.2.1</span>  <code>keys</code></a></li>
  <li><a href="#ngroups" id="toc-ngroups" class="nav-link" data-scroll-target="#ngroups"><span class="toc-section-number">9.1.2.2</span>  <code>ngroups</code></a></li>
  <li><a href="#groups" id="toc-groups" class="nav-link" data-scroll-target="#groups"><span class="toc-section-number">9.1.2.3</span>  <code>groups</code></a></li>
  <li><a href="#size" id="toc-size" class="nav-link" data-scroll-target="#size"><span class="toc-section-number">9.1.2.4</span>  <code>size()</code></a></li>
  <li><a href="#first" id="toc-first" class="nav-link" data-scroll-target="#first"><span class="toc-section-number">9.1.2.5</span>  <code>first()</code></a></li>
  <li><a href="#get_group" id="toc-get_group" class="nav-link" data-scroll-target="#get_group"><span class="toc-section-number">9.1.2.6</span>  <code>get_group()</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-aggregation-with-groupby-methods" id="toc-data-aggregation-with-groupby-methods" class="nav-link" data-scroll-target="#data-aggregation-with-groupby-methods"><span class="toc-section-number">9.2</span>  Data aggregation with <code>groupby()</code> methods</a>
  <ul>
  <li><a href="#mean" id="toc-mean" class="nav-link" data-scroll-target="#mean"><span class="toc-section-number">9.2.1</span>  <code>mean()</code></a>
  <ul class="collapse">
  <li><a href="#grouping-observations" id="toc-grouping-observations" class="nav-link" data-scroll-target="#grouping-observations"><span class="toc-section-number">9.2.1.1</span>  Grouping observations</a></li>
  <li><a href="#grouping-columns" id="toc-grouping-columns" class="nav-link" data-scroll-target="#grouping-columns"><span class="toc-section-number">9.2.1.2</span>  Grouping columns</a></li>
  </ul></li>
  <li><a href="#practice-exercise-1" id="toc-practice-exercise-1" class="nav-link" data-scroll-target="#practice-exercise-1"><span class="toc-section-number">9.2.2</span>  Practice exercise 1</a></li>
  <li><a href="#agg" id="toc-agg" class="nav-link" data-scroll-target="#agg"><span class="toc-section-number">9.2.3</span>  <code>agg()</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Data aggregation</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>Data aggregation refers to summarizing data with statistics such as sum, count, average, maximum, minimum etc. to provide a high level view of the data. Often there are mutually exclusive groups in the data that are of interest. In such cases, we may be interested in finding these statisitcs separately for each group. The Pandas DataFrame method <code>groupby()</code> is used to split the data into groups, and then the desired function(s) are applied on each of these groups for groupwise data aggregation. However, the <code>groupby()</code> method is not limited for groupwise data aggregation, but can also be used for several other kinds of groupwise oprations.</p>
<p><strong>Groupby mechanics:</strong> <em>(Source: https://pandas.pydata.org/docs/user_guide/groupby.html)</em></p>
<p>Group by: split-apply-combine By <em>‘group by’</em> we are referring to a process involving one or more of the following steps:</p>
<ol type="1">
<li><p>Splitting the data into groups based on some criteria.</p></li>
<li><p>Applying a function to each group independently.</p></li>
<li><p>Combining the results in a DataFrame.</p></li>
</ol>
<p>Out of these, the split step is the most straightforward. In fact, in many situations we may wish to split the data set into groups and do something with those groups. In the apply step, we may wish to do one of the following:</p>
<p><strong>1. Aggregation:</strong> compute a summary statistic (or statistics) for each group. Some examples:</p>
<ul>
<li>Compute group sums or means.</li>
<li>Compute group sizes / counts.</li>
</ul>
<p><strong>2. Transformation:</strong> perform some group-specific computations and return a like-indexed object. Some examples:</p>
<ul>
<li>Standardize data <em>(zscore)</em> within a group.</li>
<li>Filling <em>NAs</em> within groups with a value derived from each group.</li>
</ul>
<p><strong>3. Filtration:</strong> discard some groups, according to a group-wise computation that evaluates True or False. Some examples:</p>
<ul>
<li>Discard data that belongs to groups with only a few members.</li>
<li>Filter out data based on the group <em>sum</em> or <em>mean</em>.</li>
</ul>
<p>Some combination of the above: <em>GroupBy</em> will examine the results of the <em>apply</em> step and try to return a sensibly combined result if it doesn’t fit into either of the above two categories.</p>
<p>We’ll use Pandas to group the data and perform <em>GroupBy</em> operations.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="the-groupby-object" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="the-groupby-object"><span class="header-section-number">9.1</span> The GroupBy object</h2>
<section id="creating-a-groupby-object-groupby" class="level3" data-number="9.1.1">
<h3 data-number="9.1.1" class="anchored" data-anchor-id="creating-a-groupby-object-groupby"><span class="header-section-number">9.1.1</span> Creating a GroupBy object: <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html"><code>groupby</code></a></h3>
<p>This Pandas DataFrame method <code>groupby()</code> is used to create a <code>GroupBy</code> object.</p>
<p>A string passed to <code>groupby()</code> may refer to either a column or an index level. If a string matches both a column name and an index level name, a ValueError will be raised.</p>
<p><strong>Example</strong>: Consider the life expectancy dataset, <em>gdp_lifeExpectancy.csv</em>. Suppose we want to group by the observations by <code>continent</code>.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/gdp_lifeExpectancy.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>continent</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1952</td>
      <td>28.801</td>
      <td>8425333</td>
      <td>779.445314</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1957</td>
      <td>30.332</td>
      <td>9240934</td>
      <td>820.853030</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1962</td>
      <td>31.997</td>
      <td>10267083</td>
      <td>853.100710</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1967</td>
      <td>34.020</td>
      <td>11537966</td>
      <td>836.197138</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1972</td>
      <td>36.088</td>
      <td>13079460</td>
      <td>739.981106</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We will pass the column <code>continent</code> as an argument to the <code>groupby()</code> method.</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a GroupBy object</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> data.groupby(<span class="st">'continent'</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#This will split the data into groups that correspond to values of the column 'continent'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>groupby()</code> method returns a <em>GroupBy</em> object.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#A 'GroupBy' objects is created with the `groupby()` function</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>pandas.core.groupby.generic.DataFrameGroupBy</code></pre>
</div>
</div>
<p>The GroupBy object <code>grouped</code> contains the information of the groups in which the data is distributed. Each observation has been assigned to a specific group of the column(s) used to group the data. However, note that the dataset is not physically split into different DataFrames. For example, in the above case, each observation is assigned to a particular group depending on the value of the <code>continent</code> for that observation. However, all the observations are still in the same DataFrame <code>data</code>.</p>
</section>
<section id="attributes-and-methods-of-the-groupby-object" class="level3" data-number="9.1.2">
<h3 data-number="9.1.2" class="anchored" data-anchor-id="attributes-and-methods-of-the-groupby-object"><span class="header-section-number">9.1.2</span> Attributes and methods of the <em>GroupBy</em> object</h3>
<section id="keys" class="level4" data-number="9.1.2.1">
<h4 data-number="9.1.2.1" class="anchored" data-anchor-id="keys"><span class="header-section-number">9.1.2.1</span> <code>keys</code></h4>
<p>The object(s) grouping the data are called <em>key(s)</em>. Here <code>continent</code> is the group key. The keys of the <em>GroupBy</em> object can be seen using Its <code>keys</code> attribute.</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Key(s) of the GroupBy object</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>grouped.keys</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>'continent'</code></pre>
</div>
</div>
</section>
<section id="ngroups" class="level4" data-number="9.1.2.2">
<h4 data-number="9.1.2.2" class="anchored" data-anchor-id="ngroups"><span class="header-section-number">9.1.2.2</span> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.ngroup.html"><code>ngroups</code></a></h4>
<p>The number of groups in which the data is distributed based on the keys can be seen with the <code>ngroups</code> attribute.</p>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The number of groups based on the key(s)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>grouped.ngroups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>5</code></pre>
</div>
</div>
</section>
<section id="groups" class="level4" data-number="9.1.2.3">
<h4 data-number="9.1.2.3" class="anchored" data-anchor-id="groups"><span class="header-section-number">9.1.2.3</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.GroupBy.groups.html"><code>groups</code></a></h4>
<p>The <code>groups</code> attribute of the <em>GroupBy</em> object contains the group labels (or names) and the row labels of the observations in each group, as a dictionary.</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The groups (in the dictionary format)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>grouped.groups</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>{'Africa': [24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, ...], 'Americas': [48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 432, 433, 434, 435, ...], 'Asia': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, ...], 'Europe': [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 516, 517, 518, 519, ...], 'Oceania': [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103]}</code></pre>
</div>
</div>
<p>The group names are the <em>keys</em> of the dictionary, while the row labels are the corresponding <em>values</em></p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Group names</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>grouped.groups.keys()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>dict_keys(['Africa', 'Americas', 'Asia', 'Europe', 'Oceania'])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Group values are the row labels corresponding to a particular group</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>grouped.groups.values()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>dict_values([Int64Index([  24,   25,   26,   27,   28,   29,   30,   31,   32,   33,
            ...
            1694, 1695, 1696, 1697, 1698, 1699, 1700, 1701, 1702, 1703],
           dtype='int64', length=624), Int64Index([  48,   49,   50,   51,   52,   53,   54,   55,   56,   57,
            ...
            1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1643],
           dtype='int64', length=300), Int64Index([   0,    1,    2,    3,    4,    5,    6,    7,    8,    9,
            ...
            1670, 1671, 1672, 1673, 1674, 1675, 1676, 1677, 1678, 1679],
           dtype='int64', length=396), Int64Index([  12,   13,   14,   15,   16,   17,   18,   19,   20,   21,
            ...
            1598, 1599, 1600, 1601, 1602, 1603, 1604, 1605, 1606, 1607],
           dtype='int64', length=360), Int64Index([  60,   61,   62,   63,   64,   65,   66,   67,   68,   69,   70,
              71, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101,
            1102, 1103],
           dtype='int64')])</code></pre>
</div>
</div>
</section>
<section id="size" class="level4" data-number="9.1.2.4">
<h4 data-number="9.1.2.4" class="anchored" data-anchor-id="size"><span class="header-section-number">9.1.2.4</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.GroupBy.size.html"><code>size()</code></a></h4>
<p>The <code>size()</code> method of the <em>GroupBy</em> object returns the number of observations in each group.</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of observations in each group</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>grouped.size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>continent
Africa      624
Americas    300
Asia        396
Europe      360
Oceania      24
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="first" class="level4" data-number="9.1.2.5">
<h4 data-number="9.1.2.5" class="anchored" data-anchor-id="first"><span class="header-section-number">9.1.2.5</span> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.first.html"><code>first()</code></a></h4>
<p>The first non missing element of each group is returned with the <code>first()</code> method of the <em>GroupBy</em> object.</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The first element of the group can be printed using the first() method</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>grouped.first()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
    </tr>
    <tr>
      <th>continent</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Africa</th>
      <td>Algeria</td>
      <td>1952</td>
      <td>43.077</td>
      <td>9279525</td>
      <td>2449.008185</td>
    </tr>
    <tr>
      <th>Americas</th>
      <td>Argentina</td>
      <td>1952</td>
      <td>62.485</td>
      <td>17876956</td>
      <td>5911.315053</td>
    </tr>
    <tr>
      <th>Asia</th>
      <td>Afghanistan</td>
      <td>1952</td>
      <td>28.801</td>
      <td>8425333</td>
      <td>779.445314</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>Albania</td>
      <td>1952</td>
      <td>55.230</td>
      <td>1282697</td>
      <td>1601.056136</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>Australia</td>
      <td>1952</td>
      <td>69.120</td>
      <td>8691212</td>
      <td>10039.595640</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="get_group" class="level4" data-number="9.1.2.6">
<h4 data-number="9.1.2.6" class="anchored" data-anchor-id="get_group"><span class="header-section-number">9.1.2.6</span> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.get_group.html"><code>get_group()</code></a></h4>
<p>This method returns the observations for a particular group of the <em>GroupBy</em> object.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Observations for individual groups can be obtained using the get_group() function</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>grouped.get_group(<span class="st">'Asia'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>country</th>
      <th>continent</th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1952</td>
      <td>28.801</td>
      <td>8425333</td>
      <td>779.445314</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1957</td>
      <td>30.332</td>
      <td>9240934</td>
      <td>820.853030</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1962</td>
      <td>31.997</td>
      <td>10267083</td>
      <td>853.100710</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1967</td>
      <td>34.020</td>
      <td>11537966</td>
      <td>836.197138</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Afghanistan</td>
      <td>Asia</td>
      <td>1972</td>
      <td>36.088</td>
      <td>13079460</td>
      <td>739.981106</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1675</th>
      <td>Yemen, Rep.</td>
      <td>Asia</td>
      <td>1987</td>
      <td>52.922</td>
      <td>11219340</td>
      <td>1971.741538</td>
    </tr>
    <tr>
      <th>1676</th>
      <td>Yemen, Rep.</td>
      <td>Asia</td>
      <td>1992</td>
      <td>55.599</td>
      <td>13367997</td>
      <td>1879.496673</td>
    </tr>
    <tr>
      <th>1677</th>
      <td>Yemen, Rep.</td>
      <td>Asia</td>
      <td>1997</td>
      <td>58.020</td>
      <td>15826497</td>
      <td>2117.484526</td>
    </tr>
    <tr>
      <th>1678</th>
      <td>Yemen, Rep.</td>
      <td>Asia</td>
      <td>2002</td>
      <td>60.308</td>
      <td>18701257</td>
      <td>2234.820827</td>
    </tr>
    <tr>
      <th>1679</th>
      <td>Yemen, Rep.</td>
      <td>Asia</td>
      <td>2007</td>
      <td>62.698</td>
      <td>22211743</td>
      <td>2280.769906</td>
    </tr>
  </tbody>
</table>
<p>396 rows × 6 columns</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="data-aggregation-with-groupby-methods" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="data-aggregation-with-groupby-methods"><span class="header-section-number">9.2</span> Data aggregation with <code>groupby()</code> methods</h2>
<section id="mean" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="mean"><span class="header-section-number">9.2.1</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.core.groupby.GroupBy.mean.html"><code>mean()</code></a></h3>
<p>This method returns the mean of each group of the <em>GroupBy</em> object.</p>
<section id="grouping-observations" class="level4" data-number="9.2.1.1">
<h4 data-number="9.2.1.1" class="anchored" data-anchor-id="grouping-observations"><span class="header-section-number">9.2.1.1</span> Grouping observations</h4>
<p><strong>Example:</strong> Find the mean life expectancy, population and GDP per capita for each country since 1952.</p>
<p>First, we’ll group the data such that all observations corresponding to a country make a unique group.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grouping the observations by 'country'</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> data.groupby(<span class="st">'country'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we’ll find the mean statistics for each group with the <code>mean()</code> method. The method will be applied on all columns of the DataFrame and all groups.</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the mean stastistic of all columns of the DataFrame and all groups</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>grouped.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afghanistan</th>
      <td>1979.5</td>
      <td>37.478833</td>
      <td>1.582372e+07</td>
      <td>802.674598</td>
    </tr>
    <tr>
      <th>Albania</th>
      <td>1979.5</td>
      <td>68.432917</td>
      <td>2.580249e+06</td>
      <td>3255.366633</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>1979.5</td>
      <td>59.030167</td>
      <td>1.987541e+07</td>
      <td>4426.025973</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>1979.5</td>
      <td>37.883500</td>
      <td>7.309390e+06</td>
      <td>3607.100529</td>
    </tr>
    <tr>
      <th>Argentina</th>
      <td>1979.5</td>
      <td>69.060417</td>
      <td>2.860224e+07</td>
      <td>8955.553783</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Vietnam</th>
      <td>1979.5</td>
      <td>57.479500</td>
      <td>5.456857e+07</td>
      <td>1017.712615</td>
    </tr>
    <tr>
      <th>West Bank and Gaza</th>
      <td>1979.5</td>
      <td>60.328667</td>
      <td>1.848606e+06</td>
      <td>3759.996781</td>
    </tr>
    <tr>
      <th>Yemen, Rep.</th>
      <td>1979.5</td>
      <td>46.780417</td>
      <td>1.084319e+07</td>
      <td>1569.274672</td>
    </tr>
    <tr>
      <th>Zambia</th>
      <td>1979.5</td>
      <td>45.996333</td>
      <td>6.353805e+06</td>
      <td>1358.199409</td>
    </tr>
    <tr>
      <th>Zimbabwe</th>
      <td>1979.5</td>
      <td>52.663167</td>
      <td>7.641966e+06</td>
      <td>635.858042</td>
    </tr>
  </tbody>
</table>
<p>142 rows × 4 columns</p>
</div>
</div>
</div>
<p>Note that if we wished to retain the <code>continent</code> in the above dataset, we can group the data by both <code>continent</code> and <code>country</code>. If the data is to be grouped by multiple columns, we need to put them within <code>[]</code> brackets:</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grouping the observations by 'continent' and 'country'</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>grouped <span class="op">=</span> data.groupby([<span class="st">'continent'</span>,<span class="st">'country'</span>])</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the mean stastistic of all columns of the DataFrame and all groups</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>grouped.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>year</th>
      <th>lifeExp</th>
      <th>pop</th>
      <th>gdpPercap</th>
    </tr>
    <tr>
      <th>continent</th>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Africa</th>
      <th>Algeria</th>
      <td>1979.5</td>
      <td>59.030167</td>
      <td>1.987541e+07</td>
      <td>4426.025973</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>1979.5</td>
      <td>37.883500</td>
      <td>7.309390e+06</td>
      <td>3607.100529</td>
    </tr>
    <tr>
      <th>Benin</th>
      <td>1979.5</td>
      <td>48.779917</td>
      <td>4.017497e+06</td>
      <td>1155.395107</td>
    </tr>
    <tr>
      <th>Botswana</th>
      <td>1979.5</td>
      <td>54.597500</td>
      <td>9.711862e+05</td>
      <td>5031.503557</td>
    </tr>
    <tr>
      <th>Burkina Faso</th>
      <td>1979.5</td>
      <td>44.694000</td>
      <td>7.548677e+06</td>
      <td>843.990665</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Europe</th>
      <th>Switzerland</th>
      <td>1979.5</td>
      <td>75.565083</td>
      <td>6.384293e+06</td>
      <td>27074.334405</td>
    </tr>
    <tr>
      <th>Turkey</th>
      <td>1979.5</td>
      <td>59.696417</td>
      <td>4.590901e+07</td>
      <td>4469.453380</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>1979.5</td>
      <td>73.922583</td>
      <td>5.608780e+07</td>
      <td>19380.472986</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Oceania</th>
      <th>Australia</th>
      <td>1979.5</td>
      <td>74.662917</td>
      <td>1.464931e+07</td>
      <td>19980.595634</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>1979.5</td>
      <td>73.989500</td>
      <td>3.100032e+06</td>
      <td>17262.622813</td>
    </tr>
  </tbody>
</table>
<p>142 rows × 4 columns</p>
</div>
</div>
</div>
<p>Here the data has been aggregated according to the group keys - <code>continent</code> and <code>country</code>, and a new DataFrame is created that is indexed by the unique values of <code>continent</code>-<code>country</code>.</p>
<p>For large datasets, it may be desirable to aggregate only a few columns. For example, if we wish to compute the means of only <code>lifeExp</code> and <code>gdpPercap</code>, then we can filter those columns in the <em>GroupBy</em> object <em>(just like we filter columns in a DataFrame)</em>, and then apply the <code>mean()</code> method:</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>grouped[[<span class="st">'lifeExp'</span>,<span class="st">'gdpPercap'</span>]].mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>lifeExp</th>
      <th>gdpPercap</th>
    </tr>
    <tr>
      <th>continent</th>
      <th>country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Africa</th>
      <th>Algeria</th>
      <td>59.030167</td>
      <td>4426.025973</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>37.883500</td>
      <td>3607.100529</td>
    </tr>
    <tr>
      <th>Benin</th>
      <td>48.779917</td>
      <td>1155.395107</td>
    </tr>
    <tr>
      <th>Botswana</th>
      <td>54.597500</td>
      <td>5031.503557</td>
    </tr>
    <tr>
      <th>Burkina Faso</th>
      <td>44.694000</td>
      <td>843.990665</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Europe</th>
      <th>Switzerland</th>
      <td>75.565083</td>
      <td>27074.334405</td>
    </tr>
    <tr>
      <th>Turkey</th>
      <td>59.696417</td>
      <td>4469.453380</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>73.922583</td>
      <td>19380.472986</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Oceania</th>
      <th>Australia</th>
      <td>74.662917</td>
      <td>19980.595634</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>73.989500</td>
      <td>17262.622813</td>
    </tr>
  </tbody>
</table>
<p>142 rows × 2 columns</p>
</div>
</div>
</div>
</section>
<section id="grouping-columns" class="level4" data-number="9.2.1.2">
<h4 data-number="9.2.1.2" class="anchored" data-anchor-id="grouping-columns"><span class="header-section-number">9.2.1.2</span> Grouping columns</h4>
<p>By default, the grouping takes place by rows. However, as with several other Pandas methods, grouping can also be done by columns by using the <code>axis = 1</code> argument.</p>
<p><strong>Example:</strong> Consider we have the above dataset in the wide-format as follows.</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>data_wide <span class="op">=</span> data.pivot(index <span class="op">=</span> [<span class="st">'continent'</span>,<span class="st">'country'</span>],columns <span class="op">=</span> <span class="st">'year'</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data_wide</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="10" halign="left">lifeExp</th>
      <th>...</th>
      <th colspan="10" halign="left">gdpPercap</th>
    </tr>
    <tr>
      <th></th>
      <th>year</th>
      <th>1952</th>
      <th>1957</th>
      <th>1962</th>
      <th>1967</th>
      <th>1972</th>
      <th>1977</th>
      <th>1982</th>
      <th>1987</th>
      <th>1992</th>
      <th>1997</th>
      <th>...</th>
      <th>1962</th>
      <th>1967</th>
      <th>1972</th>
      <th>1977</th>
      <th>1982</th>
      <th>1987</th>
      <th>1992</th>
      <th>1997</th>
      <th>2002</th>
      <th>2007</th>
    </tr>
    <tr>
      <th>continent</th>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Africa</th>
      <th>Algeria</th>
      <td>43.077</td>
      <td>45.685</td>
      <td>48.303</td>
      <td>51.407</td>
      <td>54.518</td>
      <td>58.014</td>
      <td>61.368</td>
      <td>65.799</td>
      <td>67.744</td>
      <td>69.152</td>
      <td>...</td>
      <td>2550.816880</td>
      <td>3246.991771</td>
      <td>4182.663766</td>
      <td>4910.416756</td>
      <td>5745.160213</td>
      <td>5681.358539</td>
      <td>5023.216647</td>
      <td>4797.295051</td>
      <td>5288.040382</td>
      <td>6223.367465</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>30.015</td>
      <td>31.999</td>
      <td>34.000</td>
      <td>35.985</td>
      <td>37.928</td>
      <td>39.483</td>
      <td>39.942</td>
      <td>39.906</td>
      <td>40.647</td>
      <td>40.963</td>
      <td>...</td>
      <td>4269.276742</td>
      <td>5522.776375</td>
      <td>5473.288005</td>
      <td>3008.647355</td>
      <td>2756.953672</td>
      <td>2430.208311</td>
      <td>2627.845685</td>
      <td>2277.140884</td>
      <td>2773.287312</td>
      <td>4797.231267</td>
    </tr>
    <tr>
      <th>Benin</th>
      <td>38.223</td>
      <td>40.358</td>
      <td>42.618</td>
      <td>44.885</td>
      <td>47.014</td>
      <td>49.190</td>
      <td>50.904</td>
      <td>52.337</td>
      <td>53.919</td>
      <td>54.777</td>
      <td>...</td>
      <td>949.499064</td>
      <td>1035.831411</td>
      <td>1085.796879</td>
      <td>1029.161251</td>
      <td>1277.897616</td>
      <td>1225.856010</td>
      <td>1191.207681</td>
      <td>1232.975292</td>
      <td>1372.877931</td>
      <td>1441.284873</td>
    </tr>
    <tr>
      <th>Botswana</th>
      <td>47.622</td>
      <td>49.618</td>
      <td>51.520</td>
      <td>53.298</td>
      <td>56.024</td>
      <td>59.319</td>
      <td>61.484</td>
      <td>63.622</td>
      <td>62.745</td>
      <td>52.556</td>
      <td>...</td>
      <td>983.653976</td>
      <td>1214.709294</td>
      <td>2263.611114</td>
      <td>3214.857818</td>
      <td>4551.142150</td>
      <td>6205.883850</td>
      <td>7954.111645</td>
      <td>8647.142313</td>
      <td>11003.605080</td>
      <td>12569.851770</td>
    </tr>
    <tr>
      <th>Burkina Faso</th>
      <td>31.975</td>
      <td>34.906</td>
      <td>37.814</td>
      <td>40.697</td>
      <td>43.591</td>
      <td>46.137</td>
      <td>48.122</td>
      <td>49.557</td>
      <td>50.260</td>
      <td>50.324</td>
      <td>...</td>
      <td>722.512021</td>
      <td>794.826560</td>
      <td>854.735976</td>
      <td>743.387037</td>
      <td>807.198586</td>
      <td>912.063142</td>
      <td>931.752773</td>
      <td>946.294962</td>
      <td>1037.645221</td>
      <td>1217.032994</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Europe</th>
      <th>Switzerland</th>
      <td>69.620</td>
      <td>70.560</td>
      <td>71.320</td>
      <td>72.770</td>
      <td>73.780</td>
      <td>75.390</td>
      <td>76.210</td>
      <td>77.410</td>
      <td>78.030</td>
      <td>79.370</td>
      <td>...</td>
      <td>20431.092700</td>
      <td>22966.144320</td>
      <td>27195.113040</td>
      <td>26982.290520</td>
      <td>28397.715120</td>
      <td>30281.704590</td>
      <td>31871.530300</td>
      <td>32135.323010</td>
      <td>34480.957710</td>
      <td>37506.419070</td>
    </tr>
    <tr>
      <th>Turkey</th>
      <td>43.585</td>
      <td>48.079</td>
      <td>52.098</td>
      <td>54.336</td>
      <td>57.005</td>
      <td>59.507</td>
      <td>61.036</td>
      <td>63.108</td>
      <td>66.146</td>
      <td>68.835</td>
      <td>...</td>
      <td>2322.869908</td>
      <td>2826.356387</td>
      <td>3450.696380</td>
      <td>4269.122326</td>
      <td>4241.356344</td>
      <td>5089.043686</td>
      <td>5678.348271</td>
      <td>6601.429915</td>
      <td>6508.085718</td>
      <td>8458.276384</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>69.180</td>
      <td>70.420</td>
      <td>70.760</td>
      <td>71.360</td>
      <td>72.010</td>
      <td>72.760</td>
      <td>74.040</td>
      <td>75.007</td>
      <td>76.420</td>
      <td>77.218</td>
      <td>...</td>
      <td>12477.177070</td>
      <td>14142.850890</td>
      <td>15895.116410</td>
      <td>17428.748460</td>
      <td>18232.424520</td>
      <td>21664.787670</td>
      <td>22705.092540</td>
      <td>26074.531360</td>
      <td>29478.999190</td>
      <td>33203.261280</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Oceania</th>
      <th>Australia</th>
      <td>69.120</td>
      <td>70.330</td>
      <td>70.930</td>
      <td>71.100</td>
      <td>71.930</td>
      <td>73.490</td>
      <td>74.740</td>
      <td>76.320</td>
      <td>77.560</td>
      <td>78.830</td>
      <td>...</td>
      <td>12217.226860</td>
      <td>14526.124650</td>
      <td>16788.629480</td>
      <td>18334.197510</td>
      <td>19477.009280</td>
      <td>21888.889030</td>
      <td>23424.766830</td>
      <td>26997.936570</td>
      <td>30687.754730</td>
      <td>34435.367440</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>69.390</td>
      <td>70.260</td>
      <td>71.240</td>
      <td>71.520</td>
      <td>71.890</td>
      <td>72.220</td>
      <td>73.840</td>
      <td>74.320</td>
      <td>76.330</td>
      <td>77.550</td>
      <td>...</td>
      <td>13175.678000</td>
      <td>14463.918930</td>
      <td>16046.037280</td>
      <td>16233.717700</td>
      <td>17632.410400</td>
      <td>19007.191290</td>
      <td>18363.324940</td>
      <td>21050.413770</td>
      <td>23189.801350</td>
      <td>25185.009110</td>
    </tr>
  </tbody>
</table>
<p>142 rows × 36 columns</p>
</div>
</div>
</div>
<p>Now, find the mean GDP per capita, life expectancy and population for each country.</p>
<p>Here, we can group by the outer level column labels to obtain the means. Also, we need to use the argument <code>axis=1</code> to indicate that we intend to group columns, instead of rows.</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data_wide.groupby(axis<span class="op">=</span><span class="dv">1</span>,level<span class="op">=</span><span class="dv">0</span>).mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>gdpPercap</th>
      <th>lifeExp</th>
      <th>pop</th>
    </tr>
    <tr>
      <th>continent</th>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">Africa</th>
      <th>Algeria</th>
      <td>4426.025973</td>
      <td>59.030167</td>
      <td>1.987541e+07</td>
    </tr>
    <tr>
      <th>Angola</th>
      <td>3607.100529</td>
      <td>37.883500</td>
      <td>7.309390e+06</td>
    </tr>
    <tr>
      <th>Benin</th>
      <td>1155.395107</td>
      <td>48.779917</td>
      <td>4.017497e+06</td>
    </tr>
    <tr>
      <th>Botswana</th>
      <td>5031.503557</td>
      <td>54.597500</td>
      <td>9.711862e+05</td>
    </tr>
    <tr>
      <th>Burkina Faso</th>
      <td>843.990665</td>
      <td>44.694000</td>
      <td>7.548677e+06</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Europe</th>
      <th>Switzerland</th>
      <td>27074.334405</td>
      <td>75.565083</td>
      <td>6.384293e+06</td>
    </tr>
    <tr>
      <th>Turkey</th>
      <td>4469.453380</td>
      <td>59.696417</td>
      <td>4.590901e+07</td>
    </tr>
    <tr>
      <th>United Kingdom</th>
      <td>19380.472986</td>
      <td>73.922583</td>
      <td>5.608780e+07</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Oceania</th>
      <th>Australia</th>
      <td>19980.595634</td>
      <td>74.662917</td>
      <td>1.464931e+07</td>
    </tr>
    <tr>
      <th>New Zealand</th>
      <td>17262.622813</td>
      <td>73.989500</td>
      <td>3.100032e+06</td>
    </tr>
  </tbody>
</table>
<p>142 rows × 3 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="practice-exercise-1" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2" class="anchored" data-anchor-id="practice-exercise-1"><span class="header-section-number">9.2.2</span> Practice exercise 1</h3>
<p>Read the table consisting of GDP per capita of countries from the webpage: https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)_per_capita .</p>
<p>To only read the relevant table, read the tables that contain the word <em>‘Country’</em>.</p>
<p>Estimate the GDP per capita of each country as the average of the estimates of the three agencies - IMF, United Nations and World Bank.</p>
<p>We need to do a bit of data cleaning before we could directly use the <code>groupby()</code> function. Follow the steps below to answer this question:</p>
<ol type="1">
<li><p>Set the first 3 columns containing country, sub-region and region as hierarchical row labels.</p></li>
<li><p>Apply the following function on all the columns to convert them to numeric: <code>f = lambda x:pd.to_numeric(x,errors = 'coerce')</code></p></li>
<li><p>Now use <code>groupby()</code> to find estimate the GDP per capita for each country.</p></li>
</ol>
</section>
<section id="agg" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3" class="anchored" data-anchor-id="agg"><span class="header-section-number">9.2.3</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.agg.html"><code>agg()</code></a></h3>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Data wrangling.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Data wrangling</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./student_solutions.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Alternative solutions by students</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>